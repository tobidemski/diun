{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"What is Diun? \u00b6 D ocker I mage U pdate N otifier is a CLI application written in Go and delivered as a single executable (and a Docker image ) to receive notifications when a Docker image is updated on a Docker registry. With Go, this can be done with an independent binary distribution across all platforms and architectures that Go supports. This support includes Linux, macOS, and Windows, on architectures like amd64, i386, ARM, PowerPC, and others. Features \u00b6 Allow watching a Docker repository and report new tags Include and exclude filters with regular expression for tags Internal cron implementation through go routines Worker pool to parallelize analyses Allow overriding image os and architecture Docker , Swarm , Kubernetes , Dockerfile and File providers available Get notified through Gotify, Mail, Slack, Telegram and more Healthchecks support to monitor Diun watcher Enhanced logging Official Docker image available License \u00b6 This project is licensed under the terms of the MIT license.","title":"Home"},{"location":"#what-is-diun","text":"D ocker I mage U pdate N otifier is a CLI application written in Go and delivered as a single executable (and a Docker image ) to receive notifications when a Docker image is updated on a Docker registry. With Go, this can be done with an independent binary distribution across all platforms and architectures that Go supports. This support includes Linux, macOS, and Windows, on architectures like amd64, i386, ARM, PowerPC, and others.","title":"What is Diun?"},{"location":"#features","text":"Allow watching a Docker repository and report new tags Include and exclude filters with regular expression for tags Internal cron implementation through go routines Worker pool to parallelize analyses Allow overriding image os and architecture Docker , Swarm , Kubernetes , Dockerfile and File providers available Get notified through Gotify, Mail, Slack, Telegram and more Healthchecks support to monitor Diun watcher Enhanced logging Official Docker image available","title":"Features"},{"location":"#license","text":"This project is licensed under the terms of the MIT license.","title":"License"},{"location":"changelog/","text":"Changelog \u00b6 4.21.0 (2021/01/26) \u00b6 Add image prune command (#519) Fix matrix login scheme (#487) Move syscall to golang.org/x/sys (#525) Move from io/ioutil to os package (#524) Fix notif template in docs Enhance dockerfiles (#523) Add binary bake target (#517) MkDocs Material 8.1.8 (#520 #548) Alpine Linux 3.15 (#527) goreleaser-xx 1.2.5 (#539) Bump github.com/alecthomas/kong from 0.2.17 to 0.3.0 (#507 #537) Bump github.com/containerd/containerd from 1.5.5 to 1.5.8 (#494 #496 #509) Bump github.com/containers/image/v5 from 5.16.0 to 5.19.0 (#498 #536 #546) Bump github.com/docker/docker from 20.10.8+incompatible to 20.10.12+incompatible (#500 #510 #531) Bump github.com/go-playground/validator/v10 from 10.9.0 to 10.10.0 (#538) Bump github.com/jedib0t/go-pretty/v6 from 6.2.4 to 6.2.5 (#543) Bump github.com/microcosm-cc/bluemonday from 1.0.15 to 1.0.17 (#499 #535) Bump github.com/moby/buildkit from 0.9.0 to 0.9.3 (#495 #506 #512) Bump github.com/opencontainers/image-spec to v1.0.2-0.20211117181255-693428a734f5 (#513) Bump github.com/panjf2000/ants/v2 from 2.4.6 to 2.4.7 (#532) Bump github.com/rs/zerolog from 1.24.0 to 1.26.1 (#485 #502 #534) Bump google.golang.org/grpc from 1.40.0 to 1.44.0 (#492 #505 #529 #545) Bump google.golang.org/grpc/cmd/protoc-gen-go-grpc from 1.1.0 to 1.2.0 (#533) Bump k8s.io/client-go from 0.22.1 to 0.22.4 (#490 #511) 4.20.1 (2021/09/06) \u00b6 Fix notification title (#483) 4.20.0 (2021/09/05) \u00b6 Option to render fields (#480) Allow choosing status to be notified (#475) Enhance notif wording (#467) Wrong remaining time displayed (#469) Allow multi recipients for email notifier (#463) Provide mutable tags for Diun image (#462) Fix Dockerfile parser and add tests (#459) Add e2e tests (#471) Use args in kubernetes documentation example (#424) Fix j2 variable in docs (#422) Note to customize the hostname (#465) Go 1.17 (#458) Add windows/arm64 artifact (#472) Add linux/riscv64 artifact (#427) Alpine Linux 3.14 (#426) MkDocs Material 7.2.6 (#428 #482) Protoc 3.17.3 (#461) Bump github.com/rs/zerolog from 1.23.0 to 1.24.0 (#477) Bump github.com/crazy-max/gonfig from 0.4.0 to 0.5.0 (#474) Bump github.com/gregdel/pushover to 1.1.0 (#470) Bump github.com/streadway/amqp to 1.0.0 (#470) Bump github.com/containers/image/v5 from 5.13.2 to 5.16.0 (#460 #476) Bump k8s.io/client-go from 0.21.2 to 0.22.1 (#466) Bump github.com/docker/docker from 20.10.7 to 20.10.8 (#451) Bump github.com/moby/buildkit from 0.8.3 to 0.9.0 (#437) Bump github.com/containerd/containerd from 1.5.2 to 1.5.5 (#433 #440 #447) Bump github.com/microcosm-cc/bluemonday from 1.0.14 to 1.0.15 (#430) Bump github.com/go-playground/validator/v10 from 10.6.1 to 10.9.0 (#429 #445 #455) Bump github.com/jedib0t/go-pretty/v6 from 6.2.2 to 6.2.4 (#432) Bump google.golang.org/grpc from 1.38.0 to 1.40.0 (#421 #453 #456) Bump google.golang.org/protobuf from 1.26.0 to 1.27.1 (#420) Bump codecov/codecov-action from 1 to 2 4.19.0 (2021/06/26) \u00b6 Allow customizing notification message (#415) Bump github.com/panjf2000/ants/v2 from 2.4.5 to 2.4.6 (#416) Bump k8s.io/client-go from 0.21.1 to 0.21.2 (#414) Bump github.com/microcosm-cc/bluemonday from 1.0.13 to 1.0.14 (#413) Bump github.com/containers/image/v5 from 5.13.1 to 5.13.2 (#412) 4.18.0 (2021/06/18) \u00b6 Handle registry auth config (#411) Bump k8s.io/client-go from 0.20.6 to 0.21.1 (#381) Bump github.com/containers/image/v5 from 5.12.0 to 5.13.1 (#409) Avoid notification for unupdated image (#406) Use openssl pkg (#407) Bump github.com/rs/zerolog from 1.22.0 to 1.23.0 (#405) Bump google.golang.org/grpc from 1.37.0 to 1.38.0 (#389) Bump github.com/microcosm-cc/bluemonday from 1.0.9 to 1.0.13 (#403 #410) Bumps github.com/docker/docker from 20.10.6+incompatible to 20.10.7+incompatible (#397) Bump github.com/jedib0t/go-pretty/v6 from 6.2.1 to 6.2.2 (#388) Bump go.etcd.io/bbolt from 1.3.5 to 1.3.6 (#394) Bump github.com/eclipse/paho.mqtt.golang from 1.3.4 to 1.3.5 (#400) Bump github.com/alecthomas/kong from 0.2.16 to 0.2.17 (#401) Bump github.com/tidwall/pretty from 1.1.0 to 1.2.0 (#390 #402) Set cacheonly output for validators (#395) Define serve command (#393) Save raw manifest in db (#391) 4.17.0 (2021/05/26) \u00b6 See Migration notes in the documentation before upgrading. Add CLI to interact with Diun through gRPC (#382) Create image and notif proto services Implement proto definitions New commands serve , image and notif Refactor command line usage doc Better CLI error handling Tools build constraint to manage tools deps through go modules Compile and validate protos through a dedicated Dockerfile and a bake target Merge validate and build workflow Add upgrade notes Bump github.com/eclipse/paho.mqtt.golang from 1.3.3 to 1.3.4 (#359) Bump github.com/panjf2000/ants/v2 from 2.4.4 to 2.4.5 (#380) Bump github.com/rs/zerolog from 1.21.0 to 1.22.0 (#379) Bump github.com/go-playground/validator/v10 from 10.5.0 to 10.6.1 (#377) MkDocs Materials 7.1.5 (#386) Add NO_COLOR support (#384) Bump github.com/pkg/profile from 1.5.0 to 1.6.0 (#363) Move to docker/metadata-action (#366) Bump github.com/containers/image/v5 from 5.11.1 to 5.12.0 (#360) Bump github.com/containerd/containerd from 1.5.0-beta.4 to 1.5.2 (#353 #361 #362 #383) Add blog posts (#355 #385) Bump github.com/moby/buildkit from 0.8.2 to 0.8.3 (#354) 4.16.1 (2021/04/30) \u00b6 Fix Swarm Provider (#351) 4.16.0 (2021/04/29) \u00b6 Dockerfile provider (#329) Note about watch_repo setting (#348) Contribute to doc (#347) Update docs for Podman support (#345) Optional profiler volume (#344) 4.15.2 (2021/04/25) \u00b6 Make profiler optional (#341) 4.15.1 (2021/04/25) \u00b6 Fix profiler path (#339) 4.15.0 (2021/04/25) \u00b6 Add darwin/arm64 artifact (#338) MkDocs Materials 7.1.3 (#337) Add profiler flag (#336) Handle digest based image reference (#335) Bump github.com/docker/docker from 20.10.5+incompatible to 20.10.6+incompatible (#324) Bump github.com/containers/image/v5 from 5.10.5 to 5.11.1 (#323 #330) Bump github.com/go-playground/validator/v10 from 10.4.1 to 10.5.0 (#319) Bump github.com/panjf2000/ants/v2 from 2.4.3 to 2.4.4 (#312) Bump github.com/rs/zerolog from 1.20.0 to 1.21.0 (#309) Bump github.com/microcosm-cc/bluemonday from 1.0.4 to 1.0.9 (#311 #321 #325 #333) Bump github.com/eclipse/paho.mqtt.golang from 1.3.2 to 1.3.3 (#316) Deploy docs on workflow dispatch or tag (#305) 4.14.0 (2021/03/15) \u00b6 Bump k8s.io/client-go from 0.19.4 to 0.20.4 (#280) Docker client 20.10.5 (#303) Allow telegram chat IDs as file (#301) Go 1.16 (#302) Handle git ref for artifact target Bump github.com/imdario/mergo from 0.3.11 to 0.3.12 (#298) Bump github.com/crazy-max/gohealthchecks from 0.2.0 to 0.3.0 (#296) Bump github.com/alecthomas/kong from 0.2.15 to 0.2.16 (#295) Allow configuring scheme for MQTT broker (#292) Switch to goreleaser-xx (#291) Bump github.com/containers/image/v5 from 5.10.4 to 5.10.5 (#290) 4.13.0 (2021/03/01) \u00b6 Missing token as secret setting for some notifiers (#289) Allow disabling log color output (#288) Bump github.com/containers/image/v5 from 5.10.1 to 5.10.4 (#271 #282 #284) Cleanup workflows (#281 #287) Do not check recipient details for Pushover (#277) MkDocs Materials 6.2.8 (#276) Fix markdown renderer (#275) Add message client for notifiers (#273) 4.12.0 (2021/02/09) \u00b6 Use digest as comparison footprint (#269) Bump github.com/alecthomas/kong from 0.2.12 to 0.2.15 (#270) Bump github.com/eclipse/paho.mqtt.golang from 1.3.1 to 1.3.2 (#268) Bump github.com/containers/image/v5 from 5.9.0 to 5.10.1 (#265) Move to docker/bake-action (#266) Typo in documentation (#258) Log image validation 4.11.0 (2021/01/04) \u00b6 Fix DB migration (#255) Add Pushover notification (#254) Avoid duplicated notifications with Kubernetes DaemonSet (#252) Make scheduler optional (#251) Bump github.com/eclipse/paho.mqtt.golang from 1.3.0 to 1.3.1 (#249) Handle exclusions as a distinct status (#248) 4.10.0 (2020/12/26) \u00b6 Refactor CI and dev workflow with buildx bake (#247) Upload artifacts Add image-local target Single job for artifacts and image Add armv5 artifact MQTT Reconnection Log Spam (#241) Add Docker + File providers user guide (#239) Bump github.com/alecthomas/kong from 0.2.11 to 0.2.12 (#231) Bump github.com/eclipse/paho.mqtt.golang from 1.2.0 to 1.3.0 (#235) Bump github.com/containers/image/v5 from 5.8.1 to 5.9.0 (#236) Bump gopkg.in/yaml.v2 from 2.3.0 to 2.4.0 (#228) Bump github.com/containers/image/v5 from 5.8.0 to 5.8.1 (#226) 4.9.0 (2020/11/16) \u00b6 Fix duplicated notifications Remove support for freebsd/* (moby/moby#38818) Add support for linux/ppc64le and linux/s390x (binary) Bump k8s.io/client-go from 0.19.3 to 0.19.4 (#224) Bump github.com/containers/image/v5 to 5.8.0 4.8.1 (2020/11/14) \u00b6 Fix registry timeout context (#221) Image closer not required while fetching tags 4.8.0 (2020/11/13) \u00b6 Go 1.15 (#218) Remove linux/s390x platform support (for now) Check digest from HEAD request (#217) Add FAQ note about Docker Hub rate limits Compare digest as watch setting Optimize build time Add hub link for GitHub Container Registry (#211) Update deps 4.7.0 (2020/11/02) \u00b6 Add MQTT notification (#192) Docker image also available on GitHub Container Registry Use zoneinfo from Go (#202) Remove --timezone flag Use Docker meta action to handle tags and labels Update deps 4.6.1 (2020/10/22) \u00b6 Typos in documentation Bump docker/login-action from v1.4.1 to v1.6.0 (#198) Bump k8s.io/client-go from 0.19.2 to 0.19.3 (#199) Bump codecov/codecov-action from v1.0.13 to v1.0.14 (#195) Bump github.com/go-playground/validator/v10 from 10.4.0 to 10.4.1 (#197) Bump github.com/panjf2000/ants/v2 from 2.4.2 to 2.4.3 (#196) 4.6.0 (2020/10/13) \u00b6 Add support for Healthchecks to monitor Diun watcher (#78) Add option to mention specific users or roles for Discord notifier (#188) Update docker install documentation Add \"Too many requests to registry\" section in FAQ (#168) Update deps Switch to Docker actions 4.5.0 (2020/08/29) \u00b6 Allow setting the hostname sent to the SMTP server with the HELO command for mail notification (#165) Fix Telegram notification error (#162) 4.4.1 (2020/08/20) \u00b6 Allow using --test-notif without providers and DB connection (#157 #150) Update deps 4.4.0 (2020/08/08) \u00b6 Allow customizing message type for Matrix notifications (#143) 4.3.1 (2020/07/30) \u00b6 Hostname not taken into account for Matrix notifications 4.3.0 (2020/07/29) \u00b6 Add Matrix notification (#124) 4.2.0 (2020/07/16) \u00b6 Seek configuration file from default places (#107) Switch to gonfig Update deps 4.1.1 (2020/06/26) \u00b6 Small typo 4.1.0 (2020/06/26) \u00b6 Discord notifications (#110 #111) Update migration notes (#107) Logging when configuration file or DIUN_ env vars not found (#107) Bump github.com/containers/image/v5 from 5.4.4 to 5.5.1 (#96) 4.0.0 (2020/06/22) \u00b6 See Migration notes in the documentation for breaking changes. Display hostname in notifications (#102) Automatically determine registry options based on image name (#103) Docs website with mkdocs (#99) Skip dangling images (#98) More explicit message if manifest not found (#94) Add swarm example Update doc for file and Swarm providers Add Kubernetes provider (#25) Update Teams notification screenshot (#93) Send message as markdown for Gotify and Telegram notifiers Add link to respective hub (#40) Configuration transposed into environment variables (#82) Configuration file not required anymore DIUN_DB env var renamed DIUN_DB_PATH Only accept duration as timeout value ( 10 becomes 10s ) Enhanced documentation (#83) Add note about test notifications (#79) Improve configuration validation Fix telegram init All fields in configuration are now camelCased Docker API version negotiation (#29) Add Mattermost compatibility via Slack webhooks (#80) Update deps 3.0.0 (2020/05/27) \u00b6 See Migration notes in the documentation for breaking changes. Add script notification (#53) Add Teams notification (#72) Add --test-notif flag (#23) Allow only one Docker and Swarm provider Remove \"enable\" setting for notifiers Logging when no image is found Add Amqp notification client (#63) Fix default log level Move static to file provider (#71) Reload config on change for file provider (#16) Switch to kong command-line parser (#66) Enhanced Dockerfile Review of platform detection (#57) Leave default image platform empty for file provider (see FAQ doc) Handle platform variant Add database migration process Switch to Open Container Specification labels as label-schema.org ones are deprecated Remove unneeded diun.os and diun.arch docker labels Add upgrade notes Update deps 2.6.1 (2020/03/26) \u00b6 Downgrade containers/image to 5.2.1 (#54) 2.6.0 (2020/03/26) \u00b6 Fix service image inspection (#52) Docker client v19.03.8 Update deps 2.5.0 (2020/03/01) \u00b6 Add Rocket.Chat notifier (#44) 2.4.0 (2020/02/17) \u00b6 Add Gotify notification client (#36) Bump containers/image v5 (#35) 2.3.0 (2020/01/28) \u00b6 Add Telegram notifier (#30) Docker client struct options Move registry client to a dedicated package 2.2.1 (2020/01/07) \u00b6 Set user agent for Docker registry client Update deps 2.2.0 (2019/12/22) \u00b6 Add option to skip notification at the very first analysis of an image (#10) Skip analysis of locally built image 2.1.0 (2019/12/17) \u00b6 Add Slack notifier (#8) 2.0.0 (2019/12/14) \u00b6 See Migration notes in the documentation for breaking changes. Include provider in notifications Add providers documentation Move image validation and improve job execution Add Swarm provider Add fields to load sensitive values from file (#7) Add Docker provider (#3) Docker client v19.03.5 Move image field to providers layer and rename it static Update deps Go 1.13.5 Seconds field optional for schedule 1.4.1 (2019/10/20) \u00b6 Update deps Fix Docker labels 1.4.0 (2019/10/01) \u00b6 Multi-platform Docker image Switch to GitHub Actions Stop publishing Docker image on Quay Go 1.12.10 Use GOPROXY 1.3.0 (2019/08/22) \u00b6 Add Linux service doc and sample Move documentation Fix go mod Remove --docker flag Allow overriding database path through DIUN_DB env var 1.2.0 (2019/08/18) \u00b6 Update deps Display containers/image logs Fix registry options not setted (#5) 1.1.0 (2019/07/24) \u00b6 Update deps 1.0.2 (2019/07/01) \u00b6 Worker pool can be full while retrieving tags 1.0.1 (2019/07/01) \u00b6 Fix runtime error 1.0.0 (2019/07/01) \u00b6 See Migration notes in the documentation for breaking changes. Always run on startup. Flag --run-startup removed. Display next execution time Use v3 robfig/cron Move Os and Arch filters to image Retrieve all tags by default Review config file structure Improve worker pool 0.5.0 (2019/06/09) \u00b6 Add worker pool to parallelize analyses 0.4.1 (2019/06/08) \u00b6 Filter tags before return them 0.4.0 (2019/06/08) \u00b6 Add option to set the maximum number of tags to watch for an item if watch_repo is enabled 0.3.2 (2019/06/08) \u00b6 Fix registry client context 0.3.1 (2019/06/08) \u00b6 Fix email template Add flag to log caller 0.3.0 (2019/06/08) \u00b6 Allow overriding os and architecture when watching Move insecure_tls and timeout options to registry option Rename Bolt bucket Change default schedule Review registry client 0.2.0 (2019/06/05) \u00b6 Don't skip repo analysis if default tag not found Docker engine 18.09.6 0.1.1 (2019/06/04) \u00b6 Increase default timeout Fix data volume mount 0.1.0 (2019/06/04) \u00b6 Initial version","title":"Changelog"},{"location":"changelog/#changelog","text":"","title":"Changelog"},{"location":"changelog/#4210-20210126","text":"Add image prune command (#519) Fix matrix login scheme (#487) Move syscall to golang.org/x/sys (#525) Move from io/ioutil to os package (#524) Fix notif template in docs Enhance dockerfiles (#523) Add binary bake target (#517) MkDocs Material 8.1.8 (#520 #548) Alpine Linux 3.15 (#527) goreleaser-xx 1.2.5 (#539) Bump github.com/alecthomas/kong from 0.2.17 to 0.3.0 (#507 #537) Bump github.com/containerd/containerd from 1.5.5 to 1.5.8 (#494 #496 #509) Bump github.com/containers/image/v5 from 5.16.0 to 5.19.0 (#498 #536 #546) Bump github.com/docker/docker from 20.10.8+incompatible to 20.10.12+incompatible (#500 #510 #531) Bump github.com/go-playground/validator/v10 from 10.9.0 to 10.10.0 (#538) Bump github.com/jedib0t/go-pretty/v6 from 6.2.4 to 6.2.5 (#543) Bump github.com/microcosm-cc/bluemonday from 1.0.15 to 1.0.17 (#499 #535) Bump github.com/moby/buildkit from 0.9.0 to 0.9.3 (#495 #506 #512) Bump github.com/opencontainers/image-spec to v1.0.2-0.20211117181255-693428a734f5 (#513) Bump github.com/panjf2000/ants/v2 from 2.4.6 to 2.4.7 (#532) Bump github.com/rs/zerolog from 1.24.0 to 1.26.1 (#485 #502 #534) Bump google.golang.org/grpc from 1.40.0 to 1.44.0 (#492 #505 #529 #545) Bump google.golang.org/grpc/cmd/protoc-gen-go-grpc from 1.1.0 to 1.2.0 (#533) Bump k8s.io/client-go from 0.22.1 to 0.22.4 (#490 #511)","title":"4.21.0 (2021/01/26)"},{"location":"changelog/#4201-20210906","text":"Fix notification title (#483)","title":"4.20.1 (2021/09/06)"},{"location":"changelog/#4200-20210905","text":"Option to render fields (#480) Allow choosing status to be notified (#475) Enhance notif wording (#467) Wrong remaining time displayed (#469) Allow multi recipients for email notifier (#463) Provide mutable tags for Diun image (#462) Fix Dockerfile parser and add tests (#459) Add e2e tests (#471) Use args in kubernetes documentation example (#424) Fix j2 variable in docs (#422) Note to customize the hostname (#465) Go 1.17 (#458) Add windows/arm64 artifact (#472) Add linux/riscv64 artifact (#427) Alpine Linux 3.14 (#426) MkDocs Material 7.2.6 (#428 #482) Protoc 3.17.3 (#461) Bump github.com/rs/zerolog from 1.23.0 to 1.24.0 (#477) Bump github.com/crazy-max/gonfig from 0.4.0 to 0.5.0 (#474) Bump github.com/gregdel/pushover to 1.1.0 (#470) Bump github.com/streadway/amqp to 1.0.0 (#470) Bump github.com/containers/image/v5 from 5.13.2 to 5.16.0 (#460 #476) Bump k8s.io/client-go from 0.21.2 to 0.22.1 (#466) Bump github.com/docker/docker from 20.10.7 to 20.10.8 (#451) Bump github.com/moby/buildkit from 0.8.3 to 0.9.0 (#437) Bump github.com/containerd/containerd from 1.5.2 to 1.5.5 (#433 #440 #447) Bump github.com/microcosm-cc/bluemonday from 1.0.14 to 1.0.15 (#430) Bump github.com/go-playground/validator/v10 from 10.6.1 to 10.9.0 (#429 #445 #455) Bump github.com/jedib0t/go-pretty/v6 from 6.2.2 to 6.2.4 (#432) Bump google.golang.org/grpc from 1.38.0 to 1.40.0 (#421 #453 #456) Bump google.golang.org/protobuf from 1.26.0 to 1.27.1 (#420) Bump codecov/codecov-action from 1 to 2","title":"4.20.0 (2021/09/05)"},{"location":"changelog/#4190-20210626","text":"Allow customizing notification message (#415) Bump github.com/panjf2000/ants/v2 from 2.4.5 to 2.4.6 (#416) Bump k8s.io/client-go from 0.21.1 to 0.21.2 (#414) Bump github.com/microcosm-cc/bluemonday from 1.0.13 to 1.0.14 (#413) Bump github.com/containers/image/v5 from 5.13.1 to 5.13.2 (#412)","title":"4.19.0 (2021/06/26)"},{"location":"changelog/#4180-20210618","text":"Handle registry auth config (#411) Bump k8s.io/client-go from 0.20.6 to 0.21.1 (#381) Bump github.com/containers/image/v5 from 5.12.0 to 5.13.1 (#409) Avoid notification for unupdated image (#406) Use openssl pkg (#407) Bump github.com/rs/zerolog from 1.22.0 to 1.23.0 (#405) Bump google.golang.org/grpc from 1.37.0 to 1.38.0 (#389) Bump github.com/microcosm-cc/bluemonday from 1.0.9 to 1.0.13 (#403 #410) Bumps github.com/docker/docker from 20.10.6+incompatible to 20.10.7+incompatible (#397) Bump github.com/jedib0t/go-pretty/v6 from 6.2.1 to 6.2.2 (#388) Bump go.etcd.io/bbolt from 1.3.5 to 1.3.6 (#394) Bump github.com/eclipse/paho.mqtt.golang from 1.3.4 to 1.3.5 (#400) Bump github.com/alecthomas/kong from 0.2.16 to 0.2.17 (#401) Bump github.com/tidwall/pretty from 1.1.0 to 1.2.0 (#390 #402) Set cacheonly output for validators (#395) Define serve command (#393) Save raw manifest in db (#391)","title":"4.18.0 (2021/06/18)"},{"location":"changelog/#4170-20210526","text":"See Migration notes in the documentation before upgrading. Add CLI to interact with Diun through gRPC (#382) Create image and notif proto services Implement proto definitions New commands serve , image and notif Refactor command line usage doc Better CLI error handling Tools build constraint to manage tools deps through go modules Compile and validate protos through a dedicated Dockerfile and a bake target Merge validate and build workflow Add upgrade notes Bump github.com/eclipse/paho.mqtt.golang from 1.3.3 to 1.3.4 (#359) Bump github.com/panjf2000/ants/v2 from 2.4.4 to 2.4.5 (#380) Bump github.com/rs/zerolog from 1.21.0 to 1.22.0 (#379) Bump github.com/go-playground/validator/v10 from 10.5.0 to 10.6.1 (#377) MkDocs Materials 7.1.5 (#386) Add NO_COLOR support (#384) Bump github.com/pkg/profile from 1.5.0 to 1.6.0 (#363) Move to docker/metadata-action (#366) Bump github.com/containers/image/v5 from 5.11.1 to 5.12.0 (#360) Bump github.com/containerd/containerd from 1.5.0-beta.4 to 1.5.2 (#353 #361 #362 #383) Add blog posts (#355 #385) Bump github.com/moby/buildkit from 0.8.2 to 0.8.3 (#354)","title":"4.17.0 (2021/05/26)"},{"location":"changelog/#4161-20210430","text":"Fix Swarm Provider (#351)","title":"4.16.1 (2021/04/30)"},{"location":"changelog/#4160-20210429","text":"Dockerfile provider (#329) Note about watch_repo setting (#348) Contribute to doc (#347) Update docs for Podman support (#345) Optional profiler volume (#344)","title":"4.16.0 (2021/04/29)"},{"location":"changelog/#4152-20210425","text":"Make profiler optional (#341)","title":"4.15.2 (2021/04/25)"},{"location":"changelog/#4151-20210425","text":"Fix profiler path (#339)","title":"4.15.1 (2021/04/25)"},{"location":"changelog/#4150-20210425","text":"Add darwin/arm64 artifact (#338) MkDocs Materials 7.1.3 (#337) Add profiler flag (#336) Handle digest based image reference (#335) Bump github.com/docker/docker from 20.10.5+incompatible to 20.10.6+incompatible (#324) Bump github.com/containers/image/v5 from 5.10.5 to 5.11.1 (#323 #330) Bump github.com/go-playground/validator/v10 from 10.4.1 to 10.5.0 (#319) Bump github.com/panjf2000/ants/v2 from 2.4.3 to 2.4.4 (#312) Bump github.com/rs/zerolog from 1.20.0 to 1.21.0 (#309) Bump github.com/microcosm-cc/bluemonday from 1.0.4 to 1.0.9 (#311 #321 #325 #333) Bump github.com/eclipse/paho.mqtt.golang from 1.3.2 to 1.3.3 (#316) Deploy docs on workflow dispatch or tag (#305)","title":"4.15.0 (2021/04/25)"},{"location":"changelog/#4140-20210315","text":"Bump k8s.io/client-go from 0.19.4 to 0.20.4 (#280) Docker client 20.10.5 (#303) Allow telegram chat IDs as file (#301) Go 1.16 (#302) Handle git ref for artifact target Bump github.com/imdario/mergo from 0.3.11 to 0.3.12 (#298) Bump github.com/crazy-max/gohealthchecks from 0.2.0 to 0.3.0 (#296) Bump github.com/alecthomas/kong from 0.2.15 to 0.2.16 (#295) Allow configuring scheme for MQTT broker (#292) Switch to goreleaser-xx (#291) Bump github.com/containers/image/v5 from 5.10.4 to 5.10.5 (#290)","title":"4.14.0 (2021/03/15)"},{"location":"changelog/#4130-20210301","text":"Missing token as secret setting for some notifiers (#289) Allow disabling log color output (#288) Bump github.com/containers/image/v5 from 5.10.1 to 5.10.4 (#271 #282 #284) Cleanup workflows (#281 #287) Do not check recipient details for Pushover (#277) MkDocs Materials 6.2.8 (#276) Fix markdown renderer (#275) Add message client for notifiers (#273)","title":"4.13.0 (2021/03/01)"},{"location":"changelog/#4120-20210209","text":"Use digest as comparison footprint (#269) Bump github.com/alecthomas/kong from 0.2.12 to 0.2.15 (#270) Bump github.com/eclipse/paho.mqtt.golang from 1.3.1 to 1.3.2 (#268) Bump github.com/containers/image/v5 from 5.9.0 to 5.10.1 (#265) Move to docker/bake-action (#266) Typo in documentation (#258) Log image validation","title":"4.12.0 (2021/02/09)"},{"location":"changelog/#4110-20210104","text":"Fix DB migration (#255) Add Pushover notification (#254) Avoid duplicated notifications with Kubernetes DaemonSet (#252) Make scheduler optional (#251) Bump github.com/eclipse/paho.mqtt.golang from 1.3.0 to 1.3.1 (#249) Handle exclusions as a distinct status (#248)","title":"4.11.0 (2021/01/04)"},{"location":"changelog/#4100-20201226","text":"Refactor CI and dev workflow with buildx bake (#247) Upload artifacts Add image-local target Single job for artifacts and image Add armv5 artifact MQTT Reconnection Log Spam (#241) Add Docker + File providers user guide (#239) Bump github.com/alecthomas/kong from 0.2.11 to 0.2.12 (#231) Bump github.com/eclipse/paho.mqtt.golang from 1.2.0 to 1.3.0 (#235) Bump github.com/containers/image/v5 from 5.8.1 to 5.9.0 (#236) Bump gopkg.in/yaml.v2 from 2.3.0 to 2.4.0 (#228) Bump github.com/containers/image/v5 from 5.8.0 to 5.8.1 (#226)","title":"4.10.0 (2020/12/26)"},{"location":"changelog/#490-20201116","text":"Fix duplicated notifications Remove support for freebsd/* (moby/moby#38818) Add support for linux/ppc64le and linux/s390x (binary) Bump k8s.io/client-go from 0.19.3 to 0.19.4 (#224) Bump github.com/containers/image/v5 to 5.8.0","title":"4.9.0 (2020/11/16)"},{"location":"changelog/#481-20201114","text":"Fix registry timeout context (#221) Image closer not required while fetching tags","title":"4.8.1 (2020/11/14)"},{"location":"changelog/#480-20201113","text":"Go 1.15 (#218) Remove linux/s390x platform support (for now) Check digest from HEAD request (#217) Add FAQ note about Docker Hub rate limits Compare digest as watch setting Optimize build time Add hub link for GitHub Container Registry (#211) Update deps","title":"4.8.0 (2020/11/13)"},{"location":"changelog/#470-20201102","text":"Add MQTT notification (#192) Docker image also available on GitHub Container Registry Use zoneinfo from Go (#202) Remove --timezone flag Use Docker meta action to handle tags and labels Update deps","title":"4.7.0 (2020/11/02)"},{"location":"changelog/#461-20201022","text":"Typos in documentation Bump docker/login-action from v1.4.1 to v1.6.0 (#198) Bump k8s.io/client-go from 0.19.2 to 0.19.3 (#199) Bump codecov/codecov-action from v1.0.13 to v1.0.14 (#195) Bump github.com/go-playground/validator/v10 from 10.4.0 to 10.4.1 (#197) Bump github.com/panjf2000/ants/v2 from 2.4.2 to 2.4.3 (#196)","title":"4.6.1 (2020/10/22)"},{"location":"changelog/#460-20201013","text":"Add support for Healthchecks to monitor Diun watcher (#78) Add option to mention specific users or roles for Discord notifier (#188) Update docker install documentation Add \"Too many requests to registry\" section in FAQ (#168) Update deps Switch to Docker actions","title":"4.6.0 (2020/10/13)"},{"location":"changelog/#450-20200829","text":"Allow setting the hostname sent to the SMTP server with the HELO command for mail notification (#165) Fix Telegram notification error (#162)","title":"4.5.0 (2020/08/29)"},{"location":"changelog/#441-20200820","text":"Allow using --test-notif without providers and DB connection (#157 #150) Update deps","title":"4.4.1 (2020/08/20)"},{"location":"changelog/#440-20200808","text":"Allow customizing message type for Matrix notifications (#143)","title":"4.4.0 (2020/08/08)"},{"location":"changelog/#431-20200730","text":"Hostname not taken into account for Matrix notifications","title":"4.3.1 (2020/07/30)"},{"location":"changelog/#430-20200729","text":"Add Matrix notification (#124)","title":"4.3.0 (2020/07/29)"},{"location":"changelog/#420-20200716","text":"Seek configuration file from default places (#107) Switch to gonfig Update deps","title":"4.2.0 (2020/07/16)"},{"location":"changelog/#411-20200626","text":"Small typo","title":"4.1.1 (2020/06/26)"},{"location":"changelog/#410-20200626","text":"Discord notifications (#110 #111) Update migration notes (#107) Logging when configuration file or DIUN_ env vars not found (#107) Bump github.com/containers/image/v5 from 5.4.4 to 5.5.1 (#96)","title":"4.1.0 (2020/06/26)"},{"location":"changelog/#400-20200622","text":"See Migration notes in the documentation for breaking changes. Display hostname in notifications (#102) Automatically determine registry options based on image name (#103) Docs website with mkdocs (#99) Skip dangling images (#98) More explicit message if manifest not found (#94) Add swarm example Update doc for file and Swarm providers Add Kubernetes provider (#25) Update Teams notification screenshot (#93) Send message as markdown for Gotify and Telegram notifiers Add link to respective hub (#40) Configuration transposed into environment variables (#82) Configuration file not required anymore DIUN_DB env var renamed DIUN_DB_PATH Only accept duration as timeout value ( 10 becomes 10s ) Enhanced documentation (#83) Add note about test notifications (#79) Improve configuration validation Fix telegram init All fields in configuration are now camelCased Docker API version negotiation (#29) Add Mattermost compatibility via Slack webhooks (#80) Update deps","title":"4.0.0 (2020/06/22)"},{"location":"changelog/#300-20200527","text":"See Migration notes in the documentation for breaking changes. Add script notification (#53) Add Teams notification (#72) Add --test-notif flag (#23) Allow only one Docker and Swarm provider Remove \"enable\" setting for notifiers Logging when no image is found Add Amqp notification client (#63) Fix default log level Move static to file provider (#71) Reload config on change for file provider (#16) Switch to kong command-line parser (#66) Enhanced Dockerfile Review of platform detection (#57) Leave default image platform empty for file provider (see FAQ doc) Handle platform variant Add database migration process Switch to Open Container Specification labels as label-schema.org ones are deprecated Remove unneeded diun.os and diun.arch docker labels Add upgrade notes Update deps","title":"3.0.0 (2020/05/27)"},{"location":"changelog/#261-20200326","text":"Downgrade containers/image to 5.2.1 (#54)","title":"2.6.1 (2020/03/26)"},{"location":"changelog/#260-20200326","text":"Fix service image inspection (#52) Docker client v19.03.8 Update deps","title":"2.6.0 (2020/03/26)"},{"location":"changelog/#250-20200301","text":"Add Rocket.Chat notifier (#44)","title":"2.5.0 (2020/03/01)"},{"location":"changelog/#240-20200217","text":"Add Gotify notification client (#36) Bump containers/image v5 (#35)","title":"2.4.0 (2020/02/17)"},{"location":"changelog/#230-20200128","text":"Add Telegram notifier (#30) Docker client struct options Move registry client to a dedicated package","title":"2.3.0 (2020/01/28)"},{"location":"changelog/#221-20200107","text":"Set user agent for Docker registry client Update deps","title":"2.2.1 (2020/01/07)"},{"location":"changelog/#220-20191222","text":"Add option to skip notification at the very first analysis of an image (#10) Skip analysis of locally built image","title":"2.2.0 (2019/12/22)"},{"location":"changelog/#210-20191217","text":"Add Slack notifier (#8)","title":"2.1.0 (2019/12/17)"},{"location":"changelog/#200-20191214","text":"See Migration notes in the documentation for breaking changes. Include provider in notifications Add providers documentation Move image validation and improve job execution Add Swarm provider Add fields to load sensitive values from file (#7) Add Docker provider (#3) Docker client v19.03.5 Move image field to providers layer and rename it static Update deps Go 1.13.5 Seconds field optional for schedule","title":"2.0.0 (2019/12/14)"},{"location":"changelog/#141-20191020","text":"Update deps Fix Docker labels","title":"1.4.1 (2019/10/20)"},{"location":"changelog/#140-20191001","text":"Multi-platform Docker image Switch to GitHub Actions Stop publishing Docker image on Quay Go 1.12.10 Use GOPROXY","title":"1.4.0 (2019/10/01)"},{"location":"changelog/#130-20190822","text":"Add Linux service doc and sample Move documentation Fix go mod Remove --docker flag Allow overriding database path through DIUN_DB env var","title":"1.3.0 (2019/08/22)"},{"location":"changelog/#120-20190818","text":"Update deps Display containers/image logs Fix registry options not setted (#5)","title":"1.2.0 (2019/08/18)"},{"location":"changelog/#110-20190724","text":"Update deps","title":"1.1.0 (2019/07/24)"},{"location":"changelog/#102-20190701","text":"Worker pool can be full while retrieving tags","title":"1.0.2 (2019/07/01)"},{"location":"changelog/#101-20190701","text":"Fix runtime error","title":"1.0.1 (2019/07/01)"},{"location":"changelog/#100-20190701","text":"See Migration notes in the documentation for breaking changes. Always run on startup. Flag --run-startup removed. Display next execution time Use v3 robfig/cron Move Os and Arch filters to image Retrieve all tags by default Review config file structure Improve worker pool","title":"1.0.0 (2019/07/01)"},{"location":"changelog/#050-20190609","text":"Add worker pool to parallelize analyses","title":"0.5.0 (2019/06/09)"},{"location":"changelog/#041-20190608","text":"Filter tags before return them","title":"0.4.1 (2019/06/08)"},{"location":"changelog/#040-20190608","text":"Add option to set the maximum number of tags to watch for an item if watch_repo is enabled","title":"0.4.0 (2019/06/08)"},{"location":"changelog/#032-20190608","text":"Fix registry client context","title":"0.3.2 (2019/06/08)"},{"location":"changelog/#031-20190608","text":"Fix email template Add flag to log caller","title":"0.3.1 (2019/06/08)"},{"location":"changelog/#030-20190608","text":"Allow overriding os and architecture when watching Move insecure_tls and timeout options to registry option Rename Bolt bucket Change default schedule Review registry client","title":"0.3.0 (2019/06/08)"},{"location":"changelog/#020-20190605","text":"Don't skip repo analysis if default tag not found Docker engine 18.09.6","title":"0.2.0 (2019/06/05)"},{"location":"changelog/#011-20190604","text":"Increase default timeout Fix data volume mount","title":"0.1.1 (2019/06/04)"},{"location":"changelog/#010-20190604","text":"Initial version","title":"0.1.0 (2019/06/04)"},{"location":"contributing/","text":"Contributing \u00b6 Hi there! I'm thrilled that you'd like to contribute to this project. Your help is essential for keeping it great. Contributions to this project are released to the public under the project's open source license . Submitting a pull request \u00b6 Fork and clone the repository Configure and install the dependencies: go mod download Create a new branch: git checkout -b my-branch-name Make your changes Validate: docker buildx bake validate Test your code: docker buildx bake test Build the project: docker buildx bake artifact-all image-all Push to your fork and submit a pull request Pat your self on the back and wait for your pull request to be reviewed and merged. Here are a few things you can do that will increase the likelihood of your pull request being accepted: Make sure the README.md and any other relevant documentation are kept up-to-date . I try to follow SemVer v2.0.0 . Randomly breaking public APIs is not an option. Keep your change as focused as possible. If there are multiple changes you would like to make that are not dependent upon each other, consider submitting them as separate pull requests . Write a good commit message . Documentation \u00b6 If you want to contribute to the documentation you can test its rendering locally with the following commands: # Build mkdocs image docker build -t mkdocs -f ./hack/docs.Dockerfile --target base . # Run mkdocs image and watch for changes docker run --rm -it -p 8000 :8000 -v $( pwd ) :/docs mkdocs # Open http://localhost:8000 on your browser Resources \u00b6 How to Contribute to Open Source Using Pull Requests GitHub Help","title":"Contributing"},{"location":"contributing/#contributing","text":"Hi there! I'm thrilled that you'd like to contribute to this project. Your help is essential for keeping it great. Contributions to this project are released to the public under the project's open source license .","title":"Contributing"},{"location":"contributing/#submitting-a-pull-request","text":"Fork and clone the repository Configure and install the dependencies: go mod download Create a new branch: git checkout -b my-branch-name Make your changes Validate: docker buildx bake validate Test your code: docker buildx bake test Build the project: docker buildx bake artifact-all image-all Push to your fork and submit a pull request Pat your self on the back and wait for your pull request to be reviewed and merged. Here are a few things you can do that will increase the likelihood of your pull request being accepted: Make sure the README.md and any other relevant documentation are kept up-to-date . I try to follow SemVer v2.0.0 . Randomly breaking public APIs is not an option. Keep your change as focused as possible. If there are multiple changes you would like to make that are not dependent upon each other, consider submitting them as separate pull requests . Write a good commit message .","title":"Submitting a pull request"},{"location":"contributing/#documentation","text":"If you want to contribute to the documentation you can test its rendering locally with the following commands: # Build mkdocs image docker build -t mkdocs -f ./hack/docs.Dockerfile --target base . # Run mkdocs image and watch for changes docker run --rm -it -p 8000 :8000 -v $( pwd ) :/docs mkdocs # Open http://localhost:8000 on your browser","title":"Documentation"},{"location":"contributing/#resources","text":"How to Contribute to Open Source Using Pull Requests GitHub Help","title":"Resources"},{"location":"donate/","text":"Diun is free and open source and always will be. All kinds of contributions are welcome! The most basic way to show your support is to star the project , or to raise issues. You can also support this project by becoming a sponsor on GitHub or by making a Paypal donation to ensure this journey continues indefinitely!","title":"Donate"},{"location":"faq/","text":"FAQ \u00b6 Timezone \u00b6 By default, all interpretation and scheduling is done with your local timezone ( TZ environment variable). Cron schedule may also override the timezone to be interpreted in by providing an additional space-separated field at the beginning of the cron spec, of the form CRON_TZ=<timezone> : watch : schedule : \"CRON_TZ=Asia/Tokyo 0 */6 * * *\" Test notifications \u00b6 Through the command line with: diun notif test Or within a container: docker-compose exec diun diun notif test Customize the hostname \u00b6 The hostname that appears in your notifications is the one associated with the container if you use the Diun image with docker run or docker-compose up -d . By default, it's a random string like d2219b854598 . To change it: $ docker run --hostname \"diun\" ... Or if you use docker-compose: services : diun : image : crazymax/diun:latest hostname : diun ... Notification template \u00b6 The title and body of a notification message can be customized for each notifier through templateTitle and templateBody fields except for those rendering JSON or Env like Amqp , MQTT , Script and Webhook . Templating is supported with the following fields: Key Description .Meta.ID App ID: diun .Meta.Name App Name: Diun .Meta.Desc App description: Docker image update notifier .Meta.URL App repo URL: https://github.com/crazy-max/diun .Meta.Logo App logo URL: https://raw.githubusercontent.com/crazy-max/diun/master/.res/diun.png .Meta.Author App author: CrazyMax .Meta.Version App version: v4.19.0 .Meta.UserAgent App user-agent used to talk with registries: diun/4.19.0 go/1.16 Linux .Meta.Hostname Hostname .Entry.Status Entry status. Can be new , update , unchange , skip or error .Entry.Provider Provider used .Entry.Image Docker image name. e.g. docker.io/crazymax/diun:latest .Entry.Image.Domain Docker image domain. e.g. docker.io .Entry.Image.Path Docker image path. e.g. crazymax/diun .Entry.Image.Tag Docker image tag. e.g. latest .Entry.Image.Digest Docker image digest .Entry.Image.HubLink Docker image hub link (if available). e.g. https://hub.docker.com/r/crazymax/diun .Entry.Manifest.Name Manifest name. e.g. docker.io/crazymax/diun .Entry.Manifest.Tag Manifest tag. e.g. latest .Entry.Manifest.MIMEType Manifest MIME type. e.g. application/vnd.docker.distribution.manifest.list.v2+json .Entry.Manifest.Digest Manifest digest .Entry.Manifest.Created Manifest created date. e.g. 2021-06-20T12:23:56Z .Entry.Manifest.DockerVersion Version of Docker that was used to build the image. e.g. 20.10.7 .Entry.Manifest.Labels Image labels .Entry.Manifest.Layers Image layers .Entry.Manifest.Platform Platform that the image is runs on. e.g. linux/amd64 Authentication against the registry \u00b6 You can authenticate against the registry through the regopts settings or you can mount your docker config file $HOME/.docker/config.json if you are already connected to the registry with docker login : version : \"3.5\" services : diun : image : crazymax/diun:latest container_name : diun command : serve volumes : - \"./data:/data\" - \"/root/.docker/config.json:/root/.docker/config.json:ro\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\" - \"DIUN_PROVIDERS_DOCKER=true\" - \"DIUN_PROVIDERS_DOCKER_WATCHBYDEFAULT=true\" restart : always field docker|swarm uses unsupported type: invalid \u00b6 If you have the error failed to decode configuration from file: field docker uses unsupported type: invalid that's because your docker , swarm or kubernetes provider is not initialized in your configuration: Failure providers : docker : should be: Success providers : docker : {} No image found in manifest list for architecture, variant, OS \u00b6 If you encounter this kind of warning, you are probably using the file provider for an image with an erroneous or empty platform. If the platform is not filled in, it will be deduced automatically from the information of your operating system on which Diun is running. In the example below, Diun is running ( diun_x.x.x_windows_i386.zip ) on Windows 10 and tries to analyze the crazymax/cloudflared image with the detected platform ( windows/386) : - name : crazymax/cloudflared:2020.2.1 But this platform is not supported by this image as you can see on DockerHub : Warning Fri, 27 Mar 2020 01:20:03 UTC WRN Cannot get remote manifest error=\"Cannot create image closer: Error choosing image instance: no image found in manifest list for architecture 386, variant \\\"\\\", OS windows\" image=docker.io/image=crazymax/cloudflared:2020.2.1 provider=file You have to force the platform for this image if you are not on a supported platform: - name : crazymax/cloudflared:2020.2.1 platform : os : linux arch : amd64 Success Fri, 27 Mar 2020 01:24:33 UTC INF New image found image=docker.io/crazymax/cloudflared:2020.2.1 provider=file Too many requests to registry \u00b6 The error Cannot create image closer: too many requests to registry is returned when the HTTP status code returned by the registry is 429. This can happen on the DockerHub registry because of the rate-limited anonymous pulls . To solve this you must first be authenticated against the registry through the regopts settings : regopts : - name : \"docker.io\" selector : image username : foo password : bar If this is not enough, tweak the schedule setting with something like 0 */6 * * * (every 6 hours). Docker Hub rate limits \u00b6 Docker is now enforcing Docker Hub pull rate limits . This means you can make 100 pull image requests per six hours for anonymous usage, and 200 pull image requests per six hours for free Docker accounts. But this rate limit is not necessarily an indicator on the number of times an image has actually been downloaded. In fact, their pulls counter/metric is actually a representation of the number of times a manifest for a particular image has been retrieved. As you probably know, Diun downloads the manifest of an image from its registry through a GET request to be able to retrieve its inside metadata. Fortunately Diun doesn't perform a GET request at each scan but only when an image has been updated or added on the registry. This allows us not to exceed this rate limit in our situation, but it also strongly depends on the number of images you scan . To increase your pull rate limits you can upgrade your account to a Docker Pro or Team subscription and authenticate against the registry through the regopts settings : regopts : - name : \"docker.io\" selector : image username : foo password : bar Or you can tweak the schedule setting with something like 0 */6 * * * (every 6 hours). Warning Also be careful with the watch_repo setting as it will fetch manifest for ALL tags available for the image. Profiling \u00b6 Diun provides a simple way to manage runtime/pprof profiling through the --profiler-path and --profiler flags with serve command : version : \"3.5\" services : diun : image : crazymax/diun:latest container_name : diun command : serve volumes : - \"./data:/data\" - \"./profiler:/profiler\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"PROFILER_PATH=/profiler\" - \"PROFILER=mem\" - \"DIUN_PROVIDERS_DOCKER=true\" restart : always Following profilers are available: cpu enables cpu profiling mem enables memory profiling alloc enables memory profiling and changes which type of memory to profile allocations heap enables memory profiling and changes which type of memory profiling to profile the heap routines enables goroutine profiling mutex enables mutex profiling threads enables thread creation profiling block enables block (contention) profiling","title":"FAQ"},{"location":"faq/#faq","text":"","title":"FAQ"},{"location":"faq/#timezone","text":"By default, all interpretation and scheduling is done with your local timezone ( TZ environment variable). Cron schedule may also override the timezone to be interpreted in by providing an additional space-separated field at the beginning of the cron spec, of the form CRON_TZ=<timezone> : watch : schedule : \"CRON_TZ=Asia/Tokyo 0 */6 * * *\"","title":"Timezone"},{"location":"faq/#test-notifications","text":"Through the command line with: diun notif test Or within a container: docker-compose exec diun diun notif test","title":"Test notifications"},{"location":"faq/#customize-the-hostname","text":"The hostname that appears in your notifications is the one associated with the container if you use the Diun image with docker run or docker-compose up -d . By default, it's a random string like d2219b854598 . To change it: $ docker run --hostname \"diun\" ... Or if you use docker-compose: services : diun : image : crazymax/diun:latest hostname : diun ...","title":"Customize the hostname"},{"location":"faq/#notification-template","text":"The title and body of a notification message can be customized for each notifier through templateTitle and templateBody fields except for those rendering JSON or Env like Amqp , MQTT , Script and Webhook . Templating is supported with the following fields: Key Description .Meta.ID App ID: diun .Meta.Name App Name: Diun .Meta.Desc App description: Docker image update notifier .Meta.URL App repo URL: https://github.com/crazy-max/diun .Meta.Logo App logo URL: https://raw.githubusercontent.com/crazy-max/diun/master/.res/diun.png .Meta.Author App author: CrazyMax .Meta.Version App version: v4.19.0 .Meta.UserAgent App user-agent used to talk with registries: diun/4.19.0 go/1.16 Linux .Meta.Hostname Hostname .Entry.Status Entry status. Can be new , update , unchange , skip or error .Entry.Provider Provider used .Entry.Image Docker image name. e.g. docker.io/crazymax/diun:latest .Entry.Image.Domain Docker image domain. e.g. docker.io .Entry.Image.Path Docker image path. e.g. crazymax/diun .Entry.Image.Tag Docker image tag. e.g. latest .Entry.Image.Digest Docker image digest .Entry.Image.HubLink Docker image hub link (if available). e.g. https://hub.docker.com/r/crazymax/diun .Entry.Manifest.Name Manifest name. e.g. docker.io/crazymax/diun .Entry.Manifest.Tag Manifest tag. e.g. latest .Entry.Manifest.MIMEType Manifest MIME type. e.g. application/vnd.docker.distribution.manifest.list.v2+json .Entry.Manifest.Digest Manifest digest .Entry.Manifest.Created Manifest created date. e.g. 2021-06-20T12:23:56Z .Entry.Manifest.DockerVersion Version of Docker that was used to build the image. e.g. 20.10.7 .Entry.Manifest.Labels Image labels .Entry.Manifest.Layers Image layers .Entry.Manifest.Platform Platform that the image is runs on. e.g. linux/amd64","title":"Notification template"},{"location":"faq/#authentication-against-the-registry","text":"You can authenticate against the registry through the regopts settings or you can mount your docker config file $HOME/.docker/config.json if you are already connected to the registry with docker login : version : \"3.5\" services : diun : image : crazymax/diun:latest container_name : diun command : serve volumes : - \"./data:/data\" - \"/root/.docker/config.json:/root/.docker/config.json:ro\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\" - \"DIUN_PROVIDERS_DOCKER=true\" - \"DIUN_PROVIDERS_DOCKER_WATCHBYDEFAULT=true\" restart : always","title":"Authentication against the registry"},{"location":"faq/#field-dockerswarm-uses-unsupported-type-invalid","text":"If you have the error failed to decode configuration from file: field docker uses unsupported type: invalid that's because your docker , swarm or kubernetes provider is not initialized in your configuration: Failure providers : docker : should be: Success providers : docker : {}","title":"field docker|swarm uses unsupported type: invalid"},{"location":"faq/#no-image-found-in-manifest-list-for-architecture-variant-os","text":"If you encounter this kind of warning, you are probably using the file provider for an image with an erroneous or empty platform. If the platform is not filled in, it will be deduced automatically from the information of your operating system on which Diun is running. In the example below, Diun is running ( diun_x.x.x_windows_i386.zip ) on Windows 10 and tries to analyze the crazymax/cloudflared image with the detected platform ( windows/386) : - name : crazymax/cloudflared:2020.2.1 But this platform is not supported by this image as you can see on DockerHub : Warning Fri, 27 Mar 2020 01:20:03 UTC WRN Cannot get remote manifest error=\"Cannot create image closer: Error choosing image instance: no image found in manifest list for architecture 386, variant \\\"\\\", OS windows\" image=docker.io/image=crazymax/cloudflared:2020.2.1 provider=file You have to force the platform for this image if you are not on a supported platform: - name : crazymax/cloudflared:2020.2.1 platform : os : linux arch : amd64 Success Fri, 27 Mar 2020 01:24:33 UTC INF New image found image=docker.io/crazymax/cloudflared:2020.2.1 provider=file","title":"No image found in manifest list for architecture, variant, OS"},{"location":"faq/#too-many-requests-to-registry","text":"The error Cannot create image closer: too many requests to registry is returned when the HTTP status code returned by the registry is 429. This can happen on the DockerHub registry because of the rate-limited anonymous pulls . To solve this you must first be authenticated against the registry through the regopts settings : regopts : - name : \"docker.io\" selector : image username : foo password : bar If this is not enough, tweak the schedule setting with something like 0 */6 * * * (every 6 hours).","title":"Too many requests to registry"},{"location":"faq/#docker-hub-rate-limits","text":"Docker is now enforcing Docker Hub pull rate limits . This means you can make 100 pull image requests per six hours for anonymous usage, and 200 pull image requests per six hours for free Docker accounts. But this rate limit is not necessarily an indicator on the number of times an image has actually been downloaded. In fact, their pulls counter/metric is actually a representation of the number of times a manifest for a particular image has been retrieved. As you probably know, Diun downloads the manifest of an image from its registry through a GET request to be able to retrieve its inside metadata. Fortunately Diun doesn't perform a GET request at each scan but only when an image has been updated or added on the registry. This allows us not to exceed this rate limit in our situation, but it also strongly depends on the number of images you scan . To increase your pull rate limits you can upgrade your account to a Docker Pro or Team subscription and authenticate against the registry through the regopts settings : regopts : - name : \"docker.io\" selector : image username : foo password : bar Or you can tweak the schedule setting with something like 0 */6 * * * (every 6 hours). Warning Also be careful with the watch_repo setting as it will fetch manifest for ALL tags available for the image.","title":"Docker Hub rate limits"},{"location":"faq/#profiling","text":"Diun provides a simple way to manage runtime/pprof profiling through the --profiler-path and --profiler flags with serve command : version : \"3.5\" services : diun : image : crazymax/diun:latest container_name : diun command : serve volumes : - \"./data:/data\" - \"./profiler:/profiler\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"PROFILER_PATH=/profiler\" - \"PROFILER=mem\" - \"DIUN_PROVIDERS_DOCKER=true\" restart : always Following profilers are available: cpu enables cpu profiling mem enables memory profiling alloc enables memory profiling and changes which type of memory to profile allocations heap enables memory profiling and changes which type of memory profiling to profile the heap routines enables goroutine profiling mutex enables mutex profiling threads enables thread creation profiling block enables block (contention) profiling","title":"Profiling"},{"location":"reporting-issue/","text":"Reporting an issue \u00b6 Before submitting an issue \u00b6 First, be a good guy . Please do a search in open issues to see if the issue or feature request has already been filed and read the FAQ page first. If you find your issue already exists, make relevant comments and add your reaction . Use a reaction in place of a \"+1\" comment. - upvote - downvote If you cannot find an existing issue that describes your bug or feature, submit an issue using the guidelines below. Writing good bug reports and feature requests \u00b6 File a single issue per problem and feature request. Do not enumerate multiple bugs or feature requests in the same issue. Do not add your issue as a comment to an existing issue unless it's for the identical input. Many issues look similar, but have different causes. The more information you can provide, the more likely someone will be successful reproducing the issue and finding a fix. You are now ready to create a new issue ! Closure policy \u00b6 Issues that don't have the information requested above (when applicable) will be closed immediately and the poster directed to the support guidelines. Issues that go a week without a response from original poster are subject to closure at our discretion.","title":"Reporting an issue"},{"location":"reporting-issue/#reporting-an-issue","text":"","title":"Reporting an issue"},{"location":"reporting-issue/#before-submitting-an-issue","text":"First, be a good guy . Please do a search in open issues to see if the issue or feature request has already been filed and read the FAQ page first. If you find your issue already exists, make relevant comments and add your reaction . Use a reaction in place of a \"+1\" comment. - upvote - downvote If you cannot find an existing issue that describes your bug or feature, submit an issue using the guidelines below.","title":"Before submitting an issue"},{"location":"reporting-issue/#writing-good-bug-reports-and-feature-requests","text":"File a single issue per problem and feature request. Do not enumerate multiple bugs or feature requests in the same issue. Do not add your issue as a comment to an existing issue unless it's for the identical input. Many issues look similar, but have different causes. The more information you can provide, the more likely someone will be successful reproducing the issue and finding a fix. You are now ready to create a new issue !","title":"Writing good bug reports and feature requests"},{"location":"reporting-issue/#closure-policy","text":"Issues that don't have the information requested above (when applicable) will be closed immediately and the poster directed to the support guidelines. Issues that go a week without a response from original poster are subject to closure at our discretion.","title":"Closure policy"},{"location":"config/","text":"Configuration \u00b6 Overview \u00b6 There are two different ways to define configuration in Diun: In a configuration file As environment variables These ways are evaluated in the order listed above. If no value was provided for a given option, a default value applies. Moreover, if an option has sub-options, and any of these sub-options is not specified, a default value will apply as well. For example, the DIUN_PROVIDERS_DOCKER environment variable is enough by itself to enable the docker provider, even though sub-options like DIUN_PROVIDERS_DOCKER_ENDPOINT exist. Once positioned, this option sets (and resets) all the default values of the sub-options of DIUN_PROVIDERS_DOCKER . Configuration file \u00b6 At startup, Diun searches for a file named diun.yml (or diun.yaml ) in: /etc/diun/ $XDG_CONFIG_HOME/ $HOME/.config/ . (the working directory) You can override this using the --config flag or CONFIG env var with serve command . diun.yml db : path : diun.db watch : workers : 10 schedule : \"0 */6 * * *\" firstCheckNotif : false notif : amqp : host : localhost port : 5672 username : guest password : guest queue : queue gotify : endpoint : http://gotify.foo.com token : Token123456 priority : 1 timeout : 10s mail : host : localhost port : 25 ssl : false insecureSkipVerify : false from : diun@example.com to : - webmaster@example.com - me@example.com rocketchat : endpoint : http://rocket.foo.com:3000 channel : \"#general\" userID : abcdEFGH012345678 token : Token123456 timeout : 10s script : cmd : \"myprogram\" args : - \"--anarg\" - \"another\" slack : webhookURL : https://hooks.slack.com/services/ABCD12EFG/HIJK34LMN/01234567890abcdefghij teams : webhookURL : https://outlook.office.com/webhook/ABCD12EFG/HIJK34LMN/01234567890abcdefghij telegram : token : aabbccdd:11223344 chatIDs : - 123456789 - 987654321 webhook : endpoint : http://webhook.foo.com/sd54qad89azd5a method : GET headers : content-type : application/json authorization : Token123456 timeout : 10s regopts : - name : \"myregistry\" username : foo password : bar timeout : 20s insecureTLS : true - name : \"docker.io\" selector : image username : foo2 password : bar2 providers : docker : watchStopped : true swarm : watchByDefault : true kubernetes : namespaces : - default - production file : directory : ./imagesdir Environment variables \u00b6 All configuration from file can be transposed into environment variables. As an example, the following configuration: diun.yml db : path : diun.db watch : workers : 10 schedule : \"0 */6 * * *\" firstCheckNotif : false notif : gotify : endpoint : http://gotify.foo.com token : Token123456 priority : 1 timeout : 10s telegram : token : aabbccdd:11223344 chatIDs : - 123456789 - 987654321 webhook : endpoint : http://webhook.foo.com/sd54qad89azd5a method : GET headers : content-type : application/json authorization : Token123456 timeout : 10s regopts : - name : \"docker.io\" selector : image username : foo password : bar - name : \"registry.gitlab.com\" selector : image username : fii password : bor timeout : 20s providers : kubernetes : tlsInsecure : false namespaces : - default - production Can be transposed to: environment variables DIUN_DB_PATH=diun.db DIUN_WATCH_WORKERS=10 DIUN_WATCH_SCHEDULE=0 */6 * * * DIUN_WATCH_FIRSTCHECKNOTIF=false DIUN_NOTIF_GOTIFY_ENDPOINT=http://gotify.foo.com DIUN_NOTIF_GOTIFY_TOKEN=Token123456 DIUN_NOTIF_GOTIFY_PRIORITY=1 DIUN_NOTIF_GOTIFY_TIMEOUT=10s DIUN_NOTIF_TELEGRAM_TOKEN=aabbccdd:11223344 DIUN_NOTIF_TELEGRAM_CHATIDS=123456789,987654321 DIUN_NOTIF_WEBHOOK_ENDPOINT=http://webhook.foo.com/sd54qad89azd5a DIUN_NOTIF_WEBHOOK_METHOD=GET DIUN_NOTIF_WEBHOOK_HEADERS_CONTENT-TYPE=application/json DIUN_NOTIF_WEBHOOK_HEADERS_AUTHORIZATION=Token123456 DIUN_NOTIF_WEBHOOK_TIMEOUT=10s DIUN_REGOPTS_0_NAME=docker.io DIUN_REGOPTS_0_SELECTOR=image DIUN_REGOPTS_0_USERNAME=foo DIUN_REGOPTS_0_PASSWORD=bar DIUN_REGOPTS_1_NAME=registry.gitlab.com DIUN_REGOPTS_1_SELECTOR=image DIUN_REGOPTS_1_USERNAME=fii DIUN_REGOPTS_1_PASSWORD=bor DIUN_REGOPTS_1_TIMEOUT=20s PROVIDERS_KUBERNETES_TLSINSECURE=false PROVIDERS_KUBERNETES_NAMESPACES=default,production Reference \u00b6 db watch notif amqp discord gotify mail matrix mqtt pushover rocketchat script slack teams telegram webhook regopts providers docker kubernetes swarm dockerfile file","title":"Overview"},{"location":"config/#configuration","text":"","title":"Configuration"},{"location":"config/#overview","text":"There are two different ways to define configuration in Diun: In a configuration file As environment variables These ways are evaluated in the order listed above. If no value was provided for a given option, a default value applies. Moreover, if an option has sub-options, and any of these sub-options is not specified, a default value will apply as well. For example, the DIUN_PROVIDERS_DOCKER environment variable is enough by itself to enable the docker provider, even though sub-options like DIUN_PROVIDERS_DOCKER_ENDPOINT exist. Once positioned, this option sets (and resets) all the default values of the sub-options of DIUN_PROVIDERS_DOCKER .","title":"Overview"},{"location":"config/#configuration-file","text":"At startup, Diun searches for a file named diun.yml (or diun.yaml ) in: /etc/diun/ $XDG_CONFIG_HOME/ $HOME/.config/ . (the working directory) You can override this using the --config flag or CONFIG env var with serve command . diun.yml db : path : diun.db watch : workers : 10 schedule : \"0 */6 * * *\" firstCheckNotif : false notif : amqp : host : localhost port : 5672 username : guest password : guest queue : queue gotify : endpoint : http://gotify.foo.com token : Token123456 priority : 1 timeout : 10s mail : host : localhost port : 25 ssl : false insecureSkipVerify : false from : diun@example.com to : - webmaster@example.com - me@example.com rocketchat : endpoint : http://rocket.foo.com:3000 channel : \"#general\" userID : abcdEFGH012345678 token : Token123456 timeout : 10s script : cmd : \"myprogram\" args : - \"--anarg\" - \"another\" slack : webhookURL : https://hooks.slack.com/services/ABCD12EFG/HIJK34LMN/01234567890abcdefghij teams : webhookURL : https://outlook.office.com/webhook/ABCD12EFG/HIJK34LMN/01234567890abcdefghij telegram : token : aabbccdd:11223344 chatIDs : - 123456789 - 987654321 webhook : endpoint : http://webhook.foo.com/sd54qad89azd5a method : GET headers : content-type : application/json authorization : Token123456 timeout : 10s regopts : - name : \"myregistry\" username : foo password : bar timeout : 20s insecureTLS : true - name : \"docker.io\" selector : image username : foo2 password : bar2 providers : docker : watchStopped : true swarm : watchByDefault : true kubernetes : namespaces : - default - production file : directory : ./imagesdir","title":"Configuration file"},{"location":"config/#environment-variables","text":"All configuration from file can be transposed into environment variables. As an example, the following configuration: diun.yml db : path : diun.db watch : workers : 10 schedule : \"0 */6 * * *\" firstCheckNotif : false notif : gotify : endpoint : http://gotify.foo.com token : Token123456 priority : 1 timeout : 10s telegram : token : aabbccdd:11223344 chatIDs : - 123456789 - 987654321 webhook : endpoint : http://webhook.foo.com/sd54qad89azd5a method : GET headers : content-type : application/json authorization : Token123456 timeout : 10s regopts : - name : \"docker.io\" selector : image username : foo password : bar - name : \"registry.gitlab.com\" selector : image username : fii password : bor timeout : 20s providers : kubernetes : tlsInsecure : false namespaces : - default - production Can be transposed to: environment variables DIUN_DB_PATH=diun.db DIUN_WATCH_WORKERS=10 DIUN_WATCH_SCHEDULE=0 */6 * * * DIUN_WATCH_FIRSTCHECKNOTIF=false DIUN_NOTIF_GOTIFY_ENDPOINT=http://gotify.foo.com DIUN_NOTIF_GOTIFY_TOKEN=Token123456 DIUN_NOTIF_GOTIFY_PRIORITY=1 DIUN_NOTIF_GOTIFY_TIMEOUT=10s DIUN_NOTIF_TELEGRAM_TOKEN=aabbccdd:11223344 DIUN_NOTIF_TELEGRAM_CHATIDS=123456789,987654321 DIUN_NOTIF_WEBHOOK_ENDPOINT=http://webhook.foo.com/sd54qad89azd5a DIUN_NOTIF_WEBHOOK_METHOD=GET DIUN_NOTIF_WEBHOOK_HEADERS_CONTENT-TYPE=application/json DIUN_NOTIF_WEBHOOK_HEADERS_AUTHORIZATION=Token123456 DIUN_NOTIF_WEBHOOK_TIMEOUT=10s DIUN_REGOPTS_0_NAME=docker.io DIUN_REGOPTS_0_SELECTOR=image DIUN_REGOPTS_0_USERNAME=foo DIUN_REGOPTS_0_PASSWORD=bar DIUN_REGOPTS_1_NAME=registry.gitlab.com DIUN_REGOPTS_1_SELECTOR=image DIUN_REGOPTS_1_USERNAME=fii DIUN_REGOPTS_1_PASSWORD=bor DIUN_REGOPTS_1_TIMEOUT=20s PROVIDERS_KUBERNETES_TLSINSECURE=false PROVIDERS_KUBERNETES_NAMESPACES=default,production","title":"Environment variables"},{"location":"config/#reference","text":"db watch notif amqp discord gotify mail matrix mqtt pushover rocketchat script slack teams telegram webhook regopts providers docker kubernetes swarm dockerfile file","title":"Reference"},{"location":"config/db/","text":"Database configuration \u00b6 path \u00b6 Path to Bolt database file where images manifests are stored. (default diun.db ) Config file db : path : diun.db Environment variables DIUN_DB_PATH","title":".db"},{"location":"config/db/#database-configuration","text":"","title":"Database configuration"},{"location":"config/db/#path","text":"Path to Bolt database file where images manifests are stored. (default diun.db ) Config file db : path : diun.db Environment variables DIUN_DB_PATH","title":"path"},{"location":"config/notif/","text":"Notifications configuration \u00b6 amqp discord gotify mail matrix mqtt pushover rocketchat script slack teams telegram webhook","title":".notif"},{"location":"config/notif/#notifications-configuration","text":"amqp discord gotify mail matrix mqtt pushover rocketchat script slack teams telegram webhook","title":"Notifications configuration"},{"location":"config/providers/","text":"Providers configuration \u00b6 docker kubernetes swarm dockerfile file","title":".providers"},{"location":"config/providers/#providers-configuration","text":"docker kubernetes swarm dockerfile file","title":"Providers configuration"},{"location":"config/regopts/","text":"Registry options configuration \u00b6 Overview \u00b6 Registry options is used to authenticate against a registry during the analysis of an image: regopts : - name : \"myregistry\" username : fii password : bor timeout : 30s - name : \"docker.io\" selector : image username : foo password : bar - name : \"docker.io/crazymax\" selector : image usernameFile : /run/secrets/username passwordFile : /run/secrets/password myregistry will be used as a name selector (default) if referenced by its name . docker.io will be used as an image selector. If an image is on DockerHub ( docker.io domain), this registry options will be selected if not referenced as a regopt name. docker.io/crazymax will be used as an image selector. If an image is on DockerHub and in crazymax namespace, this registry options will be selected if not referenced as a regopt name. Configuration \u00b6 name \u00b6 Unique name for registry options. This name can be used through diun.regopt Docker / Swarm label or Kubernetes annotation and also as regopt for the Dockerfile and File providers. Warning Required Must be unique Config file regopts : - name : \"myregistry\" Environment variables DIUN_REGOPTS_<KEY>_NAME selector \u00b6 What kind of selector to use to retrieve registry options. (default name ) Warning Accepted values are name or image name selector is the default value and will retrieve this registry options only if it's referenced by its name . image selector will retrieve this registry options if the given image matches the registry domain or repository path. Config file regopts : - name : \"myregistry\" selector : name Environment variables DIUN_REGOPTS_<KEY>_SELECTOR username \u00b6 Registry username. Config file regopts : - name : \"myregistry\" username : foo Environment variables DIUN_REGOPTS_<KEY>_USERNAME usernameFile \u00b6 Use content of secret file as registry username if username not defined. Config file regopts : - name : \"myregistry\" usernameFile : /run/secrets/username Environment variables DIUN_REGOPTS_<KEY>_USERNAMEFILE password \u00b6 Registry password. Config file regopts : - name : \"myregistry\" username : foo password : bar Environment variables DIUN_REGOPTS_<KEY>_PASSWORD passwordFile \u00b6 Use content of secret file as registry password if password not defined. Config file regopts : - name : \"myregistry\" passwordFile : /run/secrets/password Environment variables DIUN_REGOPTS_<KEY>_PASSWORDFILE timeout \u00b6 Timeout is the maximum amount of time for the TCP connection to establish. (default 0 ; no timeout) Config file regopts : - name : \"myregistry\" timeout : 30s Environment variables DIUN_REGOPTS_<KEY>_TIMEOUT insecureTLS \u00b6 Allow contacting docker registry over HTTP, or HTTPS with failed TLS verification. (default false ) Config file regopts : - name : \"myregistry\" insecureTLS : false Environment variables DIUN_REGOPTS_<KEY>_INSECURETLS","title":".regopts"},{"location":"config/regopts/#registry-options-configuration","text":"","title":"Registry options configuration"},{"location":"config/regopts/#overview","text":"Registry options is used to authenticate against a registry during the analysis of an image: regopts : - name : \"myregistry\" username : fii password : bor timeout : 30s - name : \"docker.io\" selector : image username : foo password : bar - name : \"docker.io/crazymax\" selector : image usernameFile : /run/secrets/username passwordFile : /run/secrets/password myregistry will be used as a name selector (default) if referenced by its name . docker.io will be used as an image selector. If an image is on DockerHub ( docker.io domain), this registry options will be selected if not referenced as a regopt name. docker.io/crazymax will be used as an image selector. If an image is on DockerHub and in crazymax namespace, this registry options will be selected if not referenced as a regopt name.","title":"Overview"},{"location":"config/regopts/#configuration","text":"","title":"Configuration"},{"location":"config/regopts/#name","text":"Unique name for registry options. This name can be used through diun.regopt Docker / Swarm label or Kubernetes annotation and also as regopt for the Dockerfile and File providers. Warning Required Must be unique Config file regopts : - name : \"myregistry\" Environment variables DIUN_REGOPTS_<KEY>_NAME","title":"name"},{"location":"config/regopts/#selector","text":"What kind of selector to use to retrieve registry options. (default name ) Warning Accepted values are name or image name selector is the default value and will retrieve this registry options only if it's referenced by its name . image selector will retrieve this registry options if the given image matches the registry domain or repository path. Config file regopts : - name : \"myregistry\" selector : name Environment variables DIUN_REGOPTS_<KEY>_SELECTOR","title":"selector"},{"location":"config/regopts/#username","text":"Registry username. Config file regopts : - name : \"myregistry\" username : foo Environment variables DIUN_REGOPTS_<KEY>_USERNAME","title":"username"},{"location":"config/regopts/#usernamefile","text":"Use content of secret file as registry username if username not defined. Config file regopts : - name : \"myregistry\" usernameFile : /run/secrets/username Environment variables DIUN_REGOPTS_<KEY>_USERNAMEFILE","title":"usernameFile"},{"location":"config/regopts/#password","text":"Registry password. Config file regopts : - name : \"myregistry\" username : foo password : bar Environment variables DIUN_REGOPTS_<KEY>_PASSWORD","title":"password"},{"location":"config/regopts/#passwordfile","text":"Use content of secret file as registry password if password not defined. Config file regopts : - name : \"myregistry\" passwordFile : /run/secrets/password Environment variables DIUN_REGOPTS_<KEY>_PASSWORDFILE","title":"passwordFile"},{"location":"config/regopts/#timeout","text":"Timeout is the maximum amount of time for the TCP connection to establish. (default 0 ; no timeout) Config file regopts : - name : \"myregistry\" timeout : 30s Environment variables DIUN_REGOPTS_<KEY>_TIMEOUT","title":"timeout"},{"location":"config/regopts/#insecuretls","text":"Allow contacting docker registry over HTTP, or HTTPS with failed TLS verification. (default false ) Config file regopts : - name : \"myregistry\" insecureTLS : false Environment variables DIUN_REGOPTS_<KEY>_INSECURETLS","title":"insecureTLS"},{"location":"config/watch/","text":"Watch configuration \u00b6 Overview \u00b6 watch : workers : 10 schedule : \"0 */6 * * *\" firstCheckNotif : false compareDigest : true healthchecks : baseURL : https://hc-ping.com/ uuid : 5bf66975-d4c7-4bf5-bcc8-b8d8a82ea278 Configuration \u00b6 workers \u00b6 Maximum number of workers that will execute tasks concurrently. (default 10 ) Config file watch : workers : 10 Environment variables DIUN_WATCH_WORKERS schedule \u00b6 CRON expression to schedule Diun. Warning Remove this setting if you want to run Diun directly. Config file watch : schedule : \"0 */6 * * *\" Environment variables DIUN_WATCH_SCHEDULE firstCheckNotif \u00b6 Send notification at the very first analysis of an image. (default false ) Config file watch : firstCheckNotif : false Environment variables DIUN_WATCH_FIRSTCHECKNOTIF compareDigest \u00b6 Compare the digest of an image with the registry before downloading the image manifest. It is strongly recommended leaving this value at true , especially with Docker Hub which imposes a rate-limit on image pull. (default true ) Config file watch : compareDigest : true Environment variables DIUN_WATCH_COMPAREDIGEST healthchecks \u00b6 Healthchecks allows monitoring Diun watcher by sending start and success notification events to healthchecks.io . Tip A Docker image for Healthchecks is available if you want to self-host your instance. Config file watch : healthchecks : baseURL : https://hc-ping.com/ uuid : 5bf66975-d4c7-4bf5-bcc8-b8d8a82ea278 Environment variables DIUN_WATCH_HEALTHCHECKS_BASEURL DIUN_WATCH_HEALTHCHECKS_UUID baseURL : Base URL for the Healthchecks Ping API (default https://hc-ping.com/ ). uuid : UUID of an existing healthcheck (required).","title":".watch"},{"location":"config/watch/#watch-configuration","text":"","title":"Watch configuration"},{"location":"config/watch/#overview","text":"watch : workers : 10 schedule : \"0 */6 * * *\" firstCheckNotif : false compareDigest : true healthchecks : baseURL : https://hc-ping.com/ uuid : 5bf66975-d4c7-4bf5-bcc8-b8d8a82ea278","title":"Overview"},{"location":"config/watch/#configuration","text":"","title":"Configuration"},{"location":"config/watch/#workers","text":"Maximum number of workers that will execute tasks concurrently. (default 10 ) Config file watch : workers : 10 Environment variables DIUN_WATCH_WORKERS","title":"workers"},{"location":"config/watch/#schedule","text":"CRON expression to schedule Diun. Warning Remove this setting if you want to run Diun directly. Config file watch : schedule : \"0 */6 * * *\" Environment variables DIUN_WATCH_SCHEDULE","title":"schedule"},{"location":"config/watch/#firstchecknotif","text":"Send notification at the very first analysis of an image. (default false ) Config file watch : firstCheckNotif : false Environment variables DIUN_WATCH_FIRSTCHECKNOTIF","title":"firstCheckNotif"},{"location":"config/watch/#comparedigest","text":"Compare the digest of an image with the registry before downloading the image manifest. It is strongly recommended leaving this value at true , especially with Docker Hub which imposes a rate-limit on image pull. (default true ) Config file watch : compareDigest : true Environment variables DIUN_WATCH_COMPAREDIGEST","title":"compareDigest"},{"location":"config/watch/#healthchecks","text":"Healthchecks allows monitoring Diun watcher by sending start and success notification events to healthchecks.io . Tip A Docker image for Healthchecks is available if you want to self-host your instance. Config file watch : healthchecks : baseURL : https://hc-ping.com/ uuid : 5bf66975-d4c7-4bf5-bcc8-b8d8a82ea278 Environment variables DIUN_WATCH_HEALTHCHECKS_BASEURL DIUN_WATCH_HEALTHCHECKS_UUID baseURL : Base URL for the Healthchecks Ping API (default https://hc-ping.com/ ). uuid : UUID of an existing healthcheck (required).","title":"healthchecks"},{"location":"install/binary/","text":"Installation from binary \u00b6 Download \u00b6 Diun binaries are available on releases page. Choose the archive matching the destination platform: diun_4.21.0_darwin_amd64.tar.gz diun_4.21.0_darwin_arm64.tar.gz diun_4.21.0_linux_386.tar.gz diun_4.21.0_linux_amd64.tar.gz diun_4.21.0_linux_arm64.tar.gz diun_4.21.0_linux_armv5.tar.gz diun_4.21.0_linux_armv6.tar.gz diun_4.21.0_linux_armv7.tar.gz diun_4.21.0_linux_ppc64le.tar.gz diun_4.21.0_linux_riscv64.tar.gz diun_4.21.0_linux_s390x.tar.gz diun_4.21.0_windows_386.zip diun_4.21.0_windows_amd64.zip diun_4.21.0_windows_arm64.zip And extract diun: wget -qO- https://github.com/crazy-max/diun/releases/download/v4.21.0/diun_4.21.0_linux_amd64.tar.gz | tar -zxvf - diun After getting the binary, it can be tested with ./diun --help command and moved to a permanent location. Server configuration \u00b6 Steps below are the recommended server configuration. Prepare environment \u00b6 Create user to run diun (ex. diun ) groupadd diun useradd -s /bin/false -d /bin/null -g diun diun Create required directory structure \u00b6 mkdir -p /var/lib/diun chown diun:diun /var/lib/diun/ chmod -R 750 /var/lib/diun/ mkdir /etc/diun chown diun:diun /etc/diun chmod 770 /etc/diun Configuration \u00b6 Create your first configuration file in /etc/diun/diun.yml and type: chown diun:diun /etc/diun/diun.yml chmod 644 /etc/diun/diun.yml Note Not required if you want to only rely on environment variables Copy binary to global location \u00b6 cp diun /usr/local/bin/diun Running Diun \u00b6 After the above steps, two options to run Diun: 1. Creating a service file (recommended) \u00b6 See how to create Linux service to start Diun automatically. 2. Running from terminal \u00b6 DIUN_DB_PATH = /var/lib/diun/diun.db /usr/local/bin/diun serve --config /etc/diun/diun.yml Updating to a new version \u00b6 You can update to a new version of Diun by stopping it, replacing the binary at /usr/local/bin/diun and restarting the instance. If you have carried out the installation steps as described above, the binary should have the generic name diun . Do not change this, i.e. to include the version number.","title":"From binary"},{"location":"install/binary/#installation-from-binary","text":"","title":"Installation from binary"},{"location":"install/binary/#download","text":"Diun binaries are available on releases page. Choose the archive matching the destination platform: diun_4.21.0_darwin_amd64.tar.gz diun_4.21.0_darwin_arm64.tar.gz diun_4.21.0_linux_386.tar.gz diun_4.21.0_linux_amd64.tar.gz diun_4.21.0_linux_arm64.tar.gz diun_4.21.0_linux_armv5.tar.gz diun_4.21.0_linux_armv6.tar.gz diun_4.21.0_linux_armv7.tar.gz diun_4.21.0_linux_ppc64le.tar.gz diun_4.21.0_linux_riscv64.tar.gz diun_4.21.0_linux_s390x.tar.gz diun_4.21.0_windows_386.zip diun_4.21.0_windows_amd64.zip diun_4.21.0_windows_arm64.zip And extract diun: wget -qO- https://github.com/crazy-max/diun/releases/download/v4.21.0/diun_4.21.0_linux_amd64.tar.gz | tar -zxvf - diun After getting the binary, it can be tested with ./diun --help command and moved to a permanent location.","title":"Download"},{"location":"install/binary/#server-configuration","text":"Steps below are the recommended server configuration.","title":"Server configuration"},{"location":"install/binary/#prepare-environment","text":"Create user to run diun (ex. diun ) groupadd diun useradd -s /bin/false -d /bin/null -g diun diun","title":"Prepare environment"},{"location":"install/binary/#create-required-directory-structure","text":"mkdir -p /var/lib/diun chown diun:diun /var/lib/diun/ chmod -R 750 /var/lib/diun/ mkdir /etc/diun chown diun:diun /etc/diun chmod 770 /etc/diun","title":"Create required directory structure"},{"location":"install/binary/#configuration","text":"Create your first configuration file in /etc/diun/diun.yml and type: chown diun:diun /etc/diun/diun.yml chmod 644 /etc/diun/diun.yml Note Not required if you want to only rely on environment variables","title":"Configuration"},{"location":"install/binary/#copy-binary-to-global-location","text":"cp diun /usr/local/bin/diun","title":"Copy binary to global location"},{"location":"install/binary/#running-diun","text":"After the above steps, two options to run Diun:","title":"Running Diun"},{"location":"install/binary/#1-creating-a-service-file-recommended","text":"See how to create Linux service to start Diun automatically.","title":"1. Creating a service file (recommended)"},{"location":"install/binary/#2-running-from-terminal","text":"DIUN_DB_PATH = /var/lib/diun/diun.db /usr/local/bin/diun serve --config /etc/diun/diun.yml","title":"2. Running from terminal"},{"location":"install/binary/#updating-to-a-new-version","text":"You can update to a new version of Diun by stopping it, replacing the binary at /usr/local/bin/diun and restarting the instance. If you have carried out the installation steps as described above, the binary should have the generic name diun . Do not change this, i.e. to include the version number.","title":"Updating to a new version"},{"location":"install/docker/","text":"Installation from Docker image \u00b6 About \u00b6 Diun provides automatically updated Docker images within several registries: Registry Image Docker Hub crazymax/diun GitHub Container Registry ghcr.io/crazy-max/diun It is possible to always use the latest stable tag or to use another service that handles updating Docker images. Following platforms for this image are available: $ docker run --rm mplatform/mquery crazymax/diun:latest Image: crazymax/diun:latest * Manifest List: Yes * Supported platforms: - linux/amd64 - linux/arm/v6 - linux/arm/v7 - linux/arm64 - linux/386 - linux/ppc64le Volumes \u00b6 Path Description /data Contains bbolt database which retains Docker images manifests Usage \u00b6 Note This reference setup guides users through the setup based on docker-compose and the Docker provider , but the installation of docker-compose is out of scope of this documentation. To install docker-compose itself, follow the official install instructions . You can also use the Swarm or Kubernetes providers if you don't want to use docker-compose . version : \"3.5\" services : diun : image : crazymax/diun:latest container_name : diun command : serve volumes : - \"./data:/data\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"LOG_JSON=false\" - \"DIUN_WATCH_WORKERS=20\" - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\" - \"DIUN_PROVIDERS_DOCKER=true\" labels : - \"diun.enable=true\" restart : always Edit this example with your preferences and run the following commands to bring up Diun: docker-compose up -d docker-compose logs -f Or use the following command: docker run -d --name diun \\ -e \"TZ=Europe/Paris\" \\ -e \"LOG_LEVEL=info\" \\ -e \"LOG_JSON=false\" \\ -e \"DIUN_WATCH_WORKERS=20\" \\ -e \"DIUN_WATCH_SCHEDULE=0 */6 * * *\" \\ -e \"DIUN_PROVIDERS_DOCKER=true\" \\ -v \" $( pwd ) /data:/data\" \\ -v \"/var/run/docker.sock:/var/run/docker.sock\" \\ -l \"diun.enable=true\" \\ crazymax/diun:latest To upgrade your installation to the latest release: docker-compose pull docker-compose up -d If you prefer to rely on the configuration file instead of environment variables: version : \"3.5\" services : diun : image : crazymax/diun:latest container_name : diun command : serve volumes : - \"./data:/data\" - \"./diun.yml:/diun.yml:ro\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"LOG_JSON=false\" restart : always # ./diun.yml watch : workers : 20 schedule : \"0 */6 * * *\" providers : docker : watchStopped : true Podman \u00b6 If you're using Podman there are some small changes: version : \"3.5\" services : diun_app : image : docker.io/crazymax/diun:latest container_name : diun volumes : - \"./data:/data\" # root mode - \"/run/podman/podman.sock:/var/run/docker.sock\" # rootless mode #- \"$XDG_RUNTIME_DIR/podman/podman.sock:/var/run/docker.sock\" #- \"/run/user/1000/podman/podman.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"LOG_JSON=false\" - \"DIUN_WATCH_WORKERS=20\" - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\" - \"DIUN_PROVIDERS_DOCKER=true\" labels : - \"diun.enable=true\" restart : always Edit this example with your preferences and run the following commands to bring up Diun with podman-compose : podman-compose up -d podman-compose logs -f","title":"From Docker image"},{"location":"install/docker/#installation-from-docker-image","text":"","title":"Installation from Docker image"},{"location":"install/docker/#about","text":"Diun provides automatically updated Docker images within several registries: Registry Image Docker Hub crazymax/diun GitHub Container Registry ghcr.io/crazy-max/diun It is possible to always use the latest stable tag or to use another service that handles updating Docker images. Following platforms for this image are available: $ docker run --rm mplatform/mquery crazymax/diun:latest Image: crazymax/diun:latest * Manifest List: Yes * Supported platforms: - linux/amd64 - linux/arm/v6 - linux/arm/v7 - linux/arm64 - linux/386 - linux/ppc64le","title":"About"},{"location":"install/docker/#volumes","text":"Path Description /data Contains bbolt database which retains Docker images manifests","title":"Volumes"},{"location":"install/docker/#usage","text":"Note This reference setup guides users through the setup based on docker-compose and the Docker provider , but the installation of docker-compose is out of scope of this documentation. To install docker-compose itself, follow the official install instructions . You can also use the Swarm or Kubernetes providers if you don't want to use docker-compose . version : \"3.5\" services : diun : image : crazymax/diun:latest container_name : diun command : serve volumes : - \"./data:/data\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"LOG_JSON=false\" - \"DIUN_WATCH_WORKERS=20\" - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\" - \"DIUN_PROVIDERS_DOCKER=true\" labels : - \"diun.enable=true\" restart : always Edit this example with your preferences and run the following commands to bring up Diun: docker-compose up -d docker-compose logs -f Or use the following command: docker run -d --name diun \\ -e \"TZ=Europe/Paris\" \\ -e \"LOG_LEVEL=info\" \\ -e \"LOG_JSON=false\" \\ -e \"DIUN_WATCH_WORKERS=20\" \\ -e \"DIUN_WATCH_SCHEDULE=0 */6 * * *\" \\ -e \"DIUN_PROVIDERS_DOCKER=true\" \\ -v \" $( pwd ) /data:/data\" \\ -v \"/var/run/docker.sock:/var/run/docker.sock\" \\ -l \"diun.enable=true\" \\ crazymax/diun:latest To upgrade your installation to the latest release: docker-compose pull docker-compose up -d If you prefer to rely on the configuration file instead of environment variables: version : \"3.5\" services : diun : image : crazymax/diun:latest container_name : diun command : serve volumes : - \"./data:/data\" - \"./diun.yml:/diun.yml:ro\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"LOG_JSON=false\" restart : always # ./diun.yml watch : workers : 20 schedule : \"0 */6 * * *\" providers : docker : watchStopped : true","title":"Usage"},{"location":"install/docker/#podman","text":"If you're using Podman there are some small changes: version : \"3.5\" services : diun_app : image : docker.io/crazymax/diun:latest container_name : diun volumes : - \"./data:/data\" # root mode - \"/run/podman/podman.sock:/var/run/docker.sock\" # rootless mode #- \"$XDG_RUNTIME_DIR/podman/podman.sock:/var/run/docker.sock\" #- \"/run/user/1000/podman/podman.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"LOG_JSON=false\" - \"DIUN_WATCH_WORKERS=20\" - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\" - \"DIUN_PROVIDERS_DOCKER=true\" labels : - \"diun.enable=true\" restart : always Edit this example with your preferences and run the following commands to bring up Diun with podman-compose : podman-compose up -d podman-compose logs -f","title":"Podman"},{"location":"install/linux-service/","text":"Run as service on Debian based distro \u00b6 Using systemd \u00b6 Warning Make sure to follow the instructions to install from binary before. To create a new service, paste this content in /etc/systemd/system/diun.service : [Unit] Description=Diun Documentation=https://crazymax.dev/diun/ After=syslog.target After=network.target [Service] RestartSec=2s Type=simple User=diun Group=diun ExecStart=/usr/local/bin/diun serve --config /etc/diun/diun.yml --log-level info Restart=always #Environment=TZ=Europe/Paris Environment=DIUN_DB_PATH=/var/lib/diun/diun.db [Install] WantedBy=multi-user.target Change the user, group, and other required startup values following your needs. Enable and start Diun at boot: sudo systemctl enable diun sudo systemctl start diun To view logs: journalctl -fu diun.service","title":"Linux service"},{"location":"install/linux-service/#run-as-service-on-debian-based-distro","text":"","title":"Run as service on Debian based distro"},{"location":"install/linux-service/#using-systemd","text":"Warning Make sure to follow the instructions to install from binary before. To create a new service, paste this content in /etc/systemd/system/diun.service : [Unit] Description=Diun Documentation=https://crazymax.dev/diun/ After=syslog.target After=network.target [Service] RestartSec=2s Type=simple User=diun Group=diun ExecStart=/usr/local/bin/diun serve --config /etc/diun/diun.yml --log-level info Restart=always #Environment=TZ=Europe/Paris Environment=DIUN_DB_PATH=/var/lib/diun/diun.db [Install] WantedBy=multi-user.target Change the user, group, and other required startup values following your needs. Enable and start Diun at boot: sudo systemctl enable diun sudo systemctl start diun To view logs: journalctl -fu diun.service","title":"Using systemd"},{"location":"migration/v0-to-v1/","text":"Diun v0 to v1 \u00b6 Some fields in configuration file has been changed: registries renamed regopts items renamed image items[].image renamed image[].name items[].registry_id renamed image[].regopts_id watch.os and watch.arch moved to image[].os and image[].arch v0 watch : os : linux arch : amd64 registries : someregistryoptions : username : foo password : bar timeout : 20 items : - image : docker.io/crazymax/nextcloud:latest registry_id : someregistryoptions v1 regopts : someregistryoptions : username : foo password : bar timeout : 20 image : - name : docker.io/crazymax/nextcloud:latest regopts_id : someregistryoptions os : linux arch : amd64","title":"Diun v0 to v1"},{"location":"migration/v0-to-v1/#diun-v0-to-v1","text":"Some fields in configuration file has been changed: registries renamed regopts items renamed image items[].image renamed image[].name items[].registry_id renamed image[].regopts_id watch.os and watch.arch moved to image[].os and image[].arch v0 watch : os : linux arch : amd64 registries : someregistryoptions : username : foo password : bar timeout : 20 items : - image : docker.io/crazymax/nextcloud:latest registry_id : someregistryoptions v1 regopts : someregistryoptions : username : foo password : bar timeout : 20 image : - name : docker.io/crazymax/nextcloud:latest regopts_id : someregistryoptions os : linux arch : amd64","title":"Diun v0 to v1"},{"location":"migration/v1-to-v2/","text":"Diun v1 to v2 \u00b6 image field has been moved to providers.static in configuration file: v1 image : - name : docker.io/crazymax/diun watch_repo : true max_tags : 10 v2 providers : static : - name : docker.io/crazymax/diun watch_repo : true max_tags : 10","title":"Diun v1 to v2"},{"location":"migration/v1-to-v2/#diun-v1-to-v2","text":"image field has been moved to providers.static in configuration file: v1 image : - name : docker.io/crazymax/diun watch_repo : true max_tags : 10 v2 providers : static : - name : docker.io/crazymax/diun watch_repo : true max_tags : 10","title":"Diun v1 to v2"},{"location":"migration/v2-to-v3/","text":"Diun v2 to v3 \u00b6 File provider \u00b6 static provider has been renamed file . This now allows the static configuration to be declared in one or more files to avoid overloading the current configuration file and also dynamic updating. v2 providers : static : - name : docker.io/crazymax/diun watch_repo : true max_tags : 10 v3 providers : file : # Watch images from filename /path/to/config.yml filename : /path/to/config.yml # OR watch images from directory /path/to/config/folder directory : /path/to/config/folder # /path/to/config.yml - name : docker.io/crazymax/diun watch_repo : true max_tags : 10 Allow only one Docker and Swarm provider \u00b6 Now you can declare only one Docker and/or Swarm provider. This is due to a limitation of the Docker engine. v2 providers : docker : mydocker : watch_stopped : true swarm : myswarm : watch_by_default : true v3 providers : docker : watch_stopped : true swarm : watch_by_default : true Remove enable setting for notifiers \u00b6 The enable entry has been removed for notifiers. If you don't want a notifier to be enabled, you must now remove or comment its configuration. v2 notif : amqp : enable : false host : localhost port : 5672 gotify : enable : true endpoint : http://gotify.foo.com token : Token123456 priority : 1 timeout : 10 v3 notif : gotify : endpoint : http://gotify.foo.com token : Token123456 priority : 1 timeout : 10","title":"Diun v2 to v3"},{"location":"migration/v2-to-v3/#diun-v2-to-v3","text":"","title":"Diun v2 to v3"},{"location":"migration/v2-to-v3/#file-provider","text":"static provider has been renamed file . This now allows the static configuration to be declared in one or more files to avoid overloading the current configuration file and also dynamic updating. v2 providers : static : - name : docker.io/crazymax/diun watch_repo : true max_tags : 10 v3 providers : file : # Watch images from filename /path/to/config.yml filename : /path/to/config.yml # OR watch images from directory /path/to/config/folder directory : /path/to/config/folder # /path/to/config.yml - name : docker.io/crazymax/diun watch_repo : true max_tags : 10","title":"File provider"},{"location":"migration/v2-to-v3/#allow-only-one-docker-and-swarm-provider","text":"Now you can declare only one Docker and/or Swarm provider. This is due to a limitation of the Docker engine. v2 providers : docker : mydocker : watch_stopped : true swarm : myswarm : watch_by_default : true v3 providers : docker : watch_stopped : true swarm : watch_by_default : true","title":"Allow only one Docker and Swarm provider"},{"location":"migration/v2-to-v3/#remove-enable-setting-for-notifiers","text":"The enable entry has been removed for notifiers. If you don't want a notifier to be enabled, you must now remove or comment its configuration. v2 notif : amqp : enable : false host : localhost port : 5672 gotify : enable : true endpoint : http://gotify.foo.com token : Token123456 priority : 1 timeout : 10 v3 notif : gotify : endpoint : http://gotify.foo.com token : Token123456 priority : 1 timeout : 10","title":"Remove enable setting for notifiers"},{"location":"migration/v3-to-v4/","text":"Diun v3 to v4 \u00b6 Timeout value as duration \u00b6 Only accept duration as timeout value ( 10 becomes 10s ) Registry options enhancements \u00b6 Configuration of registry options has changed: v3 regopts : myregistry : username : fii password : bor insecure_tls : true timeout : 5s docker.io : username : foo password : bar docker.io/crazymax : username_file : /run/secrets/username password_file : /run/secrets/password v4 regopts : - name : \"myregistry\" username : fii password : bor insecureTLS : true timeout : 5s - name : \"docker.io\" selector : image username : foo password : bar - name : \"docker.io/crazymax\" selector : image usernameFile : /run/secrets/username passwordFile : /run/secrets/password Also, registry options can now be resolved automatically based on image name. Take a look at the Registry options configuration for more details. Configuration transposed into environment variables \u00b6 All configuration is now transposed into environment variables. Take a look at the documentation for more details. DIUN_DB env var has been renamed DIUN_DB_PATH to follow environment variables transposition. All fields in configuration are now camelCased \u00b6 In order to enable transposition into environmental variables, all fields in configuration are now camelCased : notif.mail.insecure_skip_verify > notif.mail.insecureSkipVerify notif.rocketchat.user_id > notif.rocketchat.userID watch.first_check_notif > watch.firstCheckNotif ... v3 db : path : diun.db watch : workers : 10 schedule : \"0 */6 * * *\" first_check_notif : false notif : amqp : host : localhost port : 5672 username : guest password : guest exchange : queue : queue gotify : endpoint : http://gotify.foo.com token : Token123456 priority : 1 timeout : 10 mail : host : localhost port : 25 ssl : false insecure_skip_verify : false username : password : from : to : rocketchat : endpoint : http://rocket.foo.com:3000 channel : \"#general\" user_id : abcdEFGH012345678 token : Token123456 timeout : 10 script : cmd : \"myprogram\" args : - \"--anarg\" - \"another\" slack : webhook_url : https://hooks.slack.com/services/ABCD12EFG/HIJK34LMN/01234567890abcdefghij teams : webhook_url : https://outlook.office.com/webhook/ABCD12EFG/HIJK34LMN/01234567890abcdefghij telegram : token : aabbccdd:11223344 chat_ids : - 123456789 - 987654321 webhook : endpoint : http://webhook.foo.com/sd54qad89azd5a method : GET headers : Content-Type : application/json Authorization : Token123456 timeout : 10 regopts : myregistry : username : fii password : bor insecure_tls : true timeout : 5s docker.io : username : foo password : bar docker.io/crazymax : username_file : /run/secrets/username password_file : /run/secrets/password providers : docker : watch_stopped : true swarm : watch_by_default : true file : directory : ./imagesdir v4 db : path : diun.db watch : workers : 10 schedule : \"0 */6 * * *\" firstCheckNotif : false notif : amqp : host : localhost port : 5672 username : guest password : guest queue : queue gotify : endpoint : http://gotify.foo.com token : Token123456 priority : 1 timeout : 10s mail : host : localhost port : 25 ssl : false insecureSkipVerify : false from : diun@example.com to : webmaster@example.com rocketchat : endpoint : http://rocket.foo.com:3000 channel : \"#general\" userID : abcdEFGH012345678 token : Token123456 timeout : 10s script : cmd : \"myprogram\" args : - \"--anarg\" - \"another\" slack : webhookURL : https://hooks.slack.com/services/ABCD12EFG/HIJK34LMN/01234567890abcdefghij teams : webhookURL : https://outlook.office.com/webhook/ABCD12EFG/HIJK34LMN/01234567890abcdefghij telegram : token : aabbccdd:11223344 chatIDs : - 123456789 - 987654321 webhook : endpoint : http://webhook.foo.com/sd54qad89azd5a method : GET headers : content-type : application/json authorization : Token123456 timeout : 10s regopts : - name : \"myregistry\" username : fii password : bor insecureTLS : true timeout : 5s - name : \"docker.io\" selector : image username : foo password : bar - name : \"docker.io/crazymax\" selector : image usernameFile : /run/secrets/username passwordFile : /run/secrets/password providers : docker : watchStopped : true swarm : watchByDefault : true kubernetes : namespaces : - default - production file : directory : ./imagesdir /diun.yml not loaded by default in Docker image \u00b6 Following the transposition of the configuration into environment variables, the configuration file /diun.yml is no longer loaded by default in the official Docker image. If you want to load a configuration file through the Docker image you will have to declare the CONFIG environment variable with serve command pointing to the assigned configuration file: Tip This is no longer required since version 4.2.0. Now configuration file can be loaded from default places version : \"3.5\" services : diun : image : crazymax/diun:latest container_name : diun command : serve volumes : - \"./data:/data\" - \"./diun.yml:/diun.yml:ro\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"CONFIG=/diun.yml\" - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"LOG_JSON=false\" restart : always","title":"Diun v3 to v4"},{"location":"migration/v3-to-v4/#diun-v3-to-v4","text":"","title":"Diun v3 to v4"},{"location":"migration/v3-to-v4/#timeout-value-as-duration","text":"Only accept duration as timeout value ( 10 becomes 10s )","title":"Timeout value as duration"},{"location":"migration/v3-to-v4/#registry-options-enhancements","text":"Configuration of registry options has changed: v3 regopts : myregistry : username : fii password : bor insecure_tls : true timeout : 5s docker.io : username : foo password : bar docker.io/crazymax : username_file : /run/secrets/username password_file : /run/secrets/password v4 regopts : - name : \"myregistry\" username : fii password : bor insecureTLS : true timeout : 5s - name : \"docker.io\" selector : image username : foo password : bar - name : \"docker.io/crazymax\" selector : image usernameFile : /run/secrets/username passwordFile : /run/secrets/password Also, registry options can now be resolved automatically based on image name. Take a look at the Registry options configuration for more details.","title":"Registry options enhancements"},{"location":"migration/v3-to-v4/#configuration-transposed-into-environment-variables","text":"All configuration is now transposed into environment variables. Take a look at the documentation for more details. DIUN_DB env var has been renamed DIUN_DB_PATH to follow environment variables transposition.","title":"Configuration transposed into environment variables"},{"location":"migration/v3-to-v4/#all-fields-in-configuration-are-now-camelcased","text":"In order to enable transposition into environmental variables, all fields in configuration are now camelCased : notif.mail.insecure_skip_verify > notif.mail.insecureSkipVerify notif.rocketchat.user_id > notif.rocketchat.userID watch.first_check_notif > watch.firstCheckNotif ... v3 db : path : diun.db watch : workers : 10 schedule : \"0 */6 * * *\" first_check_notif : false notif : amqp : host : localhost port : 5672 username : guest password : guest exchange : queue : queue gotify : endpoint : http://gotify.foo.com token : Token123456 priority : 1 timeout : 10 mail : host : localhost port : 25 ssl : false insecure_skip_verify : false username : password : from : to : rocketchat : endpoint : http://rocket.foo.com:3000 channel : \"#general\" user_id : abcdEFGH012345678 token : Token123456 timeout : 10 script : cmd : \"myprogram\" args : - \"--anarg\" - \"another\" slack : webhook_url : https://hooks.slack.com/services/ABCD12EFG/HIJK34LMN/01234567890abcdefghij teams : webhook_url : https://outlook.office.com/webhook/ABCD12EFG/HIJK34LMN/01234567890abcdefghij telegram : token : aabbccdd:11223344 chat_ids : - 123456789 - 987654321 webhook : endpoint : http://webhook.foo.com/sd54qad89azd5a method : GET headers : Content-Type : application/json Authorization : Token123456 timeout : 10 regopts : myregistry : username : fii password : bor insecure_tls : true timeout : 5s docker.io : username : foo password : bar docker.io/crazymax : username_file : /run/secrets/username password_file : /run/secrets/password providers : docker : watch_stopped : true swarm : watch_by_default : true file : directory : ./imagesdir v4 db : path : diun.db watch : workers : 10 schedule : \"0 */6 * * *\" firstCheckNotif : false notif : amqp : host : localhost port : 5672 username : guest password : guest queue : queue gotify : endpoint : http://gotify.foo.com token : Token123456 priority : 1 timeout : 10s mail : host : localhost port : 25 ssl : false insecureSkipVerify : false from : diun@example.com to : webmaster@example.com rocketchat : endpoint : http://rocket.foo.com:3000 channel : \"#general\" userID : abcdEFGH012345678 token : Token123456 timeout : 10s script : cmd : \"myprogram\" args : - \"--anarg\" - \"another\" slack : webhookURL : https://hooks.slack.com/services/ABCD12EFG/HIJK34LMN/01234567890abcdefghij teams : webhookURL : https://outlook.office.com/webhook/ABCD12EFG/HIJK34LMN/01234567890abcdefghij telegram : token : aabbccdd:11223344 chatIDs : - 123456789 - 987654321 webhook : endpoint : http://webhook.foo.com/sd54qad89azd5a method : GET headers : content-type : application/json authorization : Token123456 timeout : 10s regopts : - name : \"myregistry\" username : fii password : bor insecureTLS : true timeout : 5s - name : \"docker.io\" selector : image username : foo password : bar - name : \"docker.io/crazymax\" selector : image usernameFile : /run/secrets/username passwordFile : /run/secrets/password providers : docker : watchStopped : true swarm : watchByDefault : true kubernetes : namespaces : - default - production file : directory : ./imagesdir","title":"All fields in configuration are now camelCased"},{"location":"migration/v3-to-v4/#diunyml-not-loaded-by-default-in-docker-image","text":"Following the transposition of the configuration into environment variables, the configuration file /diun.yml is no longer loaded by default in the official Docker image. If you want to load a configuration file through the Docker image you will have to declare the CONFIG environment variable with serve command pointing to the assigned configuration file: Tip This is no longer required since version 4.2.0. Now configuration file can be loaded from default places version : \"3.5\" services : diun : image : crazymax/diun:latest container_name : diun command : serve volumes : - \"./data:/data\" - \"./diun.yml:/diun.yml:ro\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"CONFIG=/diun.yml\" - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"LOG_JSON=false\" restart : always","title":"/diun.yml not loaded by default in Docker image"},{"location":"migration/v4.0-to-v4.17/","text":"Diun v4.0 to v4.17 \u00b6 New CLI \u00b6 CLI has changed since 4.17 and includes serve command to start Diun: v4.0 diun --config diun.yml v4.17 diun serve --config diun.yml","title":"Diun v4.0 to v4.17"},{"location":"migration/v4.0-to-v4.17/#diun-v40-to-v417","text":"","title":"Diun v4.0 to v4.17"},{"location":"migration/v4.0-to-v4.17/#new-cli","text":"CLI has changed since 4.17 and includes serve command to start Diun: v4.0 diun --config diun.yml v4.17 diun serve --config diun.yml","title":"New CLI"},{"location":"notif/amqp/","text":"Amqp notifications \u00b6 You can send notifications to any amqp compatible server with the following settings. Configuration \u00b6 File notif : amqp : host : localhost port : 5672 username : guest password : guest queue : queue Name Default Description host 1 localhost AMQP server host port 1 5672 AMQP server port username AMQP username usernameFile Use content of secret file as AMQP username if username not defined password AMQP password passwordFile Use content of secret file as AMQP password if password not defined exchange Name of the exchange the message will be sent to queue 1 Name of the queue the message will be sent to Environment variables DIUN_NOTIF_AMQP_HOST DIUN_NOTIF_AMQP_PORT DIUN_NOTIF_AMQP_USERNAME DIUN_NOTIF_AMQP_USERNAMEFILE DIUN_NOTIF_AMQP_PASSWORD DIUN_NOTIF_AMQP_PASSWORDFILE DIUN_NOTIF_AMQP_EXCHANGE DIUN_NOTIF_AMQP_QUEUE Sample \u00b6 The JSON response will look like this: { \"diun_version\" : \"0.3.0\" , \"hostname\" : \"myserver\" , \"status\" : \"new\" , \"provider\" : \"file\" , \"image\" : \"docker.io/crazymax/swarm-cronjob:0.2.1\" , \"hub_link\" : \"https://hub.docker.com/r/crazymax/swarm-cronjob\" , \"mime_type\" : \"application/vnd.docker.distribution.manifest.v2+json\" , \"digest\" : \"sha256:5913d4b5e8dc15430c2f47f40e43ab2ca7f2b8df5eee5db4d5c42311e08dfb79\" , \"created\" : \"2019-01-24T10:26:49.152006005Z\" , \"platform\" : \"linux/amd64\" } Value required \u21a9 \u21a9 \u21a9","title":"Amqp"},{"location":"notif/amqp/#amqp-notifications","text":"You can send notifications to any amqp compatible server with the following settings.","title":"Amqp notifications"},{"location":"notif/amqp/#configuration","text":"File notif : amqp : host : localhost port : 5672 username : guest password : guest queue : queue Name Default Description host 1 localhost AMQP server host port 1 5672 AMQP server port username AMQP username usernameFile Use content of secret file as AMQP username if username not defined password AMQP password passwordFile Use content of secret file as AMQP password if password not defined exchange Name of the exchange the message will be sent to queue 1 Name of the queue the message will be sent to Environment variables DIUN_NOTIF_AMQP_HOST DIUN_NOTIF_AMQP_PORT DIUN_NOTIF_AMQP_USERNAME DIUN_NOTIF_AMQP_USERNAMEFILE DIUN_NOTIF_AMQP_PASSWORD DIUN_NOTIF_AMQP_PASSWORDFILE DIUN_NOTIF_AMQP_EXCHANGE DIUN_NOTIF_AMQP_QUEUE","title":"Configuration"},{"location":"notif/amqp/#sample","text":"The JSON response will look like this: { \"diun_version\" : \"0.3.0\" , \"hostname\" : \"myserver\" , \"status\" : \"new\" , \"provider\" : \"file\" , \"image\" : \"docker.io/crazymax/swarm-cronjob:0.2.1\" , \"hub_link\" : \"https://hub.docker.com/r/crazymax/swarm-cronjob\" , \"mime_type\" : \"application/vnd.docker.distribution.manifest.v2+json\" , \"digest\" : \"sha256:5913d4b5e8dc15430c2f47f40e43ab2ca7f2b8df5eee5db4d5c42311e08dfb79\" , \"created\" : \"2019-01-24T10:26:49.152006005Z\" , \"platform\" : \"linux/amd64\" } Value required \u21a9 \u21a9 \u21a9","title":"Sample"},{"location":"notif/discord/","text":"Discord notifications \u00b6 Allow sending notifications to your Discord channel. Configuration \u00b6 File notif : discord : webhookURL : https://discordapp.com/api/webhooks/1234567890/Abcd-eFgh-iJklmNo_pqr mentions : - \"@here\" - \"@everyone\" - \"<@124>\" - \"<@125>\" - \"<@&200>\" renderFields : true timeout : 10s templateBody : | Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released. Name Default Description webhookURL 1 Discord incoming webhook URL mentions List of users or roles to notify renderFields true Render field objects timeout 10s Timeout specifies a time limit for the request to be made templateBody 1 See below Notification template for message body Environment variables DIUN_NOTIF_DISCORD_WEBHOOKURL DIUN_NOTIF_DISCORD_MENTIONS (comma separated) DIUN_NOTIF_DISCORD_RENDERFIELDS DIUN_NOTIF_DISCORD_TIMEOUT DIUN_NOTIF_DISCORD_TEMPLATEBODY Default templateBody \u00b6 Docker tag {{ if .Entry.Image.HubLink }}[**{{ .Entry.Image }}**]({{ .Entry.Image.HubLink }}){{ else }}**{{ .Entry.Image }}**{{ end }} which you subscribed to through {{ .Entry.Provider }} provider {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} on {{ .Entry.Image.Domain }} registry (triggered by {{ .Meta.Hostname }} host). Sample \u00b6 Value required \u21a9 \u21a9","title":"Discord"},{"location":"notif/discord/#discord-notifications","text":"Allow sending notifications to your Discord channel.","title":"Discord notifications"},{"location":"notif/discord/#configuration","text":"File notif : discord : webhookURL : https://discordapp.com/api/webhooks/1234567890/Abcd-eFgh-iJklmNo_pqr mentions : - \"@here\" - \"@everyone\" - \"<@124>\" - \"<@125>\" - \"<@&200>\" renderFields : true timeout : 10s templateBody : | Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released. Name Default Description webhookURL 1 Discord incoming webhook URL mentions List of users or roles to notify renderFields true Render field objects timeout 10s Timeout specifies a time limit for the request to be made templateBody 1 See below Notification template for message body Environment variables DIUN_NOTIF_DISCORD_WEBHOOKURL DIUN_NOTIF_DISCORD_MENTIONS (comma separated) DIUN_NOTIF_DISCORD_RENDERFIELDS DIUN_NOTIF_DISCORD_TIMEOUT DIUN_NOTIF_DISCORD_TEMPLATEBODY","title":"Configuration"},{"location":"notif/discord/#default-templatebody","text":"Docker tag {{ if .Entry.Image.HubLink }}[**{{ .Entry.Image }}**]({{ .Entry.Image.HubLink }}){{ else }}**{{ .Entry.Image }}**{{ end }} which you subscribed to through {{ .Entry.Provider }} provider {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} on {{ .Entry.Image.Domain }} registry (triggered by {{ .Meta.Hostname }} host).","title":"Default templateBody"},{"location":"notif/discord/#sample","text":"Value required \u21a9 \u21a9","title":"Sample"},{"location":"notif/gotify/","text":"Gotify notifications \u00b6 Notifications can be sent using a Gotify instance. Configuration \u00b6 File notif : gotify : endpoint : http://gotify.foo.com token : Token123456 priority : 1 timeout : 10s templateTitle : \"{{ .Entry.Image }} released\" templateBody : | Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released. Name Default Description endpoint 1 Gotify base URL token Application token tokenFile Use content of secret file as application token if token not defined priority 1 The priority of the message timeout 10s Timeout specifies a time limit for the request to be made templateTitle 1 See below Notification template for message title templateBody 1 See below Notification template for message body Environment variables DIUN_NOTIF_GOTIFY_ENDPOINT DIUN_NOTIF_GOTIFY_TOKEN DIUN_NOTIF_GOTIFY_TOKENFILE DIUN_NOTIF_GOTIFY_PRIORITY DIUN_NOTIF_GOTIFY_TIMEOUT DIUN_NOTIF_GOTIFY_TEMPLATETITLE DIUN_NOTIF_GOTIFY_TEMPLATEBODY Default templateTitle \u00b6 {{ .Entry.Image }} {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} Default templateBody \u00b6 Docker tag {{ if .Entry.Image.HubLink }}[**{{ .Entry.Image }}**]({{ .Entry.Image.HubLink }}){{ else }}**{{ .Entry.Image }}**{{ end }} which you subscribed to through {{ .Entry.Provider }} provider {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} on {{ .Entry.Image.Domain }} registry (triggered by {{ .Meta.Hostname }} host). Sample \u00b6 Value required \u21a9 \u21a9 \u21a9","title":"Gotify"},{"location":"notif/gotify/#gotify-notifications","text":"Notifications can be sent using a Gotify instance.","title":"Gotify notifications"},{"location":"notif/gotify/#configuration","text":"File notif : gotify : endpoint : http://gotify.foo.com token : Token123456 priority : 1 timeout : 10s templateTitle : \"{{ .Entry.Image }} released\" templateBody : | Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released. Name Default Description endpoint 1 Gotify base URL token Application token tokenFile Use content of secret file as application token if token not defined priority 1 The priority of the message timeout 10s Timeout specifies a time limit for the request to be made templateTitle 1 See below Notification template for message title templateBody 1 See below Notification template for message body Environment variables DIUN_NOTIF_GOTIFY_ENDPOINT DIUN_NOTIF_GOTIFY_TOKEN DIUN_NOTIF_GOTIFY_TOKENFILE DIUN_NOTIF_GOTIFY_PRIORITY DIUN_NOTIF_GOTIFY_TIMEOUT DIUN_NOTIF_GOTIFY_TEMPLATETITLE DIUN_NOTIF_GOTIFY_TEMPLATEBODY","title":"Configuration"},{"location":"notif/gotify/#default-templatetitle","text":"{{ .Entry.Image }} {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }}","title":"Default templateTitle"},{"location":"notif/gotify/#default-templatebody","text":"Docker tag {{ if .Entry.Image.HubLink }}[**{{ .Entry.Image }}**]({{ .Entry.Image.HubLink }}){{ else }}**{{ .Entry.Image }}**{{ end }} which you subscribed to through {{ .Entry.Provider }} provider {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} on {{ .Entry.Image.Domain }} registry (triggered by {{ .Meta.Hostname }} host).","title":"Default templateBody"},{"location":"notif/gotify/#sample","text":"Value required \u21a9 \u21a9 \u21a9","title":"Sample"},{"location":"notif/mail/","text":"Mail notifications \u00b6 Notifications can be sent through SMTP. Configuration \u00b6 File notif : mail : host : localhost port : 25 ssl : false insecureSkipVerify : false from : diun@example.com to : - webmaster@example.com - me@example.com templateTitle : \"{{ .Entry.Image }} released\" templateBody : | Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released. Name Default Description host 1 localhost SMTP server host port 1 25 SMTP server port ssl false SSL defines whether an SSL connection is used. Should be false in most cases since the auth mechanism should use STARTTLS insecureSkipVerify false Controls whether a client verifies the server's certificate chain and hostname localName localhost Hostname sent to the SMTP server with the HELO command username SMTP username usernameFile Use content of secret file as SMTP username if username not defined password SMTP password passwordFile Use content of secret file as SMTP password if password not defined from 1 Sender email address to 1 List of recipients email addresses templateTitle 1 See below Notification template for message title templateBody 1 See below Notification template for message body Environment variables DIUN_NOTIF_MAIL_HOST DIUN_NOTIF_MAIL_PORT DIUN_NOTIF_MAIL_SSL DIUN_NOTIF_MAIL_INSECURESKIPVERIFY DIUN_NOTIF_MAIL_LOCALNAME DIUN_NOTIF_MAIL_USERNAME DIUN_NOTIF_MAIL_USERNAMEFILE DIUN_NOTIF_MAIL_PASSWORD DIUN_NOTIF_MAIL_PASSWORDFILE DIUN_NOTIF_MAIL_FROM DIUN_NOTIF_MAIL_TO (comma separated) DIUN_NOTIF_MAIL_TEMPLATETITLE DIUN_NOTIF_MAIL_TEMPLATEBODY Default templateTitle \u00b6 {{ .Entry.Image }} {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} Default templateBody \u00b6 Docker tag {{ if .Entry.Image.HubLink }}[**{{ .Entry.Image }}**]({{ .Entry.Image.HubLink }}){{ else }}**{{ .Entry.Image }}**{{ end }} which you subscribed to through {{ .Entry.Provider }} provider has been {{ if (eq .Entry.Status \"new\") }}newly added{{ else }}updated{{ end }} on {{ .Meta.Hostname }}. This image has been {{ if (eq .Entry.Status \"new\") }}created{{ else }}updated{{ end }} at <code>{{ .Entry.Manifest.Created.Format \"Jan 02, 2006 15:04:05 UTC\" }}</code> with digest <code>{{ .Entry.Manifest.Digest }}</code> for <code>{{ .Entry.Manifest.Platform }}</code> platform. Need help, or have questions? Go to {{ .Meta.URL }} and leave an issue. Sample \u00b6 Value required \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9","title":"Mail"},{"location":"notif/mail/#mail-notifications","text":"Notifications can be sent through SMTP.","title":"Mail notifications"},{"location":"notif/mail/#configuration","text":"File notif : mail : host : localhost port : 25 ssl : false insecureSkipVerify : false from : diun@example.com to : - webmaster@example.com - me@example.com templateTitle : \"{{ .Entry.Image }} released\" templateBody : | Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released. Name Default Description host 1 localhost SMTP server host port 1 25 SMTP server port ssl false SSL defines whether an SSL connection is used. Should be false in most cases since the auth mechanism should use STARTTLS insecureSkipVerify false Controls whether a client verifies the server's certificate chain and hostname localName localhost Hostname sent to the SMTP server with the HELO command username SMTP username usernameFile Use content of secret file as SMTP username if username not defined password SMTP password passwordFile Use content of secret file as SMTP password if password not defined from 1 Sender email address to 1 List of recipients email addresses templateTitle 1 See below Notification template for message title templateBody 1 See below Notification template for message body Environment variables DIUN_NOTIF_MAIL_HOST DIUN_NOTIF_MAIL_PORT DIUN_NOTIF_MAIL_SSL DIUN_NOTIF_MAIL_INSECURESKIPVERIFY DIUN_NOTIF_MAIL_LOCALNAME DIUN_NOTIF_MAIL_USERNAME DIUN_NOTIF_MAIL_USERNAMEFILE DIUN_NOTIF_MAIL_PASSWORD DIUN_NOTIF_MAIL_PASSWORDFILE DIUN_NOTIF_MAIL_FROM DIUN_NOTIF_MAIL_TO (comma separated) DIUN_NOTIF_MAIL_TEMPLATETITLE DIUN_NOTIF_MAIL_TEMPLATEBODY","title":"Configuration"},{"location":"notif/mail/#default-templatetitle","text":"{{ .Entry.Image }} {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }}","title":"Default templateTitle"},{"location":"notif/mail/#default-templatebody","text":"Docker tag {{ if .Entry.Image.HubLink }}[**{{ .Entry.Image }}**]({{ .Entry.Image.HubLink }}){{ else }}**{{ .Entry.Image }}**{{ end }} which you subscribed to through {{ .Entry.Provider }} provider has been {{ if (eq .Entry.Status \"new\") }}newly added{{ else }}updated{{ end }} on {{ .Meta.Hostname }}. This image has been {{ if (eq .Entry.Status \"new\") }}created{{ else }}updated{{ end }} at <code>{{ .Entry.Manifest.Created.Format \"Jan 02, 2006 15:04:05 UTC\" }}</code> with digest <code>{{ .Entry.Manifest.Digest }}</code> for <code>{{ .Entry.Manifest.Platform }}</code> platform. Need help, or have questions? Go to {{ .Meta.URL }} and leave an issue.","title":"Default templateBody"},{"location":"notif/mail/#sample","text":"Value required \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9","title":"Sample"},{"location":"notif/matrix/","text":"Matrix notifications \u00b6 Allow sending notifications to your Matrix server. Configuration \u00b6 File notif : matrix : homeserverURL : https://matrix.org user : \"@foo:matrix.org\" password : bar roomID : \"!abcdefGHIjklmno:matrix.org\" msgType : notice templateBody : | Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released. Name Default Description homeserverURL https://matrix.org Matrix server URL user Username for authentication userFile Use content of secret file as username authentication if username not defined password Password for authentication passwordFile Use content of secret file as password authentication if password not defined roomID Room ID to send messages msgType notice Type of message being sent. Can be notice or text templateBody 1 See below Notification template for message body Environment variables DIUN_NOTIF_MATRIX_HOMESERVERURL DIUN_NOTIF_MATRIX_USER DIUN_NOTIF_MATRIX_USERFILE DIUN_NOTIF_MATRIX_PASSWORD DIUN_NOTIF_MATRIX_PASSWORDFILE DIUN_NOTIF_MATRIX_ROOMID DIUN_NOTIF_MATRIX_MSGTYPE DIUN_NOTIF_MATRIX_TEMPLATEBODY Default templateBody \u00b6 Docker tag {{ if .Entry.Image.HubLink }}[**{{ .Entry.Image }}**]({{ .Entry.Image.HubLink }}){{ else }}**{{ .Entry.Image }}**{{ end }} which you subscribed to through {{ .Entry.Provider }} provider {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} on {{ .Entry.Image.Domain }} registry (triggered by {{ .Meta.Hostname }} host). Sample \u00b6 Value required \u21a9","title":"Matrix"},{"location":"notif/matrix/#matrix-notifications","text":"Allow sending notifications to your Matrix server.","title":"Matrix notifications"},{"location":"notif/matrix/#configuration","text":"File notif : matrix : homeserverURL : https://matrix.org user : \"@foo:matrix.org\" password : bar roomID : \"!abcdefGHIjklmno:matrix.org\" msgType : notice templateBody : | Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released. Name Default Description homeserverURL https://matrix.org Matrix server URL user Username for authentication userFile Use content of secret file as username authentication if username not defined password Password for authentication passwordFile Use content of secret file as password authentication if password not defined roomID Room ID to send messages msgType notice Type of message being sent. Can be notice or text templateBody 1 See below Notification template for message body Environment variables DIUN_NOTIF_MATRIX_HOMESERVERURL DIUN_NOTIF_MATRIX_USER DIUN_NOTIF_MATRIX_USERFILE DIUN_NOTIF_MATRIX_PASSWORD DIUN_NOTIF_MATRIX_PASSWORDFILE DIUN_NOTIF_MATRIX_ROOMID DIUN_NOTIF_MATRIX_MSGTYPE DIUN_NOTIF_MATRIX_TEMPLATEBODY","title":"Configuration"},{"location":"notif/matrix/#default-templatebody","text":"Docker tag {{ if .Entry.Image.HubLink }}[**{{ .Entry.Image }}**]({{ .Entry.Image.HubLink }}){{ else }}**{{ .Entry.Image }}**{{ end }} which you subscribed to through {{ .Entry.Provider }} provider {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} on {{ .Entry.Image.Domain }} registry (triggered by {{ .Meta.Hostname }} host).","title":"Default templateBody"},{"location":"notif/matrix/#sample","text":"Value required \u21a9","title":"Sample"},{"location":"notif/mqtt/","text":"MQTT notifications \u00b6 You can send notifications to any MQTT compatible server with the following settings. Configuration \u00b6 File notif : mqtt : scheme : mqtt host : localhost port : 1883 username : guest password : guest client : diun topic : docker/diun qos : 0 Name Default Description scheme 1 mqtt MQTT server scheme ( mqtt , mqtts , ws or wss ) host 1 localhost MQTT server host port 1 1883 MQTT server port username MQTT username usernameFile Use content of secret file as MQTT username if username not defined password MQTT password passwordFile Use content of secret file as MQTT password if password not defined client 1 Client id to be used by this client when connecting to the MQTT broker topic 1 Topic the message will be sent to qos 0 Ensured message delivery at specified Quality of Service (QoS) Environment variables DIUN_NOTIF_MQTT_SCHEME DIUN_NOTIF_MQTT_HOST DIUN_NOTIF_MQTT_PORT DIUN_NOTIF_MQTT_USERNAME DIUN_NOTIF_MQTT_USERNAMEFILE DIUN_NOTIF_MQTT_PASSWORD DIUN_NOTIF_MQTT_PASSWORDFILE DIUN_NOTIF_MQTT_CLIENT DIUN_NOTIF_MQTT_TOPIC DIUN_NOTIF_MQTT_QOS Sample \u00b6 The JSON response will look like this: { \"diun_version\" : \"0.3.0\" , \"hostname\" : \"myserver\" , \"status\" : \"new\" , \"provider\" : \"file\" , \"image\" : \"docker.io/crazymax/swarm-cronjob:0.2.1\" , \"hub_link\" : \"https://hub.docker.com/r/crazymax/swarm-cronjob\" , \"mime_type\" : \"application/vnd.docker.distribution.manifest.v2+json\" , \"digest\" : \"sha256:5913d4b5e8dc15430c2f47f40e43ab2ca7f2b8df5eee5db4d5c42311e08dfb79\" , \"created\" : \"2019-01-24T10:26:49.152006005Z\" , \"platform\" : \"linux/amd64\" } Value required \u21a9 \u21a9 \u21a9 \u21a9 \u21a9","title":"MQTT"},{"location":"notif/mqtt/#mqtt-notifications","text":"You can send notifications to any MQTT compatible server with the following settings.","title":"MQTT notifications"},{"location":"notif/mqtt/#configuration","text":"File notif : mqtt : scheme : mqtt host : localhost port : 1883 username : guest password : guest client : diun topic : docker/diun qos : 0 Name Default Description scheme 1 mqtt MQTT server scheme ( mqtt , mqtts , ws or wss ) host 1 localhost MQTT server host port 1 1883 MQTT server port username MQTT username usernameFile Use content of secret file as MQTT username if username not defined password MQTT password passwordFile Use content of secret file as MQTT password if password not defined client 1 Client id to be used by this client when connecting to the MQTT broker topic 1 Topic the message will be sent to qos 0 Ensured message delivery at specified Quality of Service (QoS) Environment variables DIUN_NOTIF_MQTT_SCHEME DIUN_NOTIF_MQTT_HOST DIUN_NOTIF_MQTT_PORT DIUN_NOTIF_MQTT_USERNAME DIUN_NOTIF_MQTT_USERNAMEFILE DIUN_NOTIF_MQTT_PASSWORD DIUN_NOTIF_MQTT_PASSWORDFILE DIUN_NOTIF_MQTT_CLIENT DIUN_NOTIF_MQTT_TOPIC DIUN_NOTIF_MQTT_QOS","title":"Configuration"},{"location":"notif/mqtt/#sample","text":"The JSON response will look like this: { \"diun_version\" : \"0.3.0\" , \"hostname\" : \"myserver\" , \"status\" : \"new\" , \"provider\" : \"file\" , \"image\" : \"docker.io/crazymax/swarm-cronjob:0.2.1\" , \"hub_link\" : \"https://hub.docker.com/r/crazymax/swarm-cronjob\" , \"mime_type\" : \"application/vnd.docker.distribution.manifest.v2+json\" , \"digest\" : \"sha256:5913d4b5e8dc15430c2f47f40e43ab2ca7f2b8df5eee5db4d5c42311e08dfb79\" , \"created\" : \"2019-01-24T10:26:49.152006005Z\" , \"platform\" : \"linux/amd64\" } Value required \u21a9 \u21a9 \u21a9 \u21a9 \u21a9","title":"Sample"},{"location":"notif/pushover/","text":"Pushover notifications \u00b6 You can send notifications using Pushover . Configuration \u00b6 File notif : pushover : token : uQiRzpo4DXghDmr9QzzfQu27cmVRsG recipient : gznej3rKEVAvPUxu9vvNnqpmZpokzF templateTitle : \"{{ .Entry.Image }} released\" templateBody : | Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released. Name Default Description token Pushover application/API token tokenFile Use content of secret file as Pushover application/API token if token not defined recipient User key to send notification to recipientFile Use content of secret file as User key if recipient not defined templateTitle 1 See below Notification template for message title templateBody 1 See below Notification template for message body Environment variables DIUN_NOTIF_PUSHOVER_TOKEN DIUN_NOTIF_PUSHOVER_TOKENFILE DIUN_NOTIF_PUSHOVER_RECIPIENT DIUN_NOTIF_PUSHOVER_RECIPIENTFILE DIUN_NOTIF_PUSHOVER_TEMPLATETITLE DIUN_NOTIF_PUSHOVER_TEMPLATEBODY Default templateTitle \u00b6 {{ .Entry.Image }} {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} Default templateBody \u00b6 Docker tag {{ if .Entry.Image.HubLink }}[**{{ .Entry.Image }}**]({{ .Entry.Image.HubLink }}){{ else }}**{{ .Entry.Image }}**{{ end }} which you subscribed to through {{ .Entry.Provider }} provider {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} on {{ .Entry.Image.Domain }} registry (triggered by {{ .Meta.Hostname }} host). Sample \u00b6 Value required \u21a9 \u21a9","title":"Pushover"},{"location":"notif/pushover/#pushover-notifications","text":"You can send notifications using Pushover .","title":"Pushover notifications"},{"location":"notif/pushover/#configuration","text":"File notif : pushover : token : uQiRzpo4DXghDmr9QzzfQu27cmVRsG recipient : gznej3rKEVAvPUxu9vvNnqpmZpokzF templateTitle : \"{{ .Entry.Image }} released\" templateBody : | Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released. Name Default Description token Pushover application/API token tokenFile Use content of secret file as Pushover application/API token if token not defined recipient User key to send notification to recipientFile Use content of secret file as User key if recipient not defined templateTitle 1 See below Notification template for message title templateBody 1 See below Notification template for message body Environment variables DIUN_NOTIF_PUSHOVER_TOKEN DIUN_NOTIF_PUSHOVER_TOKENFILE DIUN_NOTIF_PUSHOVER_RECIPIENT DIUN_NOTIF_PUSHOVER_RECIPIENTFILE DIUN_NOTIF_PUSHOVER_TEMPLATETITLE DIUN_NOTIF_PUSHOVER_TEMPLATEBODY","title":"Configuration"},{"location":"notif/pushover/#default-templatetitle","text":"{{ .Entry.Image }} {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }}","title":"Default templateTitle"},{"location":"notif/pushover/#default-templatebody","text":"Docker tag {{ if .Entry.Image.HubLink }}[**{{ .Entry.Image }}**]({{ .Entry.Image.HubLink }}){{ else }}**{{ .Entry.Image }}**{{ end }} which you subscribed to through {{ .Entry.Provider }} provider {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} on {{ .Entry.Image.Domain }} registry (triggered by {{ .Meta.Hostname }} host).","title":"Default templateBody"},{"location":"notif/pushover/#sample","text":"Value required \u21a9 \u21a9","title":"Sample"},{"location":"notif/rocketchat/","text":"Rocket.Chat notifications \u00b6 Allow sending notifications to your Rocket.Chat channel. Configuration \u00b6 File notif : rocketchat : endpoint : http://rocket.foo.com:3000 channel : \"#general\" userID : abcdEFGH012345678 token : Token123456 renderAttachment : true timeout : 10s templateTitle : \"{{ .Entry.Image }} released\" templateBody : | Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released. Name Default Description endpoint 1 Rocket.Chat base URL channel 1 Channel name with the prefix in front of it userID 1 User ID token Authentication token tokenFile Use content of secret file as authentication token if token not defined renderAttachment true Render attachment object timeout 10s Timeout specifies a time limit for the request to be made templateTitle 1 See below Notification template for message title templateBody 1 See below Notification template for message body Warning You must first create a Personal Access Token through your account settings on your Rocket.Chat instance. Additionally, your user must have the bot role. Else, the notifications won't work since they contain alias and avatar properties (see this reference for details). Environment variables DIUN_NOTIF_ROCKETCHAT_ENDPOINT DIUN_NOTIF_ROCKETCHAT_CHANNEL DIUN_NOTIF_ROCKETCHAT_USERID DIUN_NOTIF_ROCKETCHAT_TOKEN DIUN_NOTIF_ROCKETCHAT_TOKENFILE DIUN_NOTIF_ROCKETCHAT_RENDERATTACHMENT DIUN_NOTIF_ROCKETCHAT_TIMEOUT DIUN_NOTIF_ROCKETCHAT_TEMPLATETITLE DIUN_NOTIF_ROCKETCHAT_TEMPLATEBODY Default templateTitle \u00b6 {{ .Entry.Image }} {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} Default templateBody \u00b6 Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been {{ if (eq .Entry.Status \"new\") }}newly added{{ else }}updated{{ end }} on {{ .Meta.Hostname }}. Sample \u00b6 Value required \u21a9 \u21a9 \u21a9 \u21a9 \u21a9","title":"Rocket.Chat"},{"location":"notif/rocketchat/#rocketchat-notifications","text":"Allow sending notifications to your Rocket.Chat channel.","title":"Rocket.Chat notifications"},{"location":"notif/rocketchat/#configuration","text":"File notif : rocketchat : endpoint : http://rocket.foo.com:3000 channel : \"#general\" userID : abcdEFGH012345678 token : Token123456 renderAttachment : true timeout : 10s templateTitle : \"{{ .Entry.Image }} released\" templateBody : | Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released. Name Default Description endpoint 1 Rocket.Chat base URL channel 1 Channel name with the prefix in front of it userID 1 User ID token Authentication token tokenFile Use content of secret file as authentication token if token not defined renderAttachment true Render attachment object timeout 10s Timeout specifies a time limit for the request to be made templateTitle 1 See below Notification template for message title templateBody 1 See below Notification template for message body Warning You must first create a Personal Access Token through your account settings on your Rocket.Chat instance. Additionally, your user must have the bot role. Else, the notifications won't work since they contain alias and avatar properties (see this reference for details). Environment variables DIUN_NOTIF_ROCKETCHAT_ENDPOINT DIUN_NOTIF_ROCKETCHAT_CHANNEL DIUN_NOTIF_ROCKETCHAT_USERID DIUN_NOTIF_ROCKETCHAT_TOKEN DIUN_NOTIF_ROCKETCHAT_TOKENFILE DIUN_NOTIF_ROCKETCHAT_RENDERATTACHMENT DIUN_NOTIF_ROCKETCHAT_TIMEOUT DIUN_NOTIF_ROCKETCHAT_TEMPLATETITLE DIUN_NOTIF_ROCKETCHAT_TEMPLATEBODY","title":"Configuration"},{"location":"notif/rocketchat/#default-templatetitle","text":"{{ .Entry.Image }} {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }}","title":"Default templateTitle"},{"location":"notif/rocketchat/#default-templatebody","text":"Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been {{ if (eq .Entry.Status \"new\") }}newly added{{ else }}updated{{ end }} on {{ .Meta.Hostname }}.","title":"Default templateBody"},{"location":"notif/rocketchat/#sample","text":"Value required \u21a9 \u21a9 \u21a9 \u21a9 \u21a9","title":"Sample"},{"location":"notif/script/","text":"Script notifications \u00b6 You can call a script when a notification occured. Following environment variables will be passed: DIUN_VERSION=3.0.0 DIUN_ENTRY_STATUS=new DIUN_HOSTNAME=myserver DIUN_ENTRY_PROVIDER=file DIUN_ENTRY_IMAGE=docker.io/crazymax/diun:latest DIUN_ENTRY_HUBLINK=https://hub.docker.com/r/crazymax/diun DIUN_ENTRY_MIMETYPE=application/vnd.docker.distribution.manifest.list.v2+json DIUN_ENTRY_DIGEST=sha256:216e3ae7de4ca8b553eb11ef7abda00651e79e537e85c46108284e5e91673e01 DIUN_ENTRY_CREATED=2020-03-26 12:23:56 +0000 UTC DIUN_ENTRY_PLATFORM=linux/amd64 Configuration \u00b6 File notif : script : cmd : \"myprogram\" args : - \"--anarg\" - \"another\" Name Default Description cmd 1 Command or script to execute args List of args to pass to cmd dir Specifies the working directory of the command Environment variables DIUN_NOTIF_SCRIPT_CMD DIUN_NOTIF_SCRIPT_ARGS (comma separated) DIUN_NOTIF_SCRIPT_DIR Value required \u21a9","title":"Script"},{"location":"notif/script/#script-notifications","text":"You can call a script when a notification occured. Following environment variables will be passed: DIUN_VERSION=3.0.0 DIUN_ENTRY_STATUS=new DIUN_HOSTNAME=myserver DIUN_ENTRY_PROVIDER=file DIUN_ENTRY_IMAGE=docker.io/crazymax/diun:latest DIUN_ENTRY_HUBLINK=https://hub.docker.com/r/crazymax/diun DIUN_ENTRY_MIMETYPE=application/vnd.docker.distribution.manifest.list.v2+json DIUN_ENTRY_DIGEST=sha256:216e3ae7de4ca8b553eb11ef7abda00651e79e537e85c46108284e5e91673e01 DIUN_ENTRY_CREATED=2020-03-26 12:23:56 +0000 UTC DIUN_ENTRY_PLATFORM=linux/amd64","title":"Script notifications"},{"location":"notif/script/#configuration","text":"File notif : script : cmd : \"myprogram\" args : - \"--anarg\" - \"another\" Name Default Description cmd 1 Command or script to execute args List of args to pass to cmd dir Specifies the working directory of the command Environment variables DIUN_NOTIF_SCRIPT_CMD DIUN_NOTIF_SCRIPT_ARGS (comma separated) DIUN_NOTIF_SCRIPT_DIR Value required \u21a9","title":"Configuration"},{"location":"notif/slack/","text":"Slack notifications \u00b6 You can send notifications to your Slack channel using an incoming webhook URL . Hint Mattermost webhooks are compatible with Slack notification without any special configuration (if Webhooks are enabled). Configuration \u00b6 File notif : slack : webhookURL : https://hooks.slack.com/services/ABCD12EFG/HIJK34LMN/01234567890abcdefghij renderFields : true templateBody : | Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released. Name Default Description webhookURL 1 Slack incoming webhook URL renderFields true Render field objects templateBody 1 See below Notification template for message body Environment variables DIUN_NOTIF_SLACK_WEBHOOKURL DIUN_NOTIF_SLACK_RENDERFIELDS DIUN_NOTIF_SLACK_TEMPLATEBODY Default templateBody \u00b6 <!channel> Docker tag {{ if .Entry.Image.HubLink }}<{{ .Entry.Image.HubLink }}|`{{ .Entry.Image }}`>{{ else }}`{{ .Entry.Image }}`{{ end }} {{ if (eq .Entry.Status \"new\") }}available{{ else }}updated{{ end }}. Sample \u00b6 Value required \u21a9 \u21a9","title":"Slack"},{"location":"notif/slack/#slack-notifications","text":"You can send notifications to your Slack channel using an incoming webhook URL . Hint Mattermost webhooks are compatible with Slack notification without any special configuration (if Webhooks are enabled).","title":"Slack notifications"},{"location":"notif/slack/#configuration","text":"File notif : slack : webhookURL : https://hooks.slack.com/services/ABCD12EFG/HIJK34LMN/01234567890abcdefghij renderFields : true templateBody : | Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released. Name Default Description webhookURL 1 Slack incoming webhook URL renderFields true Render field objects templateBody 1 See below Notification template for message body Environment variables DIUN_NOTIF_SLACK_WEBHOOKURL DIUN_NOTIF_SLACK_RENDERFIELDS DIUN_NOTIF_SLACK_TEMPLATEBODY","title":"Configuration"},{"location":"notif/slack/#default-templatebody","text":"<!channel> Docker tag {{ if .Entry.Image.HubLink }}<{{ .Entry.Image.HubLink }}|`{{ .Entry.Image }}`>{{ else }}`{{ .Entry.Image }}`{{ end }} {{ if (eq .Entry.Status \"new\") }}available{{ else }}updated{{ end }}.","title":"Default templateBody"},{"location":"notif/slack/#sample","text":"Value required \u21a9 \u21a9","title":"Sample"},{"location":"notif/teams/","text":"Teams notifications \u00b6 You can send notifications to your Teams team-channel using an incoming webhook URL . Configuration \u00b6 File notif : teams : webhookURL : https://outlook.office.com/webhook/ABCD12EFG/HIJK34LMN/01234567890abcdefghij renderFacts : true templateBody : | Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released. Name Default Description webhookURL 1 Teams incoming webhook URL renderFacts true Render fact objects templateBody 1 See below Notification template for message body Environment variables DIUN_NOTIF_TEAMS_WEBHOOKURL DIUN_NOTIF_TEAMS_RENDERFACTS DIUN_NOTIF_TEAMS_TEMPLATEBODY Default templateBody \u00b6 Docker tag {{ if .Entry.Image.HubLink }}[`{{ .Entry.Image }}`]({{ .Entry.Image.HubLink }}){{ else }}`{{ .Entry.Image }}`{{ end }}{{ if (eq .Entry.Status \"new\") }}newly added{{ else }}updated{{ end }}. Sample \u00b6 Value required \u21a9 \u21a9","title":"Teams"},{"location":"notif/teams/#teams-notifications","text":"You can send notifications to your Teams team-channel using an incoming webhook URL .","title":"Teams notifications"},{"location":"notif/teams/#configuration","text":"File notif : teams : webhookURL : https://outlook.office.com/webhook/ABCD12EFG/HIJK34LMN/01234567890abcdefghij renderFacts : true templateBody : | Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released. Name Default Description webhookURL 1 Teams incoming webhook URL renderFacts true Render fact objects templateBody 1 See below Notification template for message body Environment variables DIUN_NOTIF_TEAMS_WEBHOOKURL DIUN_NOTIF_TEAMS_RENDERFACTS DIUN_NOTIF_TEAMS_TEMPLATEBODY","title":"Configuration"},{"location":"notif/teams/#default-templatebody","text":"Docker tag {{ if .Entry.Image.HubLink }}[`{{ .Entry.Image }}`]({{ .Entry.Image.HubLink }}){{ else }}`{{ .Entry.Image }}`{{ end }}{{ if (eq .Entry.Status \"new\") }}newly added{{ else }}updated{{ end }}.","title":"Default templateBody"},{"location":"notif/teams/#sample","text":"Value required \u21a9 \u21a9","title":"Sample"},{"location":"notif/telegram/","text":"Telegram notifications \u00b6 Notifications can be sent via Telegram using a Telegram Bot . Follow the instructions to set up a bot and get it's token. Message the GetID bot to find your chat ID. Multiple chat IDs can be provided in order to deliver notifications to multiple recipients. Configuration \u00b6 File notif : telegram : token : aabbccdd:11223344 chatIDs : - 123456789 - 987654321 templateBody : | Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released. Name Default Description token Telegram bot token tokenFile Use content of secret file as Telegram bot token if token not defined chatIDs List of chat IDs to send notifications to chatIDsFile Use content of secret file as chat IDs if chatIDs not defined templateBody 1 See below Notification template for message body Environment variables DIUN_NOTIF_TELEGRAM_TOKEN DIUN_NOTIF_TELEGRAM_TOKENFILE DIUN_NOTIF_TELEGRAM_CHATIDS (comma separated) DIUN_NOTIF_TELEGRAM_CHATIDSFILE DIUN_NOTIF_TELEGRAM_TEMPLATEBODY chat IDs secret file Chat IDs secret file must be a valid JSON array like: [123456789,987654321] Default templateBody \u00b6 Docker tag {{ if .Entry.Image.HubLink }}[{{ .Entry.Image }}]({{ .Entry.Image.HubLink }}){{ else }}{{ .Entry.Image }}{{ end }} which you subscribed to through {{ .Entry.Provider }} provider has been {{ if (eq .Entry.Status \"new\") }}newly added{{ else }}updated{{ end }} on {{ escapeMarkdown .Meta.Hostname }}. Note escapeMarkdown is a special function to deal with a makrdown strict parsing issue on Telegram server. Sample \u00b6 Value required \u21a9","title":"Telegram"},{"location":"notif/telegram/#telegram-notifications","text":"Notifications can be sent via Telegram using a Telegram Bot . Follow the instructions to set up a bot and get it's token. Message the GetID bot to find your chat ID. Multiple chat IDs can be provided in order to deliver notifications to multiple recipients.","title":"Telegram notifications"},{"location":"notif/telegram/#configuration","text":"File notif : telegram : token : aabbccdd:11223344 chatIDs : - 123456789 - 987654321 templateBody : | Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released. Name Default Description token Telegram bot token tokenFile Use content of secret file as Telegram bot token if token not defined chatIDs List of chat IDs to send notifications to chatIDsFile Use content of secret file as chat IDs if chatIDs not defined templateBody 1 See below Notification template for message body Environment variables DIUN_NOTIF_TELEGRAM_TOKEN DIUN_NOTIF_TELEGRAM_TOKENFILE DIUN_NOTIF_TELEGRAM_CHATIDS (comma separated) DIUN_NOTIF_TELEGRAM_CHATIDSFILE DIUN_NOTIF_TELEGRAM_TEMPLATEBODY chat IDs secret file Chat IDs secret file must be a valid JSON array like: [123456789,987654321]","title":"Configuration"},{"location":"notif/telegram/#default-templatebody","text":"Docker tag {{ if .Entry.Image.HubLink }}[{{ .Entry.Image }}]({{ .Entry.Image.HubLink }}){{ else }}{{ .Entry.Image }}{{ end }} which you subscribed to through {{ .Entry.Provider }} provider has been {{ if (eq .Entry.Status \"new\") }}newly added{{ else }}updated{{ end }} on {{ escapeMarkdown .Meta.Hostname }}. Note escapeMarkdown is a special function to deal with a makrdown strict parsing issue on Telegram server.","title":"Default templateBody"},{"location":"notif/telegram/#sample","text":"Value required \u21a9","title":"Sample"},{"location":"notif/webhook/","text":"Webhook notifications \u00b6 You can send webhook notifications with the following settings. Configuration \u00b6 File notif : webhook : endpoint : http://webhook.foo.com/sd54qad89azd5a method : GET headers : content-type : application/json authorization : Token123456 timeout : 10s Name Default Description endpoint 1 URL of the HTTP request method 1 GET HTTP method headers Map of additional headers to be sent (key is case insensitive) timeout 10s Timeout specifies a time limit for the request to be made Environment variables DIUN_NOTIF_WEBHOOK_ENDPOINT DIUN_NOTIF_WEBHOOK_METHOD DIUN_NOTIF_WEBHOOK_HEADERS_<KEY> DIUN_NOTIF_WEBHOOK_TIMEOUT Sample \u00b6 The JSON response will look like this: { \"diun_version\" : \"4.0.0\" , \"hostname\" : \"myserver\" , \"status\" : \"new\" , \"provider\" : \"file\" , \"image\" : \"docker.io/crazymax/diun:latest\" , \"hub_link\" : \"https://hub.docker.com/r/crazymax/diun\" , \"mime_type\" : \"application/vnd.docker.distribution.manifest.list.v2+json\" , \"digest\" : \"sha256:216e3ae7de4ca8b553eb11ef7abda00651e79e537e85c46108284e5e91673e01\" , \"created\" : \"2020-03-26T12:23:56Z\" , \"platform\" : \"linux/amd64\" } Value required \u21a9 \u21a9","title":"Webhook"},{"location":"notif/webhook/#webhook-notifications","text":"You can send webhook notifications with the following settings.","title":"Webhook notifications"},{"location":"notif/webhook/#configuration","text":"File notif : webhook : endpoint : http://webhook.foo.com/sd54qad89azd5a method : GET headers : content-type : application/json authorization : Token123456 timeout : 10s Name Default Description endpoint 1 URL of the HTTP request method 1 GET HTTP method headers Map of additional headers to be sent (key is case insensitive) timeout 10s Timeout specifies a time limit for the request to be made Environment variables DIUN_NOTIF_WEBHOOK_ENDPOINT DIUN_NOTIF_WEBHOOK_METHOD DIUN_NOTIF_WEBHOOK_HEADERS_<KEY> DIUN_NOTIF_WEBHOOK_TIMEOUT","title":"Configuration"},{"location":"notif/webhook/#sample","text":"The JSON response will look like this: { \"diun_version\" : \"4.0.0\" , \"hostname\" : \"myserver\" , \"status\" : \"new\" , \"provider\" : \"file\" , \"image\" : \"docker.io/crazymax/diun:latest\" , \"hub_link\" : \"https://hub.docker.com/r/crazymax/diun\" , \"mime_type\" : \"application/vnd.docker.distribution.manifest.list.v2+json\" , \"digest\" : \"sha256:216e3ae7de4ca8b553eb11ef7abda00651e79e537e85c46108284e5e91673e01\" , \"created\" : \"2020-03-26T12:23:56Z\" , \"platform\" : \"linux/amd64\" } Value required \u21a9 \u21a9","title":"Sample"},{"location":"providers/docker/","text":"Docker provider \u00b6 About \u00b6 The Docker provider allows you to analyze the containers of your Docker instance to extract images found and check for updates on the registry. Quick start \u00b6 In this section we quickly go over a basic docker-compose file using your local docker provider. Here we use a single Docker provider with a minimum configuration to analyze labeled containers (watch by default disabled), even stopped ones, of your local Docker instance. Now let's create a simple docker-compose file with Diun and some simple services: version : \"3.5\" services : diun : image : crazymax/diun:latest container_name : diun command : serve volumes : - \"./data:/data\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"LOG_JSON=false\" - \"DIUN_WATCH_WORKERS=20\" - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\" - \"DIUN_PROVIDERS_DOCKER=true\" restart : always cloudflared : image : crazymax/cloudflared:latest container_name : cloudflared ports : - target : 5053 published : 5053 protocol : udp - target : 49312 published : 49312 protocol : tcp environment : - \"TZ=Europe/Paris\" - \"TUNNEL_DNS_UPSTREAM=https://1.1.1.1/dns-query,https://1.0.0.1/dns-query\" labels : - \"diun.enable=true\" restart : always As an example we use crazymax/cloudflared:latest Docker image. A few labels are added to configure the image analysis of this container for Diun. Now start this composition with docker-composes up -d and take a look at the logs: $ docker-compose logs -f Attaching to bin_diun_1, cloudflared cloudflared | time=\"2019-12-14T15:30:07+01:00\" level=info msg=\"Adding DNS upstream\" url=\"https://1.1.1.1/dns-query\" cloudflared | time=\"2019-12-14T15:30:07+01:00\" level=info msg=\"Adding DNS upstream\" url=\"https://1.0.0.1/dns-query\" cloudflared | time=\"2019-12-14T15:30:07+01:00\" level=info msg=\"Starting metrics server\" addr=\"[::]:49312\" cloudflared | time=\"2019-12-14T15:30:07+01:00\" level=info msg=\"Starting DNS over HTTPS proxy server\" addr=\"dns://0.0.0.0:5053\" diun_1 | Sat, 14 Dec 2019 15:30:07 CET INF Starting Diun v2.0.0 diun_1 | Sat, 14 Dec 2019 15:30:07 CET INF Found 1 image(s) to analyze provider=docker diun_1 | Sat, 14 Dec 2019 15:30:10 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:latest provider=docker diun_1 | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.9.0 provider=docker diun_1 | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.9.1 provider=docker diun_1 | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.9.2 provider=docker diun_1 | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.10.1 provider=docker diun_1 | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.10.4 provider=docker diun_1 | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.10.2 provider=docker diun_1 | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.11.0 provider=docker diun_1 | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.11.3 provider=docker diun_1 | Sat, 14 Dec 2019 15:30:13 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.11.2 provider=docker diun_1 | Sat, 14 Dec 2019 15:30:13 CET INF Cron initialized with schedule 0 */6 * * * diun_1 | Sat, 14 Dec 2019 15:30:13 CET INF Next run in 2 hours 29 minutes (2019-12-14 16:00:00 +0100 CET) Configuration \u00b6 Hint Environment variable DIUN_PROVIDERS_DOCKER=true can be used to enable this provider with default values. endpoint \u00b6 Server address to connect to. Local if empty. File providers : docker : endpoint : \"unix:///var/run/docker.sock\" Environment variables DIUN_PROVIDERS_DOCKER_ENDPOINT apiVersion \u00b6 Overrides the client version with the specified one. File providers : docker : apiVersion : \"1.39\" Environment variables DIUN_PROVIDERS_DOCKER_APIVERSION tlsCertsPath \u00b6 Path to load the TLS certificates from. File providers : docker : tlsCertsPath : \"/certs/\" Environment variables DIUN_PROVIDERS_DOCKER_TLSCERTSPATH tlsVerify \u00b6 Controls whether client verifies the server's certificate chain and hostname (default true ). File providers : docker : tlsVerify : true Environment variables DIUN_PROVIDERS_DOCKER_TLSVERIFY watchByDefault \u00b6 Enable watch by default. If false, containers that don't have diun.enable=true label will be ignored (default false ). File providers : docker : watchByDefault : false Environment variables DIUN_PROVIDERS_DOCKER_WATCHBYDEFAULT watchStopped \u00b6 Include created and exited containers too (default false ). File providers : docker : watchStopped : false Environment variables DIUN_PROVIDERS_DOCKER_WATCHSTOPPED Docker labels \u00b6 You can configure more finely the way to analyze the image of your container through Docker labels: Name Default Description diun.enable Set to true to enable image analysis of this container diun.regopt Registry options name to use diun.watch_repo false Watch all tags of this container image ( be careful with this setting) diun.notify_on new;update Semicolon separated list of status to be notified: new , update . diun.max_tags 0 Maximum number of tags to watch if diun.watch_repo enabled. 0 means all of them diun.include_tags Semicolon separated list of regular expressions to include tags. Can be useful if you enable diun.watch_repo diun.exclude_tags Semicolon separated list of regular expressions to exclude tags. Can be useful if you enable diun.watch_repo diun.platform automatic Platform to use (e.g. linux/amd64 )","title":"Docker"},{"location":"providers/docker/#docker-provider","text":"","title":"Docker provider"},{"location":"providers/docker/#about","text":"The Docker provider allows you to analyze the containers of your Docker instance to extract images found and check for updates on the registry.","title":"About"},{"location":"providers/docker/#quick-start","text":"In this section we quickly go over a basic docker-compose file using your local docker provider. Here we use a single Docker provider with a minimum configuration to analyze labeled containers (watch by default disabled), even stopped ones, of your local Docker instance. Now let's create a simple docker-compose file with Diun and some simple services: version : \"3.5\" services : diun : image : crazymax/diun:latest container_name : diun command : serve volumes : - \"./data:/data\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"LOG_JSON=false\" - \"DIUN_WATCH_WORKERS=20\" - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\" - \"DIUN_PROVIDERS_DOCKER=true\" restart : always cloudflared : image : crazymax/cloudflared:latest container_name : cloudflared ports : - target : 5053 published : 5053 protocol : udp - target : 49312 published : 49312 protocol : tcp environment : - \"TZ=Europe/Paris\" - \"TUNNEL_DNS_UPSTREAM=https://1.1.1.1/dns-query,https://1.0.0.1/dns-query\" labels : - \"diun.enable=true\" restart : always As an example we use crazymax/cloudflared:latest Docker image. A few labels are added to configure the image analysis of this container for Diun. Now start this composition with docker-composes up -d and take a look at the logs: $ docker-compose logs -f Attaching to bin_diun_1, cloudflared cloudflared | time=\"2019-12-14T15:30:07+01:00\" level=info msg=\"Adding DNS upstream\" url=\"https://1.1.1.1/dns-query\" cloudflared | time=\"2019-12-14T15:30:07+01:00\" level=info msg=\"Adding DNS upstream\" url=\"https://1.0.0.1/dns-query\" cloudflared | time=\"2019-12-14T15:30:07+01:00\" level=info msg=\"Starting metrics server\" addr=\"[::]:49312\" cloudflared | time=\"2019-12-14T15:30:07+01:00\" level=info msg=\"Starting DNS over HTTPS proxy server\" addr=\"dns://0.0.0.0:5053\" diun_1 | Sat, 14 Dec 2019 15:30:07 CET INF Starting Diun v2.0.0 diun_1 | Sat, 14 Dec 2019 15:30:07 CET INF Found 1 image(s) to analyze provider=docker diun_1 | Sat, 14 Dec 2019 15:30:10 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:latest provider=docker diun_1 | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.9.0 provider=docker diun_1 | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.9.1 provider=docker diun_1 | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.9.2 provider=docker diun_1 | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.10.1 provider=docker diun_1 | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.10.4 provider=docker diun_1 | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.10.2 provider=docker diun_1 | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.11.0 provider=docker diun_1 | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.11.3 provider=docker diun_1 | Sat, 14 Dec 2019 15:30:13 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.11.2 provider=docker diun_1 | Sat, 14 Dec 2019 15:30:13 CET INF Cron initialized with schedule 0 */6 * * * diun_1 | Sat, 14 Dec 2019 15:30:13 CET INF Next run in 2 hours 29 minutes (2019-12-14 16:00:00 +0100 CET)","title":"Quick start"},{"location":"providers/docker/#configuration","text":"Hint Environment variable DIUN_PROVIDERS_DOCKER=true can be used to enable this provider with default values.","title":"Configuration"},{"location":"providers/docker/#endpoint","text":"Server address to connect to. Local if empty. File providers : docker : endpoint : \"unix:///var/run/docker.sock\" Environment variables DIUN_PROVIDERS_DOCKER_ENDPOINT","title":"endpoint"},{"location":"providers/docker/#apiversion","text":"Overrides the client version with the specified one. File providers : docker : apiVersion : \"1.39\" Environment variables DIUN_PROVIDERS_DOCKER_APIVERSION","title":"apiVersion"},{"location":"providers/docker/#tlscertspath","text":"Path to load the TLS certificates from. File providers : docker : tlsCertsPath : \"/certs/\" Environment variables DIUN_PROVIDERS_DOCKER_TLSCERTSPATH","title":"tlsCertsPath"},{"location":"providers/docker/#tlsverify","text":"Controls whether client verifies the server's certificate chain and hostname (default true ). File providers : docker : tlsVerify : true Environment variables DIUN_PROVIDERS_DOCKER_TLSVERIFY","title":"tlsVerify"},{"location":"providers/docker/#watchbydefault","text":"Enable watch by default. If false, containers that don't have diun.enable=true label will be ignored (default false ). File providers : docker : watchByDefault : false Environment variables DIUN_PROVIDERS_DOCKER_WATCHBYDEFAULT","title":"watchByDefault"},{"location":"providers/docker/#watchstopped","text":"Include created and exited containers too (default false ). File providers : docker : watchStopped : false Environment variables DIUN_PROVIDERS_DOCKER_WATCHSTOPPED","title":"watchStopped"},{"location":"providers/docker/#docker-labels","text":"You can configure more finely the way to analyze the image of your container through Docker labels: Name Default Description diun.enable Set to true to enable image analysis of this container diun.regopt Registry options name to use diun.watch_repo false Watch all tags of this container image ( be careful with this setting) diun.notify_on new;update Semicolon separated list of status to be notified: new , update . diun.max_tags 0 Maximum number of tags to watch if diun.watch_repo enabled. 0 means all of them diun.include_tags Semicolon separated list of regular expressions to include tags. Can be useful if you enable diun.watch_repo diun.exclude_tags Semicolon separated list of regular expressions to exclude tags. Can be useful if you enable diun.watch_repo diun.platform automatic Platform to use (e.g. linux/amd64 )","title":"Docker labels"},{"location":"providers/dockerfile/","text":"Dockerfile provider \u00b6 About \u00b6 The Dockerfile provider allows to parse a Dockerfile and extract images for the following instructions: FROM <image> COPY --from=<image> RUN --mount=type=bind,from=<image> Quick start \u00b6 First you have to register the dockerfile provider: db : path : diun.db watch : workers : 20 schedule : \"0 */6 * * *\" regopts : - name : \"docker.io\" selector : image username : foo password : bar providers : dockerfile : patterns : - ./Dockerfile # syntax=docker/dockerfile:1.2 # diun.platform=linux/amd64 FROM alpine:latest # diun.watch_repo=true # diun.max_tags=10 # diun.platform=linux/amd64 COPY --from = crazymax/yasu / / # diun.watch_repo=true # diun.include_tags=^\\d+\\.\\d+\\.\\d+$ # diun.platform=linux/amd64 RUN --mount = type = bind,target = .,rw \\ --mount = type = bind,from = crazymax/docker:20.10.6,source = /usr/local/bin/docker,target = /usr/bin/docker \\ yasu --version With this Dockerfile the following images will be analyzed: alpine:latest tag ( linux/amd64 platform) Most recent 10 tags for crazymax/yasu image ( linux/amd64 platform) crazymax/docker tags matching ^\\d+\\.\\d+\\.\\d+$ ( linux/amd64 platform) Now let's start Diun: $ diun serve --config /etc/diun/diun.yml Thu, 29 Apr 2021 14:41:55 CEST INF Starting Diun version=4.16.0 Thu, 29 Apr 2021 14:41:55 CEST INF Configuration loaded from file: /etc/diun/diun.yml Thu, 29 Apr 2021 14:41:55 CEST WRN No notifier available Thu, 29 Apr 2021 14:41:55 CEST INF Cron triggered Thu, 29 Apr 2021 14:41:55 CEST INF Found 3 image(s) to analyze provider=dockerfile Thu, 29 Apr 2021 14:41:59 CEST INF New image found image=docker.io/library/alpine:latest provider=dockerfile Thu, 29 Apr 2021 14:41:59 CEST INF New image found image=docker.io/crazymax/yasu:latest provider=dockerfile Thu, 29 Apr 2021 14:42:00 CEST INF New image found image=docker.io/crazymax/yasu:1.14.1 provider=dockerfile Thu, 29 Apr 2021 14:42:00 CEST INF New image found image=docker.io/crazymax/docker:20.10.6 provider=dockerfile Thu, 29 Apr 2021 14:42:00 CEST INF New image found image=docker.io/crazymax/yasu:edge provider=dockerfile Thu, 29 Apr 2021 14:42:01 CEST INF New image found image=docker.io/crazymax/yasu:1.14.0 provider=dockerfile Thu, 29 Apr 2021 14:42:02 CEST INF New image found image=docker.io/crazymax/docker:20.10.5 provider=dockerfile Thu, 29 Apr 2021 14:42:02 CEST INF New image found image=docker.io/crazymax/docker:20.10.4 provider=dockerfile Thu, 29 Apr 2021 14:42:02 CEST INF New image found image=docker.io/crazymax/docker:20.10.3 provider=dockerfile Thu, 29 Apr 2021 14:42:02 CEST INF New image found image=docker.io/crazymax/docker:20.10.2 provider=dockerfile Thu, 29 Apr 2021 14:42:03 CEST INF New image found image=docker.io/crazymax/docker:20.10.1 provider=dockerfile Thu, 29 Apr 2021 14:42:03 CEST INF New image found image=docker.io/crazymax/docker:19.03.15 provider=dockerfile Thu, 29 Apr 2021 14:42:04 CEST INF New image found image=docker.io/crazymax/docker:19.03.14 provider=dockerfile Thu, 29 Apr 2021 14:42:04 CEST INF Jobs completed added=13 failed=0 skipped=0 unchanged=0 updated=0 Thu, 29 Apr 2021 14:42:05 CEST INF Cron initialized with schedule 0 */6 * * * Thu, 29 Apr 2021 14:42:05 CEST INF Next run in 3 hours (2021-04-29 18:00:00 +0200 CEST) Configuration \u00b6 patterns \u00b6 List of path patterns with matching and globbing supporting patterns . File providers : dockerfile : patterns : - \"**/Dockerfile*\" Environment variables DIUN_PROVIDERS_DOCKERFILE_PATTERNS (comma separated) Annotations \u00b6 The following annotations can be added as comments before the target instruction to customize the image analysis: Name Default Description diun.regopt Registry options name to use diun.watch_repo false Watch all tags of this image diun.notify_on new;update Semicolon separated list of status to be notified: new , update . diun.max_tags 0 Maximum number of tags to watch if watch_repo enabled. 0 means all of them diun.include_tags Semicolon separated list of regular expressions to include tags. Can be useful if you enable diun.watch_repo diun.exclude_tags Semicolon separated list of regular expressions to exclude tags. Can be useful if you enable diun.watch_repo diun.platform automatic Platform to use (e.g. linux/amd64 )","title":"Dockerfile"},{"location":"providers/dockerfile/#dockerfile-provider","text":"","title":"Dockerfile provider"},{"location":"providers/dockerfile/#about","text":"The Dockerfile provider allows to parse a Dockerfile and extract images for the following instructions: FROM <image> COPY --from=<image> RUN --mount=type=bind,from=<image>","title":"About"},{"location":"providers/dockerfile/#quick-start","text":"First you have to register the dockerfile provider: db : path : diun.db watch : workers : 20 schedule : \"0 */6 * * *\" regopts : - name : \"docker.io\" selector : image username : foo password : bar providers : dockerfile : patterns : - ./Dockerfile # syntax=docker/dockerfile:1.2 # diun.platform=linux/amd64 FROM alpine:latest # diun.watch_repo=true # diun.max_tags=10 # diun.platform=linux/amd64 COPY --from = crazymax/yasu / / # diun.watch_repo=true # diun.include_tags=^\\d+\\.\\d+\\.\\d+$ # diun.platform=linux/amd64 RUN --mount = type = bind,target = .,rw \\ --mount = type = bind,from = crazymax/docker:20.10.6,source = /usr/local/bin/docker,target = /usr/bin/docker \\ yasu --version With this Dockerfile the following images will be analyzed: alpine:latest tag ( linux/amd64 platform) Most recent 10 tags for crazymax/yasu image ( linux/amd64 platform) crazymax/docker tags matching ^\\d+\\.\\d+\\.\\d+$ ( linux/amd64 platform) Now let's start Diun: $ diun serve --config /etc/diun/diun.yml Thu, 29 Apr 2021 14:41:55 CEST INF Starting Diun version=4.16.0 Thu, 29 Apr 2021 14:41:55 CEST INF Configuration loaded from file: /etc/diun/diun.yml Thu, 29 Apr 2021 14:41:55 CEST WRN No notifier available Thu, 29 Apr 2021 14:41:55 CEST INF Cron triggered Thu, 29 Apr 2021 14:41:55 CEST INF Found 3 image(s) to analyze provider=dockerfile Thu, 29 Apr 2021 14:41:59 CEST INF New image found image=docker.io/library/alpine:latest provider=dockerfile Thu, 29 Apr 2021 14:41:59 CEST INF New image found image=docker.io/crazymax/yasu:latest provider=dockerfile Thu, 29 Apr 2021 14:42:00 CEST INF New image found image=docker.io/crazymax/yasu:1.14.1 provider=dockerfile Thu, 29 Apr 2021 14:42:00 CEST INF New image found image=docker.io/crazymax/docker:20.10.6 provider=dockerfile Thu, 29 Apr 2021 14:42:00 CEST INF New image found image=docker.io/crazymax/yasu:edge provider=dockerfile Thu, 29 Apr 2021 14:42:01 CEST INF New image found image=docker.io/crazymax/yasu:1.14.0 provider=dockerfile Thu, 29 Apr 2021 14:42:02 CEST INF New image found image=docker.io/crazymax/docker:20.10.5 provider=dockerfile Thu, 29 Apr 2021 14:42:02 CEST INF New image found image=docker.io/crazymax/docker:20.10.4 provider=dockerfile Thu, 29 Apr 2021 14:42:02 CEST INF New image found image=docker.io/crazymax/docker:20.10.3 provider=dockerfile Thu, 29 Apr 2021 14:42:02 CEST INF New image found image=docker.io/crazymax/docker:20.10.2 provider=dockerfile Thu, 29 Apr 2021 14:42:03 CEST INF New image found image=docker.io/crazymax/docker:20.10.1 provider=dockerfile Thu, 29 Apr 2021 14:42:03 CEST INF New image found image=docker.io/crazymax/docker:19.03.15 provider=dockerfile Thu, 29 Apr 2021 14:42:04 CEST INF New image found image=docker.io/crazymax/docker:19.03.14 provider=dockerfile Thu, 29 Apr 2021 14:42:04 CEST INF Jobs completed added=13 failed=0 skipped=0 unchanged=0 updated=0 Thu, 29 Apr 2021 14:42:05 CEST INF Cron initialized with schedule 0 */6 * * * Thu, 29 Apr 2021 14:42:05 CEST INF Next run in 3 hours (2021-04-29 18:00:00 +0200 CEST)","title":"Quick start"},{"location":"providers/dockerfile/#configuration","text":"","title":"Configuration"},{"location":"providers/dockerfile/#patterns","text":"List of path patterns with matching and globbing supporting patterns . File providers : dockerfile : patterns : - \"**/Dockerfile*\" Environment variables DIUN_PROVIDERS_DOCKERFILE_PATTERNS (comma separated)","title":"patterns"},{"location":"providers/dockerfile/#annotations","text":"The following annotations can be added as comments before the target instruction to customize the image analysis: Name Default Description diun.regopt Registry options name to use diun.watch_repo false Watch all tags of this image diun.notify_on new;update Semicolon separated list of status to be notified: new , update . diun.max_tags 0 Maximum number of tags to watch if watch_repo enabled. 0 means all of them diun.include_tags Semicolon separated list of regular expressions to include tags. Can be useful if you enable diun.watch_repo diun.exclude_tags Semicolon separated list of regular expressions to exclude tags. Can be useful if you enable diun.watch_repo diun.platform automatic Platform to use (e.g. linux/amd64 )","title":"Annotations"},{"location":"providers/file/","text":"File provider \u00b6 About \u00b6 The file provider lets you define Docker images to analyze through a YAML file or a directory. Example \u00b6 Register the file provider: db : path : diun.db watch : workers : 20 schedule : \"0 */6 * * *\" regopts : - name : \"myregistry\" username : fii password : bor timeout : 5s - name : \"docker.io/crazymax\" selector : image username : fii password : bor - name : \"docker.io\" selector : image username : foo password : bar providers : file : filename : /path/to/config.yml ### /path/to/config.yml # Watch latest tag of crazymax/nextcloud image on docker.io (DockerHub) # with registry options named 'docker.io/crazymax' (image selector). - name : docker.io/crazymax/nextcloud:latest # Watch 4.0.0 tag of jfrog/artifactory-oss image on frog-docker-reg2.bintray.io (Bintray) # with registry options named 'myregistry' (name selector). - name : jfrog-docker-reg2.bintray.io/jfrog/artifactory-oss:4.0.0 regopt : myregistry # Watch coreos/hyperkube image on quay.io (Quay) and assume latest tag. - name : quay.io/coreos/hyperkube # Watch crazymax/swarm-cronjob image and assume docker.io registry and latest tag # with registry options named 'docker.io/crazymax' (image selector). # Only include tags matching regexp ^1\\.2\\..* and only be notified on new tag. - name : crazymax/swarm-cronjob watch_repo : true notify_on : - new include_tags : - ^1\\.2\\..* # Watch portainer/portainer image on docker.io (DockerHub) and assume latest tag # with registry options named 'docker.io' (image selector). # Only watch latest 10 tags and include tags matching regexp ^\\d+\\.\\d+\\..* - name : docker.io/portainer/portainer watch_repo : true max_tags : 10 include_tags : - ^\\d+\\.\\d+\\..* # Watch alpine image (library) and assume docker.io registry and latest tag # with registry options named 'docker.io' (image selector). # Force linux/arm64/v8 platform for this image - name : alpine watch_repo : true platform : os : linux arch : arm64 variant : v8 Quick start \u00b6 Let's take a look with a simple example: db : path : diun.db watch : workers : 20 schedule : \"0 */6 * * *\" regopts : - name : \"docker.bintray.io\" selector : image username : foo password : bar providers : file : filename : /path/to/config.yml # /path/to/config.yml - name : crazymax/cloudflared watch_repo : true - name : docker.bintray.io/jfrog/xray-mongo:3.2.6 Here we want to analyze all tags of crazymax/cloudflared and docker.bintray.io/jfrog/xray-mongo:3.2.6 tag. Now let's start Diun: $ diun serve --config diun.yml Sat, 14 Dec 2019 15:32:23 UTC INF Starting Diun 2.0.0 Sat, 14 Dec 2019 15:32:23 UTC INF Found 2 image(s) to analyze... provider=file Sat, 14 Dec 2019 15:32:25 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:latest provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.11.3 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.11.0 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.10.1 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.9.0 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.9.2 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.10.2 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.11.2 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.9.1 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.10.4 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=docker.bintray.io/jfrog/xray-mongo:3.2.6 image=docker.bintray.io/jfrog/xray-mongo:3.2.6 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF Cron initialized with schedule 0 */6 * * * Sat, 14 Dec 2019 15:32:28 UTC INF Next run in 31 seconds (2019-12-14 15:33:00 +0000 UTC) Configuration \u00b6 filename \u00b6 Defines the path to the configuration file . Warning filename and directory are mutually exclusive File providers : file : filename : /path/to/config/conf.yml Environment variables DIUN_PROVIDERS_FILE_FILENAME directory \u00b6 Defines the path to the directory that contains the configuration files ( *.yml or *.yaml ). Warning filename and directory are mutually exclusive File providers : file : directory : /path/to/config Environment variables DIUN_PROVIDERS_FILE_DIRECTORY YAML configuration file \u00b6 The configuration file(s) defines a slice of images to analyze with the following fields: Name Default Description name latest Docker image name to watch using registry/path:tag format. If registry omitted, docker.io will be used and if tag omitted, latest will be used regopt Registry options name to use watch_repo false Watch all tags of this image ( be careful with this setting) notify_on new;update Semicolon separated list of status to be notified: new , update . max_tags 0 Maximum number of tags to watch if watch_repo enabled. 0 means all of them include_tags List of regular expressions to include tags. Can be useful if you enable watch_repo exclude_tags List of regular expressions to exclude tags. Can be useful if you enable watch_repo platform.os automatic Operating system to use as custom platform platform.arch automatic CPU architecture to use as custom platform platform.variant automatic Variant of the CPU to use as custom platform","title":"File"},{"location":"providers/file/#file-provider","text":"","title":"File provider"},{"location":"providers/file/#about","text":"The file provider lets you define Docker images to analyze through a YAML file or a directory.","title":"About"},{"location":"providers/file/#example","text":"Register the file provider: db : path : diun.db watch : workers : 20 schedule : \"0 */6 * * *\" regopts : - name : \"myregistry\" username : fii password : bor timeout : 5s - name : \"docker.io/crazymax\" selector : image username : fii password : bor - name : \"docker.io\" selector : image username : foo password : bar providers : file : filename : /path/to/config.yml ### /path/to/config.yml # Watch latest tag of crazymax/nextcloud image on docker.io (DockerHub) # with registry options named 'docker.io/crazymax' (image selector). - name : docker.io/crazymax/nextcloud:latest # Watch 4.0.0 tag of jfrog/artifactory-oss image on frog-docker-reg2.bintray.io (Bintray) # with registry options named 'myregistry' (name selector). - name : jfrog-docker-reg2.bintray.io/jfrog/artifactory-oss:4.0.0 regopt : myregistry # Watch coreos/hyperkube image on quay.io (Quay) and assume latest tag. - name : quay.io/coreos/hyperkube # Watch crazymax/swarm-cronjob image and assume docker.io registry and latest tag # with registry options named 'docker.io/crazymax' (image selector). # Only include tags matching regexp ^1\\.2\\..* and only be notified on new tag. - name : crazymax/swarm-cronjob watch_repo : true notify_on : - new include_tags : - ^1\\.2\\..* # Watch portainer/portainer image on docker.io (DockerHub) and assume latest tag # with registry options named 'docker.io' (image selector). # Only watch latest 10 tags and include tags matching regexp ^\\d+\\.\\d+\\..* - name : docker.io/portainer/portainer watch_repo : true max_tags : 10 include_tags : - ^\\d+\\.\\d+\\..* # Watch alpine image (library) and assume docker.io registry and latest tag # with registry options named 'docker.io' (image selector). # Force linux/arm64/v8 platform for this image - name : alpine watch_repo : true platform : os : linux arch : arm64 variant : v8","title":"Example"},{"location":"providers/file/#quick-start","text":"Let's take a look with a simple example: db : path : diun.db watch : workers : 20 schedule : \"0 */6 * * *\" regopts : - name : \"docker.bintray.io\" selector : image username : foo password : bar providers : file : filename : /path/to/config.yml # /path/to/config.yml - name : crazymax/cloudflared watch_repo : true - name : docker.bintray.io/jfrog/xray-mongo:3.2.6 Here we want to analyze all tags of crazymax/cloudflared and docker.bintray.io/jfrog/xray-mongo:3.2.6 tag. Now let's start Diun: $ diun serve --config diun.yml Sat, 14 Dec 2019 15:32:23 UTC INF Starting Diun 2.0.0 Sat, 14 Dec 2019 15:32:23 UTC INF Found 2 image(s) to analyze... provider=file Sat, 14 Dec 2019 15:32:25 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:latest provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.11.3 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.11.0 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.10.1 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.9.0 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.9.2 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.10.2 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.11.2 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.9.1 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.10.4 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF New image found id=docker.bintray.io/jfrog/xray-mongo:3.2.6 image=docker.bintray.io/jfrog/xray-mongo:3.2.6 provider=file Sat, 14 Dec 2019 15:32:28 UTC INF Cron initialized with schedule 0 */6 * * * Sat, 14 Dec 2019 15:32:28 UTC INF Next run in 31 seconds (2019-12-14 15:33:00 +0000 UTC)","title":"Quick start"},{"location":"providers/file/#configuration","text":"","title":"Configuration"},{"location":"providers/file/#filename","text":"Defines the path to the configuration file . Warning filename and directory are mutually exclusive File providers : file : filename : /path/to/config/conf.yml Environment variables DIUN_PROVIDERS_FILE_FILENAME","title":"filename"},{"location":"providers/file/#directory","text":"Defines the path to the directory that contains the configuration files ( *.yml or *.yaml ). Warning filename and directory are mutually exclusive File providers : file : directory : /path/to/config Environment variables DIUN_PROVIDERS_FILE_DIRECTORY","title":"directory"},{"location":"providers/file/#yaml-configuration-file","text":"The configuration file(s) defines a slice of images to analyze with the following fields: Name Default Description name latest Docker image name to watch using registry/path:tag format. If registry omitted, docker.io will be used and if tag omitted, latest will be used regopt Registry options name to use watch_repo false Watch all tags of this image ( be careful with this setting) notify_on new;update Semicolon separated list of status to be notified: new , update . max_tags 0 Maximum number of tags to watch if watch_repo enabled. 0 means all of them include_tags List of regular expressions to include tags. Can be useful if you enable watch_repo exclude_tags List of regular expressions to exclude tags. Can be useful if you enable watch_repo platform.os automatic Operating system to use as custom platform platform.arch automatic CPU architecture to use as custom platform platform.variant automatic Variant of the CPU to use as custom platform","title":"YAML configuration file"},{"location":"providers/kubernetes/","text":"Kubernetes provider \u00b6 About \u00b6 The Kubernetes provider allows you to analyze the pods of your Kubernetes cluster to extract images found and check for updates on the registry. Quick start \u00b6 In this section we quickly go over a basic deployment using your local Kubernetes cluster. Here we use our local Kubernetes provider with a minimum configuration to analyze annotated pods (watch by default disabled). Now let's create a simple pod for Diun: apiVersion : v1 kind : ServiceAccount metadata : namespace : default name : diun --- apiVersion : rbac.authorization.k8s.io/v1 kind : ClusterRole metadata : name : diun rules : - apiGroups : - \"\" resources : - pods verbs : - get - watch - list --- apiVersion : rbac.authorization.k8s.io/v1 kind : ClusterRoleBinding metadata : name : diun roleRef : apiGroup : rbac.authorization.k8s.io kind : ClusterRole name : diun subjects : - kind : ServiceAccount name : diun namespace : default --- apiVersion : apps/v1 kind : Deployment metadata : namespace : default name : diun spec : replicas : 1 selector : matchLabels : app : diun template : metadata : labels : app : diun annotations : diun.enable : \"true\" spec : serviceAccountName : diun containers : - name : diun image : crazymax/diun:latest imagePullPolicy : Always args : [ \"serve\" ] env : - name : TZ value : \"Europe/Paris\" - name : LOG_LEVEL value : \"info\" - name : LOG_JSON value : \"false\" - name : DIUN_WATCH_WORKERS value : \"20\" - name : DIUN_WATCH_SCHEDULE value : \"0 */6 * * *\" - name : DIUN_PROVIDERS_KUBERNETES value : \"true\" volumeMounts : - mountPath : \"/data\" name : \"data\" restartPolicy : Always volumes : # Set up a data directory for diun # For production usage, you should consider using PV/PVC instead(or simply using storage like NAS) # For more details, please see https://kubernetes.io/docs/concepts/storage/volumes/ - name : \"data\" hostPath : path : \"/data\" type : Directory And another one with a simple Nginx pod: apiVersion : apps/v1 kind : Deployment metadata : namespace : default name : nginx spec : selector : matchLabels : run : nginx replicas : 2 template : metadata : labels : run : nginx annotations : diun.enable : \"true\" spec : containers : - name : nginx image : nginx ports : - containerPort : 80 As an example we use nginx Docker image. A few annotations are added to configure the image analysis of this pod for Diun. We can now start these 2 pods: kubectl apply -f diun.yml kubectl apply -f nginx.yml Now take a look at the logs: $ kubectl logs -f -l app=diun --all-containers Wed, 17 Jun 2020 10:49:58 CEST INF Starting Diun version=4.0.0-beta.3 Wed, 17 Jun 2020 10:49:58 CEST WRN No notifier available Wed, 17 Jun 2020 10:49:58 CEST INF Cron triggered Wed, 17 Jun 2020 10:49:59 CEST INF Found 1 image(s) to analyze provider=kubernetes Wed, 17 Jun 2020 10:50:00 CEST INF New image found image=docker.io/library/nginx:latest provider=kubernetes Wed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9 provider=kubernetes Wed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9.5 provider=kubernetes Wed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9.7 provider=kubernetes Wed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9.9 provider=kubernetes Wed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9.4 provider=kubernetes Wed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9.6 provider=kubernetes Wed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9.8 provider=kubernetes Wed, 17 Jun 2020 10:50:03 CEST INF New image found image=docker.io/library/nginx:stable provider=kubernetes Wed, 17 Jun 2020 10:50:03 CEST INF New image found image=docker.io/library/nginx:stable-alpine provider=kubernetes Wed, 17 Jun 2020 10:50:03 CEST INF New image found image=docker.io/library/nginx:perl provider=kubernetes ... Configuration \u00b6 Hint Environment variable DIUN_PROVIDERS_KUBERNETES=true can be used to enable this provider with default values. endpoint \u00b6 The Kubernetes server endpoint as URL. File providers : kubernetes : endpoint : \"http://localhost:8080\" Environment variables DIUN_PROVIDERS_KUBERNETES_ENDPOINT Kubernetes server endpoint as URL, which is only used when the behavior based on environment variables described below does not apply. When deployed into Kubernetes, Diun reads the environment variables KUBERNETES_SERVICE_HOST and KUBERNETES_SERVICE_PORT or KUBECONFIG to create the endpoint. The access token is looked up in /var/run/secrets/kubernetes.io/serviceaccount/token and the SSL CA certificate in /var/run/secrets/kubernetes.io/serviceaccount/ca.crt . They are both provided automatically as mounts in the pod where Diun is deployed. When the environment variables are not found, Diun tries to connect to the Kubernetes API server with an external-cluster client. In which case, the endpoint is required. Specifically, it may be set to the URL used by kubectl proxy to connect to a Kubernetes cluster using the granted authentication and authorization of the associated kubeconfig. token \u00b6 Bearer token used for the Kubernetes client configuration. File providers : kubernetes : token : \"atoken\" Environment variables DIUN_PROVIDERS_KUBERNETES_TOKEN tokenFile \u00b6 Use content of secret file as bearer token if token not defined. File providers : kubernetes : tokenFile : \"/run/secrets/token\" Environment variables DIUN_PROVIDERS_KUBERNETES_TOKEN certAuthFilePath \u00b6 Path to the certificate authority file. Used for the Kubernetes client configuration. File providers : kubernetes : certAuthFilePath : \"/a/ca.crt\" Environment variables DIUN_PROVIDERS_KUBERNETES_CERTAUTHFILEPATH tlsInsecure \u00b6 Controls whether client does not verify the server's certificate chain and hostname (default false ). File providers : kubernetes : tlsInsecure : false Environment variables DIUN_PROVIDERS_KUBERNETES_TLSINSECURE namespaces \u00b6 Array of namespaces to watch (default all namespaces). File providers : kubernetes : namespaces : - default - production Environment variables DIUN_PROVIDERS_KUBERNETES_NAMESPACES (comma separated) watchByDefault \u00b6 Enable watch by default. If false, pods that don't have diun.enable: \"true\" annotation will be ignored (default false ). File providers : kubernetes : watchByDefault : false Environment variables DIUN_PROVIDERS_KUBERNETES_WATCHBYDEFAULT Kubernetes annotations \u00b6 You can configure more finely the way to analyze the image of your pods through Kubernetes annotations: Name Default Description diun.enable Set to true to enable image analysis of this pod diun.regopt Registry options name to use diun.watch_repo false Watch all tags of this pod image ( be careful with this setting) diun.notify_on new;update Semicolon separated list of status to be notified: new , update . diun.max_tags 0 Maximum number of tags to watch if diun.watch_repo enabled. 0 means all of them diun.include_tags Semicolon separated list of regular expressions to include tags. Can be useful if you enable diun.watch_repo diun.exclude_tags Semicolon separated list of regular expressions to exclude tags. Can be useful if you enable diun.watch_repo diun.platform automatic Platform to use (e.g. linux/amd64 )","title":"Kubernetes"},{"location":"providers/kubernetes/#kubernetes-provider","text":"","title":"Kubernetes provider"},{"location":"providers/kubernetes/#about","text":"The Kubernetes provider allows you to analyze the pods of your Kubernetes cluster to extract images found and check for updates on the registry.","title":"About"},{"location":"providers/kubernetes/#quick-start","text":"In this section we quickly go over a basic deployment using your local Kubernetes cluster. Here we use our local Kubernetes provider with a minimum configuration to analyze annotated pods (watch by default disabled). Now let's create a simple pod for Diun: apiVersion : v1 kind : ServiceAccount metadata : namespace : default name : diun --- apiVersion : rbac.authorization.k8s.io/v1 kind : ClusterRole metadata : name : diun rules : - apiGroups : - \"\" resources : - pods verbs : - get - watch - list --- apiVersion : rbac.authorization.k8s.io/v1 kind : ClusterRoleBinding metadata : name : diun roleRef : apiGroup : rbac.authorization.k8s.io kind : ClusterRole name : diun subjects : - kind : ServiceAccount name : diun namespace : default --- apiVersion : apps/v1 kind : Deployment metadata : namespace : default name : diun spec : replicas : 1 selector : matchLabels : app : diun template : metadata : labels : app : diun annotations : diun.enable : \"true\" spec : serviceAccountName : diun containers : - name : diun image : crazymax/diun:latest imagePullPolicy : Always args : [ \"serve\" ] env : - name : TZ value : \"Europe/Paris\" - name : LOG_LEVEL value : \"info\" - name : LOG_JSON value : \"false\" - name : DIUN_WATCH_WORKERS value : \"20\" - name : DIUN_WATCH_SCHEDULE value : \"0 */6 * * *\" - name : DIUN_PROVIDERS_KUBERNETES value : \"true\" volumeMounts : - mountPath : \"/data\" name : \"data\" restartPolicy : Always volumes : # Set up a data directory for diun # For production usage, you should consider using PV/PVC instead(or simply using storage like NAS) # For more details, please see https://kubernetes.io/docs/concepts/storage/volumes/ - name : \"data\" hostPath : path : \"/data\" type : Directory And another one with a simple Nginx pod: apiVersion : apps/v1 kind : Deployment metadata : namespace : default name : nginx spec : selector : matchLabels : run : nginx replicas : 2 template : metadata : labels : run : nginx annotations : diun.enable : \"true\" spec : containers : - name : nginx image : nginx ports : - containerPort : 80 As an example we use nginx Docker image. A few annotations are added to configure the image analysis of this pod for Diun. We can now start these 2 pods: kubectl apply -f diun.yml kubectl apply -f nginx.yml Now take a look at the logs: $ kubectl logs -f -l app=diun --all-containers Wed, 17 Jun 2020 10:49:58 CEST INF Starting Diun version=4.0.0-beta.3 Wed, 17 Jun 2020 10:49:58 CEST WRN No notifier available Wed, 17 Jun 2020 10:49:58 CEST INF Cron triggered Wed, 17 Jun 2020 10:49:59 CEST INF Found 1 image(s) to analyze provider=kubernetes Wed, 17 Jun 2020 10:50:00 CEST INF New image found image=docker.io/library/nginx:latest provider=kubernetes Wed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9 provider=kubernetes Wed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9.5 provider=kubernetes Wed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9.7 provider=kubernetes Wed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9.9 provider=kubernetes Wed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9.4 provider=kubernetes Wed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9.6 provider=kubernetes Wed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9.8 provider=kubernetes Wed, 17 Jun 2020 10:50:03 CEST INF New image found image=docker.io/library/nginx:stable provider=kubernetes Wed, 17 Jun 2020 10:50:03 CEST INF New image found image=docker.io/library/nginx:stable-alpine provider=kubernetes Wed, 17 Jun 2020 10:50:03 CEST INF New image found image=docker.io/library/nginx:perl provider=kubernetes ...","title":"Quick start"},{"location":"providers/kubernetes/#configuration","text":"Hint Environment variable DIUN_PROVIDERS_KUBERNETES=true can be used to enable this provider with default values.","title":"Configuration"},{"location":"providers/kubernetes/#endpoint","text":"The Kubernetes server endpoint as URL. File providers : kubernetes : endpoint : \"http://localhost:8080\" Environment variables DIUN_PROVIDERS_KUBERNETES_ENDPOINT Kubernetes server endpoint as URL, which is only used when the behavior based on environment variables described below does not apply. When deployed into Kubernetes, Diun reads the environment variables KUBERNETES_SERVICE_HOST and KUBERNETES_SERVICE_PORT or KUBECONFIG to create the endpoint. The access token is looked up in /var/run/secrets/kubernetes.io/serviceaccount/token and the SSL CA certificate in /var/run/secrets/kubernetes.io/serviceaccount/ca.crt . They are both provided automatically as mounts in the pod where Diun is deployed. When the environment variables are not found, Diun tries to connect to the Kubernetes API server with an external-cluster client. In which case, the endpoint is required. Specifically, it may be set to the URL used by kubectl proxy to connect to a Kubernetes cluster using the granted authentication and authorization of the associated kubeconfig.","title":"endpoint"},{"location":"providers/kubernetes/#token","text":"Bearer token used for the Kubernetes client configuration. File providers : kubernetes : token : \"atoken\" Environment variables DIUN_PROVIDERS_KUBERNETES_TOKEN","title":"token"},{"location":"providers/kubernetes/#tokenfile","text":"Use content of secret file as bearer token if token not defined. File providers : kubernetes : tokenFile : \"/run/secrets/token\" Environment variables DIUN_PROVIDERS_KUBERNETES_TOKEN","title":"tokenFile"},{"location":"providers/kubernetes/#certauthfilepath","text":"Path to the certificate authority file. Used for the Kubernetes client configuration. File providers : kubernetes : certAuthFilePath : \"/a/ca.crt\" Environment variables DIUN_PROVIDERS_KUBERNETES_CERTAUTHFILEPATH","title":"certAuthFilePath"},{"location":"providers/kubernetes/#tlsinsecure","text":"Controls whether client does not verify the server's certificate chain and hostname (default false ). File providers : kubernetes : tlsInsecure : false Environment variables DIUN_PROVIDERS_KUBERNETES_TLSINSECURE","title":"tlsInsecure"},{"location":"providers/kubernetes/#namespaces","text":"Array of namespaces to watch (default all namespaces). File providers : kubernetes : namespaces : - default - production Environment variables DIUN_PROVIDERS_KUBERNETES_NAMESPACES (comma separated)","title":"namespaces"},{"location":"providers/kubernetes/#watchbydefault","text":"Enable watch by default. If false, pods that don't have diun.enable: \"true\" annotation will be ignored (default false ). File providers : kubernetes : watchByDefault : false Environment variables DIUN_PROVIDERS_KUBERNETES_WATCHBYDEFAULT","title":"watchByDefault"},{"location":"providers/kubernetes/#kubernetes-annotations","text":"You can configure more finely the way to analyze the image of your pods through Kubernetes annotations: Name Default Description diun.enable Set to true to enable image analysis of this pod diun.regopt Registry options name to use diun.watch_repo false Watch all tags of this pod image ( be careful with this setting) diun.notify_on new;update Semicolon separated list of status to be notified: new , update . diun.max_tags 0 Maximum number of tags to watch if diun.watch_repo enabled. 0 means all of them diun.include_tags Semicolon separated list of regular expressions to include tags. Can be useful if you enable diun.watch_repo diun.exclude_tags Semicolon separated list of regular expressions to exclude tags. Can be useful if you enable diun.watch_repo diun.platform automatic Platform to use (e.g. linux/amd64 )","title":"Kubernetes annotations"},{"location":"providers/swarm/","text":"Swarm provider \u00b6 About \u00b6 The Swarm provider allows you to analyze the services of your Swarm cluster to extract images found and check for updates on the registry. Quick start \u00b6 In this section we quickly go over a basic stack using your local swarm cluster. Here we use our local Swarm provider with a minimum configuration to analyze labeled containers (watch by default disabled). Now let's create a simple stack for Diun: version : \"3.5\" services : diun : image : crazymax/diun:latest command : serve volumes : - \"./data:/data\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"LOG_JSON=false\" - \"DIUN_WATCH_WORKERS=20\" - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\" - \"DIUN_PROVIDERS_SWARM=true\" deploy : mode : replicated replicas : 1 placement : constraints : - node.role == manager And another one with a simple service: version : \"3.5\" services : nginx : image : nginx ports : - target : 80 published : 80 protocol : udp deploy : mode : replicated replicas : 2 labels : - \"diun.enable=true\" As an example we use nginx Docker image. A few labels are added to configure the image analysis of this service for Diun. We can now start these 2 stacks: docker stack deploy -c diun.yml diun docker stack deploy -c nginx.yml nginx Now take a look at the logs: $ docker service logs -f diun_diun diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:19:57 CET INF Starting Diun dev diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:19:57 CET INF Starting Diun... diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:19:57 CET INF Found 1 image(s) to analyze provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:19:59 CET INF New image found id=myswarm image=docker.io/library/nginx:latest provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9 provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9.4 provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9.8 provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9.7 provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9.9 provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9.6 provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9.5 provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:mainline-alpine provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:alpine-perl provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:stable-perl provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:stable-alpine-perl provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:1 provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:perl provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:mainline-alpine-perl provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:stable provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:mainline-perl provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:mainline provider=swarm ... Configuration \u00b6 Hint Environment variable DIUN_PROVIDERS_SWARM=true can be used to enable this provider with default values. endpoint \u00b6 Server address to connect to. Local if empty. File providers : swarm : endpoint : \"unix:///var/run/docker.sock\" Environment variables DIUN_PROVIDERS_SWARM_ENDPOINT apiVersion \u00b6 Overrides the client version with the specified one. File providers : swarm : apiVersion : \"1.39\" Environment variables DIUN_PROVIDERS_SWARM_APIVERSION tlsCertsPath \u00b6 Path to load the TLS certificates from. File providers : swarm : tlsCertsPath : \"/certs/\" Environment variables DIUN_PROVIDERS_SWARM_TLSCERTSPATH tlsVerify \u00b6 Controls whether client verifies the server's certificate chain and hostname (default true ). File providers : swarm : tlsVerify : true Environment variables DIUN_PROVIDERS_SWARM_TLSVERIFY watchByDefault \u00b6 Enable watch by default. If false, services that don't have diun.enable=true label will be ignored (default false ). File providers : swarm : watchByDefault : false Environment variables DIUN_PROVIDERS_SWARM_WATCHBYDEFAULT Docker labels \u00b6 You can configure more finely the way to analyze the image of your service through Docker labels: Name Default Description diun.enable Set to true to enable image analysis of this service diun.regopt Registry options name to use diun.watch_repo false Watch all tags of this service image ( be careful with this setting) diun.notify_on new;update Semicolon separated list of status to be notified: new , update . diun.max_tags 0 Maximum number of tags to watch if diun.watch_repo enabled. 0 means all of them diun.include_tags Semicolon separated list of regular expressions to include tags. Can be useful if you enable diun.watch_repo diun.exclude_tags Semicolon separated list of regular expressions to exclude tags. Can be useful if you enable diun.watch_repo diun.platform automatic Platform to use (e.g. linux/amd64 )","title":"Swarm"},{"location":"providers/swarm/#swarm-provider","text":"","title":"Swarm provider"},{"location":"providers/swarm/#about","text":"The Swarm provider allows you to analyze the services of your Swarm cluster to extract images found and check for updates on the registry.","title":"About"},{"location":"providers/swarm/#quick-start","text":"In this section we quickly go over a basic stack using your local swarm cluster. Here we use our local Swarm provider with a minimum configuration to analyze labeled containers (watch by default disabled). Now let's create a simple stack for Diun: version : \"3.5\" services : diun : image : crazymax/diun:latest command : serve volumes : - \"./data:/data\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"LOG_JSON=false\" - \"DIUN_WATCH_WORKERS=20\" - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\" - \"DIUN_PROVIDERS_SWARM=true\" deploy : mode : replicated replicas : 1 placement : constraints : - node.role == manager And another one with a simple service: version : \"3.5\" services : nginx : image : nginx ports : - target : 80 published : 80 protocol : udp deploy : mode : replicated replicas : 2 labels : - \"diun.enable=true\" As an example we use nginx Docker image. A few labels are added to configure the image analysis of this service for Diun. We can now start these 2 stacks: docker stack deploy -c diun.yml diun docker stack deploy -c nginx.yml nginx Now take a look at the logs: $ docker service logs -f diun_diun diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:19:57 CET INF Starting Diun dev diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:19:57 CET INF Starting Diun... diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:19:57 CET INF Found 1 image(s) to analyze provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:19:59 CET INF New image found id=myswarm image=docker.io/library/nginx:latest provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9 provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9.4 provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9.8 provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9.7 provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9.9 provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9.6 provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9.5 provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:mainline-alpine provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:alpine-perl provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:stable-perl provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:stable-alpine-perl provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:1 provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:perl provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:mainline-alpine-perl provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:stable provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:mainline-perl provider=swarm diun_diun.1.i1l4yuiafq6y@docker-desktop | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:mainline provider=swarm ...","title":"Quick start"},{"location":"providers/swarm/#configuration","text":"Hint Environment variable DIUN_PROVIDERS_SWARM=true can be used to enable this provider with default values.","title":"Configuration"},{"location":"providers/swarm/#endpoint","text":"Server address to connect to. Local if empty. File providers : swarm : endpoint : \"unix:///var/run/docker.sock\" Environment variables DIUN_PROVIDERS_SWARM_ENDPOINT","title":"endpoint"},{"location":"providers/swarm/#apiversion","text":"Overrides the client version with the specified one. File providers : swarm : apiVersion : \"1.39\" Environment variables DIUN_PROVIDERS_SWARM_APIVERSION","title":"apiVersion"},{"location":"providers/swarm/#tlscertspath","text":"Path to load the TLS certificates from. File providers : swarm : tlsCertsPath : \"/certs/\" Environment variables DIUN_PROVIDERS_SWARM_TLSCERTSPATH","title":"tlsCertsPath"},{"location":"providers/swarm/#tlsverify","text":"Controls whether client verifies the server's certificate chain and hostname (default true ). File providers : swarm : tlsVerify : true Environment variables DIUN_PROVIDERS_SWARM_TLSVERIFY","title":"tlsVerify"},{"location":"providers/swarm/#watchbydefault","text":"Enable watch by default. If false, services that don't have diun.enable=true label will be ignored (default false ). File providers : swarm : watchByDefault : false Environment variables DIUN_PROVIDERS_SWARM_WATCHBYDEFAULT","title":"watchByDefault"},{"location":"providers/swarm/#docker-labels","text":"You can configure more finely the way to analyze the image of your service through Docker labels: Name Default Description diun.enable Set to true to enable image analysis of this service diun.regopt Registry options name to use diun.watch_repo false Watch all tags of this service image ( be careful with this setting) diun.notify_on new;update Semicolon separated list of status to be notified: new , update . diun.max_tags 0 Maximum number of tags to watch if diun.watch_repo enabled. 0 means all of them diun.include_tags Semicolon separated list of regular expressions to include tags. Can be useful if you enable diun.watch_repo diun.exclude_tags Semicolon separated list of regular expressions to exclude tags. Can be useful if you enable diun.watch_repo diun.platform automatic Platform to use (e.g. linux/amd64 )","title":"Docker labels"},{"location":"usage/basic-example/","text":"Basic example \u00b6 In this section we quickly go over a basic docker-compose file to run Diun using the docker provider. Setup \u00b6 Create a docker-compose.yml file that uses the official Diun image: version : \"3.5\" services : diun : image : crazymax/diun:latest container_name : diun command : serve volumes : - \"./data:/data\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"LOG_JSON=false\" - \"DIUN_WATCH_WORKERS=20\" - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\" - \"DIUN_PROVIDERS_DOCKER=true\" - \"DIUN_PROVIDERS_DOCKER_WATCHBYDEFAULT=true\" restart : always Here we use a minimal configuration to analyze all running containers (watch by default enabled) of your local Docker instance every 6 hours . That's it. Now you can launch Diun with the following command: docker-compose up -d If you prefer to rely on the configuration file instead of environment variables: version : \"3.5\" services : diun : image : crazymax/diun:latest container_name : diun command : serve volumes : - \"./data:/data\" - \"./diun.yml:/diun.yml:ro\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"LOG_JSON=false\" restart : always # ./diun.yml watch : workers : 20 schedule : \"0 */6 * * *\" firstCheckNotif : false providers : docker : watchByDefault : true","title":"Basic example"},{"location":"usage/basic-example/#basic-example","text":"In this section we quickly go over a basic docker-compose file to run Diun using the docker provider.","title":"Basic example"},{"location":"usage/basic-example/#setup","text":"Create a docker-compose.yml file that uses the official Diun image: version : \"3.5\" services : diun : image : crazymax/diun:latest container_name : diun command : serve volumes : - \"./data:/data\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"LOG_JSON=false\" - \"DIUN_WATCH_WORKERS=20\" - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\" - \"DIUN_PROVIDERS_DOCKER=true\" - \"DIUN_PROVIDERS_DOCKER_WATCHBYDEFAULT=true\" restart : always Here we use a minimal configuration to analyze all running containers (watch by default enabled) of your local Docker instance every 6 hours . That's it. Now you can launch Diun with the following command: docker-compose up -d If you prefer to rely on the configuration file instead of environment variables: version : \"3.5\" services : diun : image : crazymax/diun:latest container_name : diun command : serve volumes : - \"./data:/data\" - \"./diun.yml:/diun.yml:ro\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"LOG_JSON=false\" restart : always # ./diun.yml watch : workers : 20 schedule : \"0 */6 * * *\" firstCheckNotif : false providers : docker : watchByDefault : true","title":"Setup"},{"location":"usage/command-line/","text":"Command Line \u00b6 Usage \u00b6 diun [ global options ] command [ command or global options ] [ arguments... ] Global options \u00b6 All global options can be placed at the command level. --help , -h : Show context-sensitive help. --version : Show version and exit. Commands \u00b6 serve \u00b6 Starts Diun server. --config <path> : Diun configuration file --profiler-path <path> : Base path where profiling files are written --profiler <string> : Profiler to use --log-level <string> : Set log level (default info ) --log-json : Enable JSON logging output --log-caller : Add file:line of the caller to log output --log-nocolor : Disables the colorized output --grpc-authority <string> : Address used to expose the gRPC server (default :42286 ) Examples: diun serve --config diun.yml --log-level debug Following environment variables can also be used in place: Name Default Description CONFIG Diun configuration file PROFILER_PATH Base path where profiling files are written PROFILER Profiler to use LOG_LEVEL info Log level output LOG_JSON false Enable JSON logging output LOG_CALLER false Enable to add file:line of the caller LOG_NOCOLOR false Disables the colorized output GRPC_AUTHORITY :42286 Address used to expose the gRPC server image list \u00b6 Note Diun needs to be started through serve command to be able to use this command. List images in database. --raw : JSON output --grpc-authority <string> : Link to Diun gRPC API (default 127.0.0.1:42286 ) Examples: diun image list diun image list --raw image inspect \u00b6 Note Diun needs to be started through serve command to be able to use this command. Display information of an image in database. --image : Image to inspect ( required ) --raw : JSON output --grpc-authority <string> : Link to Diun gRPC API (default 127.0.0.1:42286 ) Examples: diun image inspect --image alpine diun image inspect --image drone/drone --raw image remove \u00b6 Note Diun needs to be started through serve command to be able to use this command. Remove an image manifest from database. --image : Image to remove ( required ) --grpc-authority <string> : Link to Diun gRPC API (default 127.0.0.1:42286 ) Examples: diun image remove --image alpine:latest diun image inspect --image drone/drone Warning All manifest for an image will be removed if no tag is specified image prune \u00b6 Note Diun needs to be started through serve command to be able to use this command. Remove all manifests from the database. --force : Do not prompt for confirmation --grpc-authority <string> : Link to Diun gRPC API (default 127.0.0.1:42286 ) Examples: diun image prune notif test \u00b6 Note Diun needs to be started through serve command to be able to use this command. Test notification settings. --grpc-authority <string> : Link to Diun gRPC API (default 127.0.0.1:42286 ) Examples: diun notif test","title":"Command line"},{"location":"usage/command-line/#command-line","text":"","title":"Command Line"},{"location":"usage/command-line/#usage","text":"diun [ global options ] command [ command or global options ] [ arguments... ]","title":"Usage"},{"location":"usage/command-line/#global-options","text":"All global options can be placed at the command level. --help , -h : Show context-sensitive help. --version : Show version and exit.","title":"Global options"},{"location":"usage/command-line/#commands","text":"","title":"Commands"},{"location":"usage/command-line/#serve","text":"Starts Diun server. --config <path> : Diun configuration file --profiler-path <path> : Base path where profiling files are written --profiler <string> : Profiler to use --log-level <string> : Set log level (default info ) --log-json : Enable JSON logging output --log-caller : Add file:line of the caller to log output --log-nocolor : Disables the colorized output --grpc-authority <string> : Address used to expose the gRPC server (default :42286 ) Examples: diun serve --config diun.yml --log-level debug Following environment variables can also be used in place: Name Default Description CONFIG Diun configuration file PROFILER_PATH Base path where profiling files are written PROFILER Profiler to use LOG_LEVEL info Log level output LOG_JSON false Enable JSON logging output LOG_CALLER false Enable to add file:line of the caller LOG_NOCOLOR false Disables the colorized output GRPC_AUTHORITY :42286 Address used to expose the gRPC server","title":"serve"},{"location":"usage/command-line/#image-list","text":"Note Diun needs to be started through serve command to be able to use this command. List images in database. --raw : JSON output --grpc-authority <string> : Link to Diun gRPC API (default 127.0.0.1:42286 ) Examples: diun image list diun image list --raw","title":"image list"},{"location":"usage/command-line/#image-inspect","text":"Note Diun needs to be started through serve command to be able to use this command. Display information of an image in database. --image : Image to inspect ( required ) --raw : JSON output --grpc-authority <string> : Link to Diun gRPC API (default 127.0.0.1:42286 ) Examples: diun image inspect --image alpine diun image inspect --image drone/drone --raw","title":"image inspect"},{"location":"usage/command-line/#image-remove","text":"Note Diun needs to be started through serve command to be able to use this command. Remove an image manifest from database. --image : Image to remove ( required ) --grpc-authority <string> : Link to Diun gRPC API (default 127.0.0.1:42286 ) Examples: diun image remove --image alpine:latest diun image inspect --image drone/drone Warning All manifest for an image will be removed if no tag is specified","title":"image remove"},{"location":"usage/command-line/#image-prune","text":"Note Diun needs to be started through serve command to be able to use this command. Remove all manifests from the database. --force : Do not prompt for confirmation --grpc-authority <string> : Link to Diun gRPC API (default 127.0.0.1:42286 ) Examples: diun image prune","title":"image prune"},{"location":"usage/command-line/#notif-test","text":"Note Diun needs to be started through serve command to be able to use this command. Test notification settings. --grpc-authority <string> : Link to Diun gRPC API (default 127.0.0.1:42286 ) Examples: diun notif test","title":"notif test"},{"location":"user-guides/blog-posts/","text":"Blog posts \u00b6 Tutorials made by the community. Diun - Docker image update notifier Diun - friendly docker image update notifier Docker Container Building via GitHub Actions with Diun Monitoring For Docker Image Updates With Diun Podcast: Perils of Self-Hosting Updating Docker containers safely Tip Click on the \"Edit\" button to add your page here.","title":"Blog posts"},{"location":"user-guides/blog-posts/#blog-posts","text":"Tutorials made by the community. Diun - Docker image update notifier Diun - friendly docker image update notifier Docker Container Building via GitHub Actions with Diun Monitoring For Docker Image Updates With Diun Podcast: Perils of Self-Hosting Updating Docker containers safely Tip Click on the \"Edit\" button to add your page here.","title":"Blog posts"},{"location":"user-guides/docker-file-providers/","text":"Docker + File providers \u00b6 It is possible to use several providers at the same time with Diun. This can be particularly useful if you want to analyze some images that you don't manage through a container. In this section we quickly go over a basic docker-compose file to run Diun using the docker and file providers. Setup \u00b6 Create a docker-compose.yml file that uses the official Diun image: version : \"3.5\" services : diun : image : crazymax/diun:latest container_name : diun command : serve volumes : - \"./data:/data\" - \"./custom-images.yml:/custom-images.yml:ro\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"LOG_JSON=false\" - \"DIUN_WATCH_WORKERS=20\" - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\" - \"DIUN_PROVIDERS_DOCKER=true\" - \"DIUN_PROVIDERS_DOCKER_WATCHBYDEFAULT=true\" - \"DIUN_PROVIDERS_FILE_FILENAME=/custom-images.yml\" restart : always # /custom-images.yml - name : ghcr.io/crazy-max/diun - name : alpine - name : debian:stretch-slim - name : nginx:stable-alpine - name : traefik watch_repo : true include_tags : - ^\\d+\\.\\d+\\..* Here we use a minimal configuration to analyze all running containers (watch by default enabled) of your local Docker instance with the Docker provider and also custom images through the File provider every 6 hours . That's it. Now you can launch Diun with the following command: docker-compose up -d","title":"Docker + File providers"},{"location":"user-guides/docker-file-providers/#docker-file-providers","text":"It is possible to use several providers at the same time with Diun. This can be particularly useful if you want to analyze some images that you don't manage through a container. In this section we quickly go over a basic docker-compose file to run Diun using the docker and file providers.","title":"Docker + File providers"},{"location":"user-guides/docker-file-providers/#setup","text":"Create a docker-compose.yml file that uses the official Diun image: version : \"3.5\" services : diun : image : crazymax/diun:latest container_name : diun command : serve volumes : - \"./data:/data\" - \"./custom-images.yml:/custom-images.yml:ro\" - \"/var/run/docker.sock:/var/run/docker.sock\" environment : - \"TZ=Europe/Paris\" - \"LOG_LEVEL=info\" - \"LOG_JSON=false\" - \"DIUN_WATCH_WORKERS=20\" - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\" - \"DIUN_PROVIDERS_DOCKER=true\" - \"DIUN_PROVIDERS_DOCKER_WATCHBYDEFAULT=true\" - \"DIUN_PROVIDERS_FILE_FILENAME=/custom-images.yml\" restart : always # /custom-images.yml - name : ghcr.io/crazy-max/diun - name : alpine - name : debian:stretch-slim - name : nginx:stable-alpine - name : traefik watch_repo : true include_tags : - ^\\d+\\.\\d+\\..* Here we use a minimal configuration to analyze all running containers (watch by default enabled) of your local Docker instance with the Docker provider and also custom images through the File provider every 6 hours . That's it. Now you can launch Diun with the following command: docker-compose up -d","title":"Setup"}]}